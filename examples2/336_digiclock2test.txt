PROGRAM DigiClocks2;

// kind of an Idea from bitbox, locs= 682; 13Intf;
// Clock Composition art work
// digiclock from the book delphi software praxis, modified on mX by max 

Const
  PicPath = '\examples\images\';
  FBOX = 4;

VAR 
//<Variable declarations>
  frmMon: TForm;
  ShowDate, ShowTime: boolean;
  pg,py,pr: Array[0..5] of TPaintBox;
  div_dbl: double;
  a,b,bin1, bin2, bin3: integer;
  afg: naturalnumber;
  arb: TRadioButton;
  //acl: TColorBox;
  wd: word;
  Image1: TImage;
  frmsg: TStringGrid;
  stat: TStatusbar;
  panstep: TPanel;
  Progress: TProgressBar;
  tm1: TTimer;          
    ilGreen: TCustomImageList;  
    ilYellow: TCustomImageList;
    ilRed: TCustomImageList;
    panRed, panYell, panGreen: TPanel;       //Panel und Bildkomponenten je Farbe
    pr5, pr4, pr3, pr2, pr1, pr0: TPaintBox;
    py5, py4, py3, py2, py1, py0: TPaintBox;
    pg5, pg4, pg3, pg2, pg1, pg0: TPaintBox;
    pan: TPanel;
    mm1: TMainMenu;      
    mPrg, mmEnde, mAnsicht: TMenuItem;
    mmDatum, mmZeit: TMenuItem;
    iod: TIdIOHandler;
    aplay: TIdRFCReplies;
    zeit: Array[1..6] of byte;
    pb: Array[1..6] of TPaintBox;
    pb1, pb2, pb3, pb4, pb5, pb6: TPaintBox; //PaintBoxen zur Zifferndarstellung
    imgL: TCustomImageList;
    digTimer: TTimer;  
    Panel1: TPanel;
    Label1: TLabel;
  //  procedure FormActivate(Sender: TObject);
    //procedure TimerTimer(Sender: TObject);

//<FUNCTION>
//<PROCEDURE> 
Procedure AllBooleanPattern(aX, aY: integer);
begin
    Writeln(#13#10+'************** All Booolean Functions **************');
    PrintF('%-36s 01 False',[inttobin(0)])
    PrintF('%-36s 02 AND',[inttobin(aX AND aY)])
    PrintF('%-36s 03 Inhibit',[inttobin(aX AND NOT aY)])
    PrintF('%-36s 04 Prepend',[inttobin(aX)])
    PrintF('%-36s 05 Praesect',[inttobin(NOT aX AND aY)])
    PrintF('%-36s 06 Postpend',[inttobin(aY)])
    PrintF('%-36s 07 XOR',[inttobin(aX XOR aY)])
    PrintF('%-36s 08 OR',[inttobin(aX OR aY)])
    PrintF('%-36s 09 NOR',[inttobin(NOT(aX OR aY))])
    PrintF('%-36s 10 Aequival',[inttobin((NOT aX OR aY)AND(NOT aY OR aX))])
    PrintF('%-36s 11 NegY',[inttobin(NOT aY)])
    PrintF('%-36s 12 ImplicatY',[inttobin(aX OR NOT aY)])
    PrintF('%-36s 13 NegX',[inttobin(NOT aX)])
    PrintF('%-36s 14 ImplicatX',[inttobin(NOT aX OR aY)])
    PrintF('%-36s 15 NAND',[inttobin(NOT(aX AND aY))])
    PrintF('%-36s 16 True',[inttobin(NOT 0)])
end;

function getBmp(apath: string): TBitmap;
  begin
    result:= TBitmap.Create;
    with result do try
      LoadFromFile(apath);
    finally
      //Free;
    end;
  end;

//////////////////// digi clock rock
procedure DigiTForm1_FormActivate(Sender: TObject);
//Startinit on Form
var i,t: integer;
begin
  pb[1]:=pb1; pb[2]:=pb2; pb[3]:=pb3;
  pb[4]:=pb4; pb[5]:=pb5; pb[6]:=pb6;
  for i:= 1 to 6 do zeit[i]:= 0;
  imgL:= TCustomImageList.Create(self);
  try
    ReadComponentResFile(ExePath+picpath+'MyImageClockList7Segment.dat', imgl);
  except
    showmessage('MyImageClockList7Segment.dat not found');
  end  
  with imgL do begin
    //@Bitmap.DrawMode:= dmBlend  //assign; setbounds
     Height:= 50;
     Width:= 30;
    {for t:= 0 to 9 do //image, mask
       Add(getbmp(exePath+picpath+'7seg'+inttostr(t)+'.bmp'),
                    getbmp(exePath+picpath+'7segaus.bmp'));} 
  end;
  WriteComponentResFile(ExePath+picpath+'MyImageClockList7Segment.dat', imgL);
end;

procedure DigiTForm1_TimerTimer(Sender: TObject);
var i: integer; 
    s,s1: String;
    t: TDateTime;
begin
  t:= Now;
  //Formate, 6-parts of s
  DateTimeToString(s,'hhmmss',t);
  //Number assign and draw
  for i:= 1 to 6 do begin
    s1:= MidStr(s,i,1);
    zeit[i]:= strToInt(s1);
    imgL.Draw(pb[i].Canvas,1,1,zeit[i],true);
  end;
end;
//////////////////////digi clock end


procedure TForm1_FormShow(Sender: TObject);
//Programm-Starteinstellungen
var  mask, image: TBitmap;
begin
// Make sure that transparency pixel in the image is taken
 //MyImage.Picture.Bitmap.TransparentMode:= tmFixed;
 { ilGreen:= TBitmap32List.Create(self);
    with ilGreen do begin
        //Bitmap.DrawMode:= dmBlend
        bitmaps.add;
        bitmap[0]:= getbitmap32(exepath+'\examples\images\green0.bmp');
    end;}
  pg[0]:=pg0; pg[1]:=pg1; pg[2]:=pg2; pg[3]:=pg3; pg[4]:=pg4; pg[5]:=pg5;
  py[0]:=py0; py[1]:=py1; py[2]:=py2; py[3]:=py3; py[4]:=py4; py[5]:=py5;
  pr[0]:=pr0; pr[1]:=pr1; pr[2]:=pr2; pr[3]:=pr3; pr[4]:=pr4; pr[5]:=pr5;
  ShowDate:=true; ShowTime:=true; 
  ilGreen:= TCustomImageList.Create(self);
  //ReadComponentResFile('MyImageClockList.dat', ilGreen);
  image:= getbitmap(exepath+picpath+'green0.bmp')
  mask:= getbitmap(exepath+picpath+'green1.bmp');
  with ilGreen do begin
       Height:= 39; Width:= 39;
       Add(image,NIL);
       Add(mask,NIL);
  end;
  ilyellow:= TCustomImageList.Create(self);
  image:= getbitmap(exepath+picpath+'yellow0.bmp')
  mask:= getbitmap(exepath+picpath+'yellow1.bmp');
  with ilyellow do begin
       Height:= 39; Width:= 39;
       Add(image,NIL);
       Add(mask,NIL);
  end;
  ilred:= TCustomImageList.Create(self);
  image:= getbitmap(exepath+picpath+'red0.bmp')
  mask:= getbitmap(exepath+picpath+'red1.bmp');
  with ilred do begin
      Height:= 39; Width:= 39;
      Add(image,NIL);
      Add(mask,NIL);
  end;
  //WriteComponentResFile('MyImageClockList.dat', ilGreen);
  //ReadComponentResFile('MyImageClockList.dat', ilGreen);
  //tm1.Enabled:=true;
end;


procedure TForm1_tm1Timer(Sender: TObject);
var
  i,zh,zm,zs,p: integer;
  t,m,j,hh,mm,ss,ms: Word;
  mtime: TDateTime;
  s,s1,s2: String;
begin
  mtime:= Now; s:= '';
  DecodeDate(mTime,j,m,t);
  DecodeTime(mTime,hh,mm,ss,ms);
  DateTimeToString(s1,'dd.mm.yyyy',mTime);
  DateTimeToString(s2,' hh:mm:ss',mTime);
  if ShowDate then s:=s+s1; //+#9;
  if ShowTime then s:=s+s2;
  if s='' then s:=' ... the real binarytime ... ';
  pan.Caption:= s;
  p:= 1;
  for i:= 0 to 5 do begin //Binaries cut and draw
    //zh:=0; if (hh and p)<>0 then zh:=1;
    //zm:=0; if (mm and p)<>0 then zm:=1;
    //zs:=0; if (ss and p)<>0 then zs:=1;
    zh:=(hh and p) shr i;
    zm:=(mm and p) shr i;
    zs:=(ss and p) shr i;
    //pr[i].canvas.draw(Rect.Left, Rect.Top, TBitmap(ilRed[0]));
    //py[i].canvas.draw(Rect.Left, Rect.Top, TBitmap(ilRed[0]));
    //pg[i].canvas.draw(Rect.Left, Rect.Top, TBitmap(ilRed[0]));
    ilRed.Draw(pr[i].Canvas,1,2,zh,true);
    ilYellow.Draw(py[i].Canvas,1,2,zm,true);
    ilGreen.Draw(pg[i].Canvas,1,2,zs,true);

    frmsg.Cells[0,1]:= 'Dez';
    frmsg.Cells[1,1]:= inttoStr(hh);
    frmsg.Cells[2,1]:= inttoStr(mm);
    frmsg.Cells[3,1]:= inttoStr(ss);
    frmsg.Cells[0,2]:= 'Hex';
    frmsg.Cells[1,2]:= inttohex(hh,3);
    frmsg.Cells[2,2]:= inttohex(mm,3);
    frmsg.Cells[3,2]:= inttohex(ss,3);
    Progress.Position:= (hh * 60)+mm;
    panStep.Caption:= formatFloat('0',(((hh*60)+mm)/1440)*100)+' %'; //prorgess
    p:= p*2;
  end;
end;

procedure TForm1_mmDatumClick(Sender: TObject);
begin
  mmDatum.Checked:= not mmDatum.Checked;
  ShowDate:= mmDatum.Checked;
end;

procedure TForm1_mmZeitClick(Sender: TObject);
begin
  mmZeit.Checked:= not mmZeit.Checked;
  ShowTime:= mmZeit.Checked;
end;

procedure btnCloseClick(Sender: TObject);
begin
  stat.SimpleText:= 'Closed Clicked';
  //il.Free;
  frmMon.Close;
end;

procedure CloseClick(Sender: TObject; var action: TCloseAction);
begin
   //if MessageDlg('Wanna Leave?',mtConfirmation,[mbYes, mbNo],0)= mrYes then begin
   //form1.Free; //bmp.Free;
  if digtimer <> NIL then begin
    digtimer.enabled:= false;
    digtimer.Free;
    digtimer:= NIL;
  end;
  if tm1 <> NIL then begin
    tm1.enabled:= false;
    tm1.Free;
    tm1:= NIL;
  end;
   action:= caFree;
   imgL.Free;
   ilGreen.Free;
   ilRed.Free;
   ilyellow.Free;
   frmMon:= NIL;
   screen.cursor:= crDefault;
   //showmessage('free');
   writeln('Digi Free and Closer test finished');
   //end else
     //Action:= caNone;
end;


//*************************Form Create********************************//
procedure InitCreateForms;
var panImg, panR: TPanel;
    //mis : array[0..3] of TMenuItem;
begin
 // seq --> panel-image-drawgrid-bitmap
  //panimg1.DoubleBuffered:= true;
  
 frmMon:= TForm.Create(self);
 with frmMon do begin
   //FormStyle := fsStayOnTop;
   Position:= poScreenCenter;
   BorderIcons:= [biSystemMenu, biMinimize];
   BorderStyle:= bsSingle;
   PixelsPerInch:= 96;
   caption:='7 Digi Binary Clocks';
   color:= clred;
   width:= 650;
   height:= 540;
   Menu:= mm1;
   Show;
   onClose:= @CloseClick;
 end;
  Screen.cursor:= crHourGlass;
 
  Panel1:= TPanel.Create(frmMon)
  with panel1 do begin
    parent:= frmMon;
    SetBounds(18,18,241,65);
    BevelOuter:= bvLowered;
    Color:= clBlack;
    TabOrder:= 0;
  end;  
  pb1:= TPaintBox.Create(frmMon);
    with pb1 do begin
      parent:= panel1;
      SetBounds(8,8,30,50);
    end;  
    pb2:= TPaintBox.Create(frmMon);
    with pb2 do begin
      parent:= panel1;
      SetBounds(40,8,30,50);
    end;  
    pb3:= TPaintBox.Create(frmMon);
    with pb3 do begin
      parent:= panel1;
      SetBounds(88,8,30,50);
    end;  
    pb4:= TPaintBox.Create(frmMon);
    with pb4 do begin
      parent:= panel1;
      SetBounds(120,8,30,50);
    end;  
    pb5:= TPaintBox.Create(frmMon);
    with pb5 do begin
      parent:= panel1;
      SetBounds(168,8,30,50);
    end;  
    pb6:= TPaintBox.Create(frmMon);
    with pb6 do begin
      parent:= panel1;
      SetBounds(200,8,30,50);
    end;  
    with TLabel.Create(self) do begin
      SetBounds(74,12,10,38);
      parent:= panel1;
      Caption:= ':';
      Font.Charset:= ANSI_CHARSET;
      Font.Color:= clGreen;
      Font.Height:= -27;
      Font.Name:= 'Arial Black';
      Font.Style:= [fsBold];
      ParentFont:= False;
    end;
    with TLabel.Create(self) do begin
      SetBounds(154,12,10,38);
      parent:= panel1;
      Caption:= ':';
      Font.Charset:= ANSI_CHARSET;
      Font.Color:= clGreen;
      Font.Height:= -27;
      Font.Name:= 'Arial Black';
      Font.Style:= [fsBold];
      ParentFont:= False;
    end;
    
  //////////digi binary controls 
  Pan:= TPanel.Create(frmMon)   //just set text time
  with pan do begin
    parent:= frmMon;
    SetBounds(18,350,312,45);
    //BevelOuter:= bvLowered;
    BevelOuter:= bvLowered
    //Color:= clBtnHighlight;
    Color:= clred;
    Font.Style:= [fsBold];
    Font.Size:= 20;
    Font.Color:= clwhite;
    TabOrder:= 0;
  end;  
 
  Panred:= TPanel.Create(frmMon)
  with panred do begin
    parent:= frmMon;
    SetBounds(18,150,240,40);
    BevelOuter:= bvLowered;
    //transparent;
    Color:= clwhite;
    TabOrder:= 0;
  end;  
  pr5:= TPaintBox.Create(frmMon);
    pr5.parent:= panred;
    pr5.SetBounds(0,0,39,39);
    pr4:= TPaintBox.Create(frmMon);
    pr4.parent:= panred;
    pr4.SetBounds(40,0,39,39);
    pr3:= TPaintBox.Create(frmMon);
    pr3.parent:= panred;
    pr3.SetBounds(80,0,39,39);
    pr2:= TPaintBox.Create(frmMon);
    pr2.parent:= panred;
    pr2.SetBounds(120,0,39,39);
    pr1:= TPaintBox.Create(frmMon);
    pr1.parent:= panred;
    pr1.SetBounds(160,0,39,39);
    pr0:= TPaintBox.Create(frmMon);
    pr0.parent:= panred;
    pr0.SetBounds(200,0,39,39);

  Panyell:= TPanel.Create(frmMon)
  with panyell do begin
    parent:= frmMon;
    SetBounds(18,200,240,40);
    BevelOuter:= bvLowered;
    Color:= clWhite;
    TabOrder:= 0;
  end;  
  py5:= TPaintBox.Create(frmMon);
    py5.parent:= panyell;
    py5.SetBounds(0,0,39,39);
  py4:= TPaintBox.Create(frmMon);
    py4.parent:= panyell;
    py4.SetBounds(40,0,39,39);
  py3:= TPaintBox.Create(frmMon);
    py3.parent:= panyell;
    py3.SetBounds(80,0,39,39);
  py2:= TPaintBox.Create(frmMon);
    py2.parent:= panyell;
    py2.SetBounds(120,0,39,39);
  py1:= TPaintBox.Create(frmMon);
    py1.parent:= panyell;
    py1.SetBounds(160,0,39,39);
  py0:= TPaintBox.Create(frmMon);
    py0.parent:= panyell;
    py0.SetBounds(200,0,39,39);

  Pangreen:= TPanel.Create(frmMon)
  with pangreen do begin
    parent:= frmMon;
    SetBounds(18,250,240,40);
    BevelOuter:= bvLowered;
    Color:= clWhite;
    TabOrder:= 0;
  end;  
  pg5:= TPaintBox.Create(frmMon);
    pg5.parent:= pangreen;
    pg5.SetBounds(0,0,39,39);
  pg4:= TPaintBox.Create(frmMon);
    pg4.parent:= pangreen;
    pg4.SetBounds(40,0,39,39);
  pg3:= TPaintBox.Create(frmMon);
    pg3.parent:= pangreen;
    pg3.SetBounds(80,0,39,39);
  pg2:= TPaintBox.Create(frmMon);
    pg2.parent:= pangreen;
    pg2.SetBounds(120,0,39,39);
  pg1:= TPaintBox.Create(frmMon);
    pg1.parent:= pangreen;
    pg1.SetBounds(160,0,39,39);
  pg0:= TPaintBox.Create(frmMon);
    pg0.parent:= pangreen;
    pg0.SetBounds(200,0,39,39);
  
  DigiTForm1_FormActivate(Self);
  digtimer:= TTimer.Create(self);
  digtimer.enabled:= true;
  digtimer.onTimer:= @DigiTForm1_TimerTimer;
  digtimer.interval:= 1000;
  
  TForm1_FormShow(Self);
  tm1:= TTimer.Create(self);
  tm1.enabled:= true;
  tm1.onTimer:= @TForm1_tm1Timer;
  tm1.interval:= 1000;

  PanR:= TPanel.create(frmMon);
    with PanR do begin
      parent:= frmMon;
      setBounds(472,9,155,450);
      BevelOuter:= bvLowered
    end;
    with TBitBtn.Create(frmMon) do begin
      Parent:= frmMon;        
      SetBounds(488,30,121,30)        //30
      Caption:= 'Load Clock'
      Hint:= 'Load your own clock picture!';
      ShowHint:= true;
      glyph.LoadFromResourceName(getHINSTANCE,'CL_MPEJECT'); 
      //OnClick:= @BtnPictureLoad;
    end;
    with TBitBtn.Create(frmMon) do begin
      Parent:= frmMon;        
      SetBounds(488,68,121,30)       //68
      glyph.LoadFromResourceName(getHINSTANCE,'CL_MPSTEP'); 
      Caption:= 'New Clock'
      //Enabled:= False
      //OnClick:= @btnNewClockClick
    end;
    with TBitBtn.Create(frmMon) do begin
      Parent:= frmMon;        
      SetBounds(488,420,121,30)
      glyph.LoadFromResourceName(getHINSTANCE,'CL_MPSTOP'); 
      Caption:= 'Close'
      OnClick:= @btnCloseClick
    end;
    panstep:= TPanel.Create(frmMon); 
    with panstep do begin
      Parent:= frmMon;        
      SetBounds(488,120,121,25)
      BevelOuter:= bvLowered
      Caption:= '0 %'
      Color:= clyellow;//$30809000;
      //Color:= 8404992
    end;
   frmsg:= TStringGrid.Create(frmMon);
   with frmsg do begin
    //SetBounds(512,320,79,79)  
     parent:= frmMon;
     Left:= 500; Top:= 320;
     Width:= 95; Height:= 79;
     ColCount:= 4
     DefaultColWidth:= 22
     DefaultRowHeight:= 18
     FixedCols:= 0
     RowCount:= 4
     FixedRows:= 0
   end;
  with TJvAnalogClock.Create(frmMon) do begin 
    parent:= PanR;
    bevelwidth:= 0;
    colormin:= clblue;
    //timeoffSet:= -60;
    align:= alclient;
    ColorHr:= clRed;
    //WidthHandHr:= 1;
    ColorHandHr:= clRed;
    ColorHandMin:= clRed;
    setBounds(28,5,100,100);
    centercol:= clyellow; //cldarkblue32; //clwebgold; 
    centersize:= 8;
  end;  
  with TLabel.Create(frmMon) do begin
     Parent:= PanR;        
     SetBounds(18,140,50,18)
     Caption:= 'Progress:'
     bringtofront;
  end;
  with TLabel.Create(frmMon) do begin
     Parent:= PanR;        
     SetBounds(18,290,50,18)
     Caption:= 'Navigation:'
  end;
   
  mm1:= TMainMenu.Create(frmMon);
    mPrg:= TMenuItem.Create(frmMon);
    mPrg.Caption:= 'Program';
    mm1.Items.Add(mPrg);
    //mm1.Items[0].Add(mPrg);
    mmEnde:= TMenuItem.Create(frmmon)
    with mmEnde do begin
      //parent:= mPrg;
      Caption:= 'Shotdown'
      tag:= mprg;
      //submenu.add
      //items[0].add(mprg);
      OnClick:= @btnCloseClick;
    end;
     mprg.add(mmende);
      //SubItem:= TMenuItem.Create(MainMenu1);
      //MainMenu1.Items[0].Add(SubItem);
      //mPrg.Items[mmEnde];
      mAnsicht:= TMenuItem.Create(frmMon);
      mAnsicht.Caption:= 'View';
      mm1.Items.Add(mAnsicht);
      mmDatum:= TMenuItem.Create(mAnsicht);
      with mmdatum do begin
        Caption:= 'Date';
        Checked:= True;
        OnClick:= @TForm1_mmDatumClick;
      end;
      mAnsicht.Add(mmdatum);
      mmZeit:= TMenuItem.Create(mAnsicht);
      with mmZeit do begin
        Caption:= 'Time';
        Checked:= True;
        OnClick:= @TForm1_mmZeitClick;
      end;
      mAnsicht.Add(mmzeit);
      frmMon.Menu:= mm1;
  
   stat:= TStatusbar.Create(FrmMon);
   with Stat do begin
     parent:= frmMon;
     stat.SimplePanel:= true;
   end;
   stat.SimpleText:='Clock Composition is running ...at: '+DateTimeToInternetStr(now, true);
   Progress:= TProgressBar.Create(frmMon);
   with progress do begin
     parent:= frmMon;
     Align:= alBottom;
     //step:= 10;
     Max:= (24*60);
   end;
end; 

procedure josephusProblem;
var i,z,k, p: smallint;
    it: Tintegerlist;
    listbox: TListbox;
    ist, stringlist: TStringlist;
    x, Idx: Integer;

begin
  it:= TIntegerlist.create;
  for i:= 1 to 41 do
    it.add(i);
      writeln(inttostr(it.count));
   for i:= 1 to it.count-1 do
    if i mod 3 = 0 then begin
      write(inttostr(i)+ ' ');
      it.remove(i);
     end; 
     writeln('');
      writeln(inttostr(it.count));
   
   for i:= 1 to it.count-1 do
    if i mod 3 = 0 then begin
      write(inttostr(i)+ ' ');
      it.remove(i);
     end; 
      writeln(inttostr(it.count));
      it.Free;  
 
  {ist:= TStringlist.create;
  for i:= 1 to 41 do
    ist.add(inttoStr(i));
      writeln(inttostr(ist.count));
     writeln('');
   for z:= 3 to 25 do begin
     for i:= 1 to ist.count-1 do
        if i mod z = 0 then 
          ist[i-1]:= 'x';
     for p:= 0 to ist.count-1 do  //line out
        write((ist[p])+ ' ');
      writeln('');
   end;
   writeln('');
    for i:= 0 to ist.count-1 do
      write((ist[i])+ ' ');
    writeln('josephus end');   //16 is pre last 31 ist the last one
    ist.Free;
  //end;}
    
  { ist:= TStringlist.create;
  for k:= 1 to 5 do
  for i:= 1 to 41 do
    ist.add(inttoStr(i));
    
     writeln('');
   for z:= 1 to 10 do begin
     for i:= 1 to ist.count-1 do
        if i mod 3 = 0 then 
          ist.delete(i-1);
          //ist[i-1]:= 'x';
      writeln(inttoStr(z)+' line:'+#13#10);
      for p:= 0 to ist.count-1 do  //line out
        write((ist[p])+ ' ');
   end;
   ist.Free;}

  //for k:= 1 to 5 do
  //for i:= 1 to 41 do
    //ist.add(inttoStr(i));

 
  ist:= TStringlist.create;
  //for k:= 1 to 5 do
  for i:= 1 to 41 do
    ist.add(inttoStr(i));
    
     writeln('');
   //for z:= 1 to 10 do begin
     for i:= 1 to ist.count-1 do
        if i mod 3 = 0 then 
         ist[i-1]:= 'x';
          //ist[i-1]:= 'x';
      writeln(inttoStr(z)+' line:'+#13#10);
      for p:= 0 to ist.count-1 do  //line out
        write((ist[p])+ ' ');
   
     for i:= 1 to ist.count-1 do begin
        //for k:= 1 to 3 do begin
         if ist[i-1] <> 'x' then inc(z);
         if z= 3 then begin
         ist[i-1]:= 'x';
         i:= i+z;
         z:= 0;
         //end;
         end;
         end;
          //ist[i-1]:= 'x';
      writeln(inttoStr(z)+' line:'+#13#10);
      for p:= 0 to ist.count-1 do  //line out
        write((ist[p])+ ' ');
   
   
   //end;
   ist.Free;
   
{for x:= ListBox.items.Count - 1 downto 0 do begin
   if ListBox.Selected[x] then begin
      idx := StringList.IndexOf(ListBox.Items[x]);
      if(idx <> -1)then StringList.Delete(idx);
   end;
end; }
    
      
  end;
  
  {def josephus( n, k):
   r = 0
   i = 2
   while i <= n:
     r = (r + k) % i;
     i+= 1
   return r+1}
   
   {def josephus( n, k):
   if n ==1:
     return 1
   else:
     return ((josephus(n-1,k)+k-1) % n)+1}

  
  
  function josephus(n,k: byte): integer;
   var r,i: integer;
   begin
   r:= 0
   i:= 2
   while i <= n do begin
     r:= (r + k) mod i;
     i:= i+ 1
     write(intToStr(r)+ ' ');  //debug
   end;  
   result:= r+1;
  end; 
  
  function josephus2(n,k: byte): integer;
   var r,i: integer;
   begin
   r:= 0 i:= 2
   while i <= n do begin
     r:= (r+k) mod i;
     inc(i)
   end;  
   result:= r+1
  end; 
  
   function josephus_rec(n,k: byte): integer;
   begin
   if n = 1 then
     result:= 1
   else
     result:= (josephus_rec(n-1,k) +k-1) mod n+1
   end;  

  

procedure TestJvTFUtils;
begin

 writeln(inttoStr(JExtractYear(now)));
 writeln(inttoStr(JExtractMonth(now)));
 writeln(inttoStr(JExtractDay(now)));
 writeln(inttoStr(ExtractHours(now)));
 writeln(inttoStr(ExtractMins(now)));
 writeln(inttoStr(ExtractSecs(now)));
  //ExtractMSecs(ATime: TDateTime): Word;
  //FirstOfMonth(ADate: TDateTime): TDateTime;
  //GetDayOfNthDOW(Year, Month, DOW, N: Word): Word;
  //GetWeeksInMonth(Year, Month: Word; StartOfWeek: Integer): Word;

 //IncBorlDOW(var BorlDOW: Integer; N: Integer = 1);
 //IncDOW(var DOW: TTFDayOfWeek; N: Integer = 1);
 //IncDays(var ADate: TDateTime; N: Integer = 1);
 //IncWeeks(var ADate: TDateTime; N: Integer = 1);
 //IncMonths(var ADate: TDateTime; N: Integer = 1);
 //IncYears(var ADate: TDateTime; N: Integer = 1);

      //EndOfMonth(ADate: TDateTime): TDateTime;
      //IsFirstOfMonth(ADate: TDateTime): Boolean;
      //IsEndOfMonth(ADate: TDateTime): Boolean;
      //EnsureMonth(Month: Word);
      //EnsureDOW(DOW: Word);
      //EqualDates(D1, D2: TDateTime): Boolean;
      //Lesser(N1, N2: Integer): Integer;
      //Greater(N1, N2: Integer): Integer;
      //GetDivLength(TotalLength, DivCount, DivNum: Integer): Integer;
      //GetDivNum(TotalLength, DivCount, X: Integer): Integer;
      //GetDivStart(TotalLength, DivCount, DivNum: Integer): Integer;
      //DOWToBorl(ADOW: TTFDayOfWeek): Integer;
      //BorlToDOW(BorlDOW: Integer): TTFDayOfWeek;
      //DateToDOW(ADate: TDateTime): TTFDayOfWeek;

 {CalcTextPos(HostRect: TRect; var TextLeft, TextTop: Integer;
  var TextBounds: TRect; AFont: TFont; AAngle: Integer;
  HAlign: TAlignment; VAlign: TJvTFVAlignment; ATxt: string);}

 {DrawAngleText(ACanvas: TCanvas; HostRect: TRect;
  var TextBounds: TRect; AAngle: Integer; HAlign: TAlignment;
  VAlign: TJvTFVAlignment; ATxt: string);}

 //RectWidth(ARect: TRect): Integer;
 //RectHeight(ARect: TRect): Integer;
 //EmptyRect: TRect;
 //IsClassByName(Obj: TObject; ClassName: string): Boolean;
end;


procedure SIRegister_JvCsvParse_Tester;
var at: ttimeformat;
begin
 //MaxInitStrNum','LongInt').SetInt( 9);
 //JvAnsiStrSplit( const InString : AnsiString; const SplitChar, QuoteChar : AnsiChar; var OutStrings : array of AnsiString; MaxSplit : Integer) : Integer');
  //JvStrSplit( const InString : string; const SplitChar, QuoteChar : Char; var OutStrings : array of string; MaxSplit : Integer) : Integer');
  //JvAnsiStrSplitStrings( const InString : AnsiString; const SplitChar, QuoteChar : AnsiChar; OutStrings : TStrings) : Integer');
  //JvAnsiStrStrip( S : AnsiString) : AnsiString');
  //JvStrStrip( S : string) : string');
  //GetString( var Source : AnsiString; const Separator : AnsiString) : AnsiString');
  //JPadString( const S : AnsiString; Len : Integer; PadChar : AnsiChar) : AnsiString');
  //BuildPathName( const PathName, FileName : AnsiString) : AnsiString');
  //StrEatWhiteSpace( const S : string) : string');
  //HexToAscii( const S : AnsiString) : AnsiString');
  //AsciiToHex( const S : AnsiString) : AnsiString');
  //StripQuotes( const S1 : AnsiString) : AnsiString');
  //ValidNumericLiteral( S1 : PAnsiChar) : Boolean');
  //ValidIntLiteral( S1 : PAnsiChar) : Boolean');
  //ValidHexLiteral( S1 : PAnsiChar) : Boolean');
  //HexPCharToInt( S1 : PAnsiChar) : Integer');
  //ValidStringLiteral( S1 : PAnsiChar) : Boolean');
  //StripPCharQuotes( S1 : PAnsiChar) : AnsiString');
  //JvValidIdentifierAnsi( S1 : PAnsiChar) : Boolean');
  //JvValidIdentifier( S1 : String) : Boolean');
  //JvEndChar( X : AnsiChar) : Boolean');
  //JvGetToken( S1, S2 : PAnsiChar)');
  //IsExpressionKeyword( S1 : PAnsiChar) : Boolean');
  //IsKeyword( S1 : PAnsiChar) : Boolean');
  //JvValidVarReference( S1 : PAnsiChar) : Boolean');
  //GetParenthesis( S1, S2 : PAnsiChar) : Boolean');
  //JvGetVarReference( S1, S2, SIdx : PAnsiChar)');
 //Procedure JvEatWhitespaceChars( S1 : PAnsiChar);');
 //Procedure JvEatWhitespaceChars1( S1 : PWideChar);');
  //GetTokenCount : Integer');
  //ResetTokenCount');
   // ansichar
   //bignumber
   //bigfact
  
end;


procedure sendGMAIL;
var idSMTP1: TIdSMTP;
    idmessage1: TIdMessage;
     // idMBHTML : TIdMessageBuilderHTML.Create;
    //IdSSLIOHandlerSocketOpenSSL1: TIdSSLIOHandlerSocketOpenSSL;
    E: Exception;

begin
  IDSMTP1 := TIDSMTP.Create(self);
  //IdSSLIOHandlerSocketOpenSSL1 := TIdSSLIOHandlerSocketOpenSSL.Create;
  try
    with IDSMTP1 do begin
  
      Username:= 'maxkleiner1@gmail.com';
      Password:= '';
  
      Host := 'smtp.gmail.com';//srvr.Host;
      Port := 587;  //465;//srvr.Port;
      //if (needAuthentication = 'Y') then
        AuthenticationType:= atLogin
      //else
        //AuthType := satNone;
        //IOHandler := IdSSLIOHandlerSocketOpenSSL1;

      {if (srvr.secureMode = 'Y') then
        UseTLS := utUseRequireTLS
      else
        UseTLS := utNoTLSSupport;}
      //Username := srvr.Username;
      //Password := srvr.Password;
    end;

    //idMBHTML := TIdMessageBuilderHTML.Create;
    Idmessage1 := TIDMessage.Create(self);

    try
      {with idMBHTML do
      begin
        enc := TEncoding.Unicode;
        HTML.LoadFromStream(FEmlMsg.MsgBody, enc);
        for c := 0 to FEmlMsg.Attachmnts.Count - 1 do
          Attachments.Add(FEmlMsg.Attachmnts[c]);
        FillMessage(IDMessage1);
      end;}

      with Idmessage1 do begin
        Subject := 'FEmlMsg.MsgSubject';
        From.Address := 'maxkleiner1@gmail.com';
        From.Name := 'FEmlMsg.FromName';
        Recipients.EMailAddresses := 'max@kleiner.com';
        {if FEmlMsg.ReceiptRecipientAddress <> '' then
          ReceiptRecipient.Address := FEmlMsg.ReceiptRecipientAddress;
        if FEmlMsg.ReceiptRecipientName <> '' then
          ReceiptRecipient.Name := FEmlMsg.ReceiptRecipientName;}
      end;

      with IDSMTP1 do begin
        if not Connected then
          Connect(1000);
        Send(IdMessage1);
      end;

    finally
      Idmessage1.Free;
      //idMBHTML.Free;
    end;
  finally
    if IdSMTP1.Connected then IDSMTP1.Disconnect;
    IDSMTP1.Free;
    //IdSSLIOHandlerSocketOpenSSL1.Free;
  end;
end;

//Debug Runtime Error: Exception: 5.7.0 Must issue a STARTTLS command first. s3sm27150699eem.4 - gsmtp .
//Exception: 5.7.0 Must issue a STARTTLS command first. 44sm27194908eek.5 - gsmtp


procedure TMailerForm_btnSendMailClick(Sender: TObject);
var SMTP: TIdSMTP;
    mailmessage: TIdMessage;
    E: Exception;

 begin
   //StatusMemo.Clear;
    E:= Exception.create('smtp error');;
    mailmessage:= TIdMessage.create(self);
   
   //setup SMTP
   
   SMTP:= TIdSMTP.create(self);
   SMTP.Host:= 'smtp.gmail.com';
   SMTP.Port:= 465; //25;
   SMTP.Username:= 'maxkleiner1@gmail.com';
   SMTP.Password:= '';
   
   if SMTP.Authenticate then writeln('authenticate');
 
   //setup mail message
   MailMessage.From.Address:= 'maxkleiner1@gmail.com';
   //MailMessage.Recipients.EMailAddresses:= ledTo.Text + ',' + ledCC.Text;
   MailMessage.Recipients.EMailAddresses:= 'max@kleiner.ch';
 
   MailMessage.Subject:= 'ledSubject.Text';
   MailMessage.Body.Text:= 'Body.Text';
 
  // if FileExists('ledAttachment.Text') then TIdAttachment.Create(MailMessage.MessageParts, 'ledAttachment.Text') ;
 
   //send mail
   try
     try
       SMTP.Connect(1000) ;
       SMTP.Send(MailMessage) ;
     except //on E:Exception do
       writeln('memo2.Lines.Insert(0, ''ERROR: ''' + E.Message) ;
     end;
   finally
     if SMTP.Connected then SMTP.Disconnect;
      mailmessage.Free;
      SMTP.Free;
   
   end;
 
 end; (* btnSendMail Click *) 


 

procedure SendEmail(mFrom,  mTo,  mSubject,  mBody,  mAttachment: variant);
var  schema: string;
 var mMessage, mconfig: Variant;

begin

  {var smtpServer = "smtp.gmail.com";

  var smtpPort = 587 //465;

  var userLogin = "USER_LOGIN"; // e.g. "abc" if the address is abc@gmail.com
  var userPassword = "USER_PASSWORD";
   var autentificationType = 1; // cdoBasic
   var connectionTimeout = 30;

  // Required by Gmail

  var useSSL = true; }

    mMessage:= CreateOleObject('CDO.Message');
    //with XLApp do begin
    mConfig:= CreateOleObject('CDO.Configuration');

   try 

    schema:= 'http://schemas.microsoft.com/cdo/configuration/';

    mConfig.Fields.Item(schema + 'sendusing'):= 2; // cdoSendUsingPort

    mConfig.Fields.Item(schema + 'smtpserver'):= 'mail.hover.com'//'smtp.gmail.com';

    mConfig.Fields.Item(schema +'smtpserverport'):= 25;  //  25; //587; //465 ssl;  //587;

    mConfig.Fields.Item(schema +'sendusername'):= 'max@kleiner.com';//'maxkleiner1@gmail.com';

    mConfig.Fields.Item(schema + 'sendpassword'):= '';

    mConfig.Fields.Item(schema + 'smtpauthenticate'):= 1;

    mConfig.Fields.Item(schema + 'smtpusessl'):= True;

    mConfig.Fields.Item(schema + 'smtpconnectiontimeout'):= 30;

    mConfig.Fields.Update(); 

    mMessage.Configuration:= mConfig;

    mMessage.From:= mFrom;

    //mMessage.To:= mTo;

    mMessage.CC:= mTo;

    mMessage.Subject:= mSubject;

    mMessage.HTMLBody:= mBody;   


    {if(0 < mAttachment.length) {
      mMessage.AddAttachment(mAttachment);
     }

    mMessage.Send();    

 Except

    writeln('Log.Error("E-mail cannot be sent", exception.description)');

    //result:= false;  

  end;

  writeln('Log.Message("Message to <" + mTo +  "> was successfully sent");');

  //return true;  *)

  mConfig:= unassigned;

  mMessage:= Unassigned;
  //if mConfig <> ''  then
  

end;

//const MaxCardinal = Cardinal(High(Cardinal));

var xlApp: variant;
    wd64: word64;
    lg64: largeint;
    nint: nativeint;
    aca: cardinal;
    pcname: string;
    acon: THelpContext;



BEGIN  //Main  APP
//<Executable statements>
   div_dbl:= 5.0 / 2.0; // 2.500000
   writeln(Format('%0.6f', [div_dbl]))
   div_dbl:= 20 mod 3;  // 2.00000
   writeln(Format('%f', [div_dbl]))
   a:= 5; b:= 6;
   if not (A<>B) then writeln('even') else
                    writeln('odd');   
   if (A=B) then writeln('even') else
                    writeln('odd');   

   // wholee ASCII Table
   { writeln(Chr(67))
   for i:= 0 to 255 do
     writeln(format('wert %d %s',[i, Chr(i)]))}
    writeln(Format('%s',[inttobin(97)]))
    writeln(Format('%s',[inttobin(223)]))
    writeln(Format('%s',[inttobin(97 XOR 223)]))
    bin1:= 97; bin2:= 223;
    bin3:= bin1 XOR bin2;
    writeln(Format('%s',[IntToBin(bin3)]))
    writeln(' ');
    wd:= 150;
    writeln('first     '+IntToBin(wd))
    writeln(IntToStr(wd))
    //double the value
    wd:= wd SHL 1
    writeln('double '+IntToBin(wd))
    writeln(IntToStr(wd))
    //half the value
    wd:= wd SHR 1
    writeln('half     '+IntToBin(wd))
    writeln(IntToStr(wd))
    //init the value
    writeln('init      '+IntToBin(wd))
    writeln('          '+IntToBin(wd XOR wd))

    AllBooleanPattern(10,12);
    
    //FormBuilder
    InitCreateForms;
    
    with tradiogroup.create(self) do begin
      //flipchildren
      free;
    end;  
    TestJvTFUtils;
    //josephusProblem;
    writeln('');
    writeln('josephus '+inttostr(josephus(41,3)));
    writeln(' ');
    writeln('josephus '+inttostr(josephus(16,3)));  //flavius number
    writeln('josephus '+inttostr(josephus2(41,3)));  //flavius number
    writeln('josephus '+inttostr(josephus_rec(100,10)));  //flavius number
    maxcalcF('242/77');
    maxcalcF('22/7');

    writeln(floattostr(PI));
    
    XLApp:= CreateOleObject('CDO.Message');
    //with XLApp do begin
      //xlapp.From:= 'max@kleinerfake.ch';
      //xlapp.To:= 'max@kleiner.com';
      //xlapp.subject:= 'test max@kleiner.com';
      
    //XLApp.Quit;
    XLAPP:= Unassigned;
   //SendGMail;
    
    //TMailerForm_btnSendMailClick(self);
    //procedure SendEmail(mFrom,  mTo,  mSubject,  mBody,  mAttachment: variant);
   
  //SendEmail('max@kleiner.ch','max@kleiner.com','this is test6','maxbox the SSL fox','');
     // SumClipC
     high(aca);
     writeln(inttostr64(Cardinal(High(aca))));
   //writeln(maxcurrency);
   writeln(floattostr(maxextended));
    writeln(datetimetoStr(gmtnow));
    writeln(datetimetoStr(gmttolocaltime(gmtnow)));
    pcname:= 'APSN21K_Test';
    BrowseComputer(pcname, 'this is PC ',acon);

END. 

The trick is to run the loop in reverse order:

for i := ListBox.Count-1 downto 0 do
  if ListBox.Selected[i] then 
    StringList1.Delete(i);

This way, the act of deleting an item only changes the indices of elements later in the list, and those elements have already been processed.
share|edit


Einstein and Kleiner

Einstein’s controversy with Paul Drude took place in the middle of 1901. It was at this time that Einstein transitioned from Weber to Kleiner and changed his dissertation topic from thermoelectricity to molecular kinetics.

Until 1909 the ETH was not authorized to grant doctoral degrees, so a special arrangement enabled ETH students to obtain doctorates from the University of Zurich. At that time, most dissertations in physics by ETH students were carried out under the supervision of H.F. Weber, Einstein’s former teacher at the Polytechnikum, as it was then called. The University of Zürich had only one physics chair, held by Alfred Kleiner. His main research was focused on measuring instruments, but he also had an interest in the foundations of physics.




       (A<>B)  NOT --> A=B
        0  0 0 1       0 0
        0  1 1 0
        1  0 1 0
        1  1 0 1       1 1
        
        //19.8. um 16 Uhr PT1 Update
        
  XOR App      
  0110 0001
^ 1101 1111
-----------
  1011 1110
        
        
  00000000000000000000000100101100 XOR
  00000000000000000000000100101100
                         000000000
                         
00000000000000000000000000000000     01 False
00000000000000000000000000001000     02 AND
00000000000000000000000000000010     03 Inhibit
00000000000000000000000000001010     04 Prepend
00000000000000000000000000000100     05 Praesect
00000000000000000000000000001100     06 Postpend
00000000000000000000000000000110     07 XOR
00000000000000000000000000001110     08 OR
11111111111111111111111111110001     09 NOR
11111111111111111111111111111001     10 Aequival
11111111111111111111111111110011     11 NegY
11111111111111111111111111111011     12 ImplicatY
11111111111111111111111111110101     13 NegX
11111111111111111111111111111101     14 ImplicatX
11111111111111111111111111110111     15 NAND
11111111111111111111111111111111     16 True                         

----app_template_loaded----

  {K:= add(getbmp(exepath+picpath+'7seg0.bmp'),getbmp(exepath+picpath+'7segaus.bmp'));
    k:= add(getbmp(exepath+'\examples\images\7seg1.bmp'),getbmp(exepath+'\examples\images\7segaus.bmp'));
    add(getbmp(exepath+'\examples\images\7seg2.bmp'),getbmp(exepath+'\examples\images\7segaus.bmp'));
    add(getbmp(exepath+'\examples\images\7seg3.bmp'),getbmp(exepath+'\examples\images\7segaus.bmp'));
    add(getbmp(exepath+'\examples\images\7seg4.bmp'),getbmp(exepath+'\examples\images\7segaus.bmp'));
    add(getbmp(exepath+'\examples\images\7seg5.bmp'),getbmp(exepath+'\examples\images\7segaus.bmp'));
    add(getbmp(exepath+'\examples\images\7seg6.bmp'),getbmp(exepath+'\examples\images\7segaus.bmp'));
    add(getbmp(exepath+'\examples\images\7seg7.bmp'),getbmp(exepath+'\examples\images\7segaus.bmp'));
    add(getbmp(exepath+'\examples\images\7seg8.bmp'),getbmp(exepath+'\examples\images\7segaus.bmp'));
    add(getbmp(exepath+'\examples\images\7seg9.bmp'),getbmp(exepath+'\examples\images\7segaus.bmp'));}
Let’s say you have placed Image list and an Image on your form and populated the list with few state images
	
var
  MyImageList: TImageList;
  MyImage: TImage;
Canvas

That is probably the easiest case. Lets draw an image on canvas of some control (OwnerDraw situation) and also center it. X, Y are top left corner of the future image and Width is a width of the rectangle we want to center image in.
MyImageIndex is an index of the image in the Image List.
?
1
	
MyImageList.Draw(Canvas, X + Width div 2 - MyImageList.Width div 2, Y, MyImageIndex, dsNormal, itImage);
TImage

Being a little bit more complex, it does require some extra code.
	
// Make sure that any prior state is cleared.
// If you do not do that with transparency enabled, you would see
// images on top of each other
MyImage.Picture.Bitmap := nil;
// Make sure that transparency pixel in the image is taken
// in consideration
MyImage.Picture.Bitmap.TransparentMode := tmFixed;
MyImage.Picture.Bitmap.TransparentColor := clWhite;
// Load image from the Image list into TImage
MyImageList.GetBitmap(MyImageIndex, MyImage.Picture.Bitmap);

Das Josephus-Problem (oder "Abzählreim-Problem") lautet wie folgt: n Objekte werden in einem Kreis angeordnet und jedes m-te Objekt wird entfernt, bis nur noch ein Objekt übrigbleibt. Das ursprüngliche Problem geht auf einen Selbstmordabkommen von 41 Jüdischen Aufständischen zurück, die von den Römern im 1. Jahrhundert vor Christus gefangen genommen wurden. Die Aufständischen entschlossen sich, jede dritte Person zu töten, bis keiner mehr übriggeblieben war, aber Flavius Josephus, der Historiker, der überlebte und die Geschichte weitergab, errechnete schnell, wo er und ein Freund sich positionieren mußten, so daß nur sie beide überlebten. Schreiben Sie eine Funktion, die das "verallgemeinerte Josephus-Problem" (oder "Abzählreim-Problem") für beliebige m und n löst: Man plaziere n Objekte in einem Ring und lösche jedes m-te Element bis nur noch eines übrig ist. Dessen Position ist die Flavius-Zahl von m und n. Es ist also eine Funktion
Flavius(m, n: INTEGER): INTEGER
zu schreiben, in der das Abzählen simuliert wird! 

When we tabulate the values of n and f(n) we see a pattern:
n     1 	2 	3 	4 	5 	6 	7 	8 	9 	10 	11 	12 13	14 15 16
(n) 	1 	1 	3 	1 	3 	5 	7 	1 	3 	5 	7     9 11 13  15 1



CC 21004 SNCF Epoche IV, Digitalschnittstelle, Jouef HJ2139 NEU SUPERMODELL.
Die CC 21000 wurde zwischen 1969 und 1974 in 4 Exemplaren für den schweren gemischten Dienst beschafft. Es handelt sich um eine Mehrsystemlok, die sowohl im 1500 Volt Gleichstromnetz wie im 25000 Volt Wechselstromnetz betrieben werden kann. 2 unterschiedliche Fahrstufen erlauben eine Ansteuerung als hoch leistungsstarke Güterzuglok oder als bis zu 220 km/h schnelle Personenzuglok.
Die wuchtige Maschine zählt zur Type der "Nez cassés" mit der charakteristischen gezackten Front. Die Mehrsystemfähigkeit zeigt sich äußerlich an den drei Pantographen mit teilweise Doppelschleifstücken. Alle Details dieser Lok werden vom Jouef Modell perfekt getroffen. Diese Modellgeneration ist absolut akuteller Modellbau und hat nichts mit den früheren Modellen derselben Firma gemein.
Als Mehrsystemlokomotive war die CC 21000 in der Lage, die TEE Züge Cisalpin und Arbalete zwischen Dijon und Vallorbe zu befördern. Wer die schönen INOX Wagen von L.S. Models oder Jouef besitzt, für den wird mit diesem langersehnten Modell ein Wunsch wahr. So kann die Übergabe in Vallorbe an die Re 4/4 II TEE der SBB nachgestellt werden. Mit beiden Loks ist dieser Zug ein Augenschmaus. Eine CC 21000 war jahrelang nicht im Programm der Modellbahn-Hersteller.

    Das Modell ist unbespielt und in absolutem Neu-Zustand.
    Probefahrt vor- und rückwärts einwandfrei.
    Filigrane Pantographen, teilweise mit Doppelschleifstücken.
    Absolut gleichmäßiger und leiser Lauf, hervorragende Langsamfahreigenschaften..
    Wechselndes Spitzenlicht.
    Äußerst fein detailliertes Gehäuse mit perfekt lupenreiner Beschriftung.
    Das Modell wird mit zahlreichen Zurüstteilen verfeinert, Zurüstbeutel liegen ungeöffnet bei.
    Der abgebildete SNCF INOX Wagen dient nur der Illustration einer sinnvollen Zugbildung, der Wagen ist im Angebot nicht enthalten.
    Originalverpackung mit Papieren und vollständigen Zurüstteilen.
    Weitere Modelle der Epochen III und IV in anderen Auktionen.
    
    
unit MainUnit;

interface

uses
  inifiles, Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, IdComponent, IdTCPConnection, IdTCPClient, IdMessageClient,
  IdSMTP, ComCtrls, StdCtrls, Buttons, ExtCtrls, IdBaseComponent, IdMessage;

type
  TMailerForm = class(TForm)
    MailMessage: TIdMessage;
    pnlTop: TPanel;
    pnlBottom: TPanel;
    ledHost: TLabeledEdit;
    Body: TMemo;
    ledAttachment: TLabeledEdit;
    btnAttachment: TBitBtn;
    SMTP: TIdSMTP;
    ledFrom: TLabeledEdit;
    ledTo: TLabeledEdit;
    ledCC: TLabeledEdit;
    ledSubject: TLabeledEdit;
    btnSendMail: TBitBtn;
    StatusMemo: TMemo;
    AttachmentDialog: TOpenDialog;
    procedure btnSendMailClick(Sender: TObject);
    procedure SMTPStatus(ASender: TObject; const AStatus: TIdStatus;
      const AStatusText: String);
    procedure btnAttachmentClick(Sender: TObject);
    procedure FormCreate(Sender: TObject);
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
  private
    procedure GetSettings;
    procedure SaveSettings;
  public
    { Public declarations }
  end;

var
  MailerForm: TMailerForm;

implementation

//{$R *.dfm}

procedure TMailerForm.btnSendMailClick(Sender: TObject);
begin
  StatusMemo.Clear;

  //setup SMTP
  SMTP.Host := ledHost.Text;
  SMTP.Port := 25;

  //setup mail message
  MailMessage.From.Address := ledFrom.Text;
  MailMessage.Recipients.EMailAddresses := ledTo.Text + ',' + ledCC.Text;

  MailMessage.Subject := ledSubject.Text;
  MailMessage.Body.Text := Body.Text;

  if FileExists(ledAttachment.Text) then
    TIdAttachment.Create(MailMessage.MessageParts, ledAttachment.Text);

  //send mail
  try
    try
      SMTP.Connect(1000);
      SMTP.Send(MailMessage);
    except on E:Exception do
      StatusMemo.Lines.Insert(0, 'ERROR: ' + E.Message);
    end;
  finally
    if SMTP.Connected then SMTP.Disconnect;
  end;

end; (* btnSendMail Click *)

procedure TMailerForm.SMTPStatus(ASender: TObject; const AStatus: TIdStatus;
  const AStatusText: String);
begin
  StatusMemo.Lines.Insert(0,'Status: ' + AStatusText);
end; (* SMTP Status *)

procedure TMailerForm.btnAttachmentClick(Sender: TObject);
begin
  if AttachmentDialog.Execute then
    ledAttachment.Text := AttachmentDialog.FileName;
end;

procedure TMailerForm.FormCreate(Sender: TObject);
begin
  GetSettings;
end;

procedure TMailerForm.FormClose(Sender: TObject; var Action: TCloseAction);
begin
  SaveSettings;
end;

procedure TMailerForm.GetSettings;
var
  ini : TIniFile;
begin
  Ini := TIniFile.Create(ChangeFileExt(Application.ExeName,'.ini'));
  try
    ledHost.Text := ini.ReadString('SMTP','Host','');

    ledFrom.Text := ini.ReadString('MAIL','From','');
    ledTo.Text := ini.ReadString('MAIL','To','');
    ledCC.Text := ini.ReadString('MAIL','CC','');
  finally
    ini.Free;
  end;
end; (* GetSettings *)

procedure TMailerForm.SaveSettings;
var
  ini : TIniFile;
begin
  Ini := TIniFile.Create(ChangeFileExt(Application.ExeName,'.ini'));
  try
    ini.WriteString('SMTP','Host',ledHost.Text);

    ini.WriteString('MAIL','From',ledFrom.Text);
    ini.WriteString('MAIL','To',ledTo.Text);
    ini.WriteString('MAIL','CC',ledCC.Text);
  finally
    ini.Free;
  end;
end; (* SaveSettings *)

end.
    
    
    
begin
  IDSMTP1 := TIDSMTP.Create;
  IdSSLIOHandlerSocketOpenSSL1 := TIdSSLIOHandlerSocketOpenSSL.Create;
  try

    with IDSMTP1 do
    begin
      Host := srvr.Host;
      Port := srvr.Port;
      if (srvr.needAuthentication = 'Y') then
        AuthType := satDefault
      else
        AuthType := satNone;
      IOHandler := IdSSLIOHandlerSocketOpenSSL1;

      if (srvr.secureMode = 'Y') then
        UseTLS := utUseRequireTLS
      else
        UseTLS := utNoTLSSupport;

      Username := srvr.Username;
      Password := srvr.Password;
    end;

    idMBHTML := TIdMessageBuilderHTML.Create;
    Idmessage1 := TIDMessage.Create;

    try
      with idMBHTML do
      begin
        enc := TEncoding.Unicode;
        HTML.LoadFromStream(FEmlMsg.MsgBody, enc);
        for c := 0 to FEmlMsg.Attachmnts.Count - 1 do
          Attachments.Add(FEmlMsg.Attachmnts[c]);
        FillMessage(IDMessage1);
      end;

      with Idmessage1 do
      begin
        Subject := FEmlMsg.MsgSubject;
        From.Address := FEmlMsg.FromAddress;
        From.Name := FEmlMsg.FromName;
        Recipients.EMailAddresses := FEmlMsg.RecipientAddress;
        if FEmlMsg.ReceiptRecipientAddress <> '' then
          ReceiptRecipient.Address := FEmlMsg.ReceiptRecipientAddress;
        if FEmlMsg.ReceiptRecipientName <> '' then
          ReceiptRecipient.Name := FEmlMsg.ReceiptRecipientName;
      end;

      with IDSMTP1 do
      begin
        if not Connected then
          Connect;
        Send(IdMessage1);
      end;

    finally
      Idmessage1.Free;
      idMBHTML.Free;
    end;
  finally
    IDSMTP1.Free;
    IdSSLIOHandlerSocketOpenSSL1.Free;
  end;
end;    


Mar 24, 2012 – Outgoing Mail (SMTP): mail.hover.com ... If you're unable to send email, switch to port 465 (if SSL is enabled) or port 587 or ... This means, all your messages and folders will be available to you no matter what device you are ...