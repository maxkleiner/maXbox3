Version:0.9
StartHTML:0000000105
EndHTML:0000255509
StartFragment:0000001037
EndFragment:0000255493
<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>mXScriptasHTML</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<meta name="generator" content="SynEdit HTML exporter" />
<style type="text/css">
<!--
body { color: #000000; background-color: #FFFFFF; }
.pas1-assembler { }
.pas1-character { text-decoration: underline; }
.pas1-comment { color: #000080; font-style: italic; }
.pas1-float { color: #800080; }
.pas1-hexadecimal { color: #FF00FF; }
.pas1-identifier { }
.pas1-number { color: #FF0000; }
.pas1-preprocessor { font-style: italic; }
.pas1-reservedword { color: #000000; font-weight: bold; }
.pas1-space { }
.pas1-string { color: #008080; }
.pas1-symbol { color: #000000; }
-->
</style>
</head>
<body>
<!--StartFragment--><pre><code><span class="pas1-comment">//Example of the memo load and save capabilities of the VCL
//Task: Make the 3rd algo too!
//Get the text and write your memo memories, locs=1460 

</span><span class="pas1-reservedword">program</span><span class="pas1-space"> String_Functions_For_39;

</span><span class="pas1-comment">//uses StringGridTools;

</span><span class="pas1-reservedword">const</span><span class="pas1-space"> LEFTBASE = </span><span class="pas1-number">20</span><span class="pas1-symbol">;
      TOPBASE = </span><span class="pas1-number">25</span><span class="pas1-symbol">; 
      VARRSIZE = </span><span class="pas1-number">200</span><span class="pas1-symbol">;


</span><span class="pas1-reservedword">type
</span><span class="pas1-space">  </span><span class="pas1-comment">//TThreadSortArray = array[0..MaxInt div SizeOf(Integer) - 1] of Integer;
</span><span class="pas1-space">  TmSortArray =  </span><span class="pas1-reservedword">array</span><span class="pas1-symbol">[</span><span class="pas1-number">0</span><span class="pas1-symbol">..VARRSIZE] </span><span class="pas1-reservedword">of</span><span class="pas1-space"> Integer;

</span><span class="pas1-reservedword">var</span><span class="pas1-space"> 
  mymemo: TMemo;
  mpaint, mpaint2, mpaint3: TPaintBox;
  </span><span class="pas1-comment">//BubbleSortBox, SelectionSortBox, QuickSortBox: TPaintBox;
</span><span class="pas1-space">  bigstring: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
  inFrm: TForm;  
  mbtn3: TBitBtn;
  Lstbox: TListbox;
  stat: TStatusbar;
  selectedFile: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
  BubbleSortArray: TSortArray;
  SelectionSortArray: TSortArray;
  QuickSortArray: TSortArray;
  ArraysRandom: Boolean;
  FA, FB, FI, FJ: Integer;
  ThreadsRunning: byte;


</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> PaintLine(Canvas: TCanvas; I, Len: Integer); </span><span class="pas1-reservedword">forward</span><span class="pas1-symbol">;


</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> RandomizeArrays;
</span><span class="pas1-reservedword">var
</span><span class="pas1-space">  I: Integer;
</span><span class="pas1-reservedword">begin
</span><span class="pas1-space">   </span><span class="pas1-comment">//I:= 0;
</span><span class="pas1-space">   </span><span class="pas1-comment">//if b then dialogs.showmessage('this is')
</span><span class="pas1-space">   assert2(high(BubbleSortArray) &lt;= </span><span class="pas1-number">180</span><span class="pas1-symbol">, </span><span class="pas1-string">'array to big'</span><span class="pas1-symbol">);
  </span><span class="pas1-comment">//Check(high(BubbleSortArray) &lt;= 170, 'array to big');
</span><span class="pas1-space">  </span><span class="pas1-reservedword">if</span><span class="pas1-space"> </span><span class="pas1-reservedword">not</span><span class="pas1-space"> ArraysRandom </span><span class="pas1-reservedword">then</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-space">    Randomize;
    writeln(inttostr(arrsize))
    </span><span class="pas1-reservedword">for</span><span class="pas1-space"> I:= </span><span class="pas1-number">1</span><span class="pas1-space"> </span><span class="pas1-reservedword">to</span><span class="pas1-space"> ARRSIZE - </span><span class="pas1-number">1</span><span class="pas1-space"> </span><span class="pas1-reservedword">do
</span><span class="pas1-space">     </span><span class="pas1-comment">//SelectionSortarray[i]:= random(165);
</span><span class="pas1-space">    </span><span class="pas1-comment">//writeln(inttostr(i));
</span><span class="pas1-space">    BubbleSortArray[I]:= Random(</span><span class="pas1-number">170</span><span class="pas1-symbol">);
    SelectionSortArray:= BubbleSortArray;
    QuickSortArray:= BubbleSortArray;
    writeln(</span><span class="pas1-string">'just random thread done'</span><span class="pas1-symbol">)
  </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;  

</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> PaintRandomArray;
</span><span class="pas1-reservedword">var</span><span class="pas1-space"> I: integer;
</span><span class="pas1-reservedword">begin
</span><span class="pas1-space">  mPaint2.Canvas.Pen.Color:= clblue;
  </span><span class="pas1-reservedword">for</span><span class="pas1-space"> I:= Low(QuickSortArray) </span><span class="pas1-reservedword">to</span><span class="pas1-space"> High(QuickSortArray) </span><span class="pas1-reservedword">do
</span><span class="pas1-space">    PaintLine(mpaint3.Canvas, I, QuickSortArray[I]);
  </span><span class="pas1-reservedword">for</span><span class="pas1-space"> I:= Low(SelectionSortArray) </span><span class="pas1-reservedword">to</span><span class="pas1-space"> High(SelectionSortArray) </span><span class="pas1-reservedword">do
</span><span class="pas1-space">    PaintLine(mpaint2.Canvas, I, SelectionSortArray[I]);
  mPaint.Canvas.Pen.Color:= clgreen;
  </span><span class="pas1-reservedword">for</span><span class="pas1-space"> I:= Low(BubbleSortArray) </span><span class="pas1-reservedword">to</span><span class="pas1-space"> High(BubbleSortArray) </span><span class="pas1-reservedword">do
</span><span class="pas1-space">    PaintLine(mpaint.Canvas, I, BubbleSortArray[I])
</span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;


</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> PaintLine(Canvas: TCanvas; I, Len: Integer);
</span><span class="pas1-reservedword">begin
</span><span class="pas1-space">  canvas.moveTo(</span><span class="pas1-number">0</span><span class="pas1-symbol">, I * </span><span class="pas1-number">2</span><span class="pas1-space"> + </span><span class="pas1-number">1</span><span class="pas1-symbol">)
  canvas.LineTo(Len, I * </span><span class="pas1-number">2</span><span class="pas1-space"> + </span><span class="pas1-number">1</span><span class="pas1-symbol">)
  </span><span class="pas1-comment">//Canvas.PolyLine([Point(0, I * 2 + 1), Point(Len, I * 2 + 1)]);
</span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;

</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> DoVisualSwap2;
</span><span class="pas1-reservedword">begin
</span><span class="pas1-space">  </span><span class="pas1-reservedword">with</span><span class="pas1-space"> mpaint2 </span><span class="pas1-reservedword">do</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-space">    </span><span class="pas1-comment">//invalidate;
</span><span class="pas1-space">    Canvas.Pen.Color:= clBtnFace;
    </span><span class="pas1-comment">//Canvas.Pen.Color:= clBlue;
</span><span class="pas1-space">    PaintLine(Canvas, FI, FA);
    PaintLine(Canvas, FJ, FB);
    Canvas.Pen.Color:= clRed;
    PaintLine(Canvas, FI, FB);
    PaintLine(Canvas, FJ, FA);
  </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;

</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> DoVisualSwap;
</span><span class="pas1-reservedword">begin
</span><span class="pas1-space">  </span><span class="pas1-reservedword">with</span><span class="pas1-space"> mpaint </span><span class="pas1-reservedword">do</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-space">    </span><span class="pas1-comment">//invalidate;
</span><span class="pas1-space">    Canvas.Pen.Color:= clBtnFace;
    </span><span class="pas1-comment">//Canvas.Pen.Color:= clBlue;
</span><span class="pas1-space">    PaintLine(Canvas, FI, FA);
    PaintLine(Canvas, FJ, FB);
    Canvas.Pen.Color:= clRed;
    PaintLine(Canvas, FI, FB);
    PaintLine(Canvas, FJ, FA);
  </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;


</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> VisualSwap2(A, B, I, J: Integer);
</span><span class="pas1-reservedword">begin
</span><span class="pas1-space">  </span><span class="pas1-comment">//symbol rename
</span><span class="pas1-space">  FA:= A; FB:= B;
  FI:= I; FJ:= J;
  </span><span class="pas1-comment">//DoVisualSwap;
</span><span class="pas1-space">  DoVisualSwap2;
</span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;

</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> VisualSwap(A, B, I, J: Integer);
</span><span class="pas1-reservedword">begin
</span><span class="pas1-space">  </span><span class="pas1-comment">//symbol rename
</span><span class="pas1-space">  FA:= A;
  FB:= B;
  FI:= I;
  FJ:= J;
  </span><span class="pas1-comment">//if bolTHslowmotion then
</span><span class="pas1-space">    </span><span class="pas1-comment">//        sysutils.sleep(5);
</span><span class="pas1-space">  DoVisualSwap;
  DoVisualSwap2;
</span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
  
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> TmSelectionSort(</span><span class="pas1-reservedword">var</span><span class="pas1-space"> A: TmSortArray);
</span><span class="pas1-comment">// syncedit
</span><span class="pas1-reservedword">var
</span><span class="pas1-space"> indx, J, T: Integer;
</span><span class="pas1-reservedword">begin
</span><span class="pas1-space">  </span><span class="pas1-reservedword">for</span><span class="pas1-space"> indx := Low(A) </span><span class="pas1-reservedword">to</span><span class="pas1-space"> High(A) - </span><span class="pas1-number">1</span><span class="pas1-space"> </span><span class="pas1-reservedword">do
</span><span class="pas1-space">    </span><span class="pas1-reservedword">for</span><span class="pas1-space"> J := High(A) </span><span class="pas1-reservedword">downto</span><span class="pas1-space"> indx + </span><span class="pas1-number">1</span><span class="pas1-space"> </span><span class="pas1-reservedword">do
</span><span class="pas1-space">      </span><span class="pas1-reservedword">if</span><span class="pas1-space"> A[indx] &gt; A[J] </span><span class="pas1-reservedword">then</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-space">        VisualSwap(A[indx], A[J], indx, J);
        </span><span class="pas1-comment">//write('debug')
</span><span class="pas1-space">        T:= A[indx];
        A[indx] := A[J];
        A[J] := T;
        </span><span class="pas1-comment">//if Terminated then Exit;
</span><span class="pas1-space">      </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">end</span><span class="pas1-symbol">; 

</span><span class="pas1-comment">{ TBubbleSort }
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> TmBubbleSort(</span><span class="pas1-reservedword">var</span><span class="pas1-space"> A: TmSortArray);
</span><span class="pas1-reservedword">var
</span><span class="pas1-space">  I, J, T: Integer;
</span><span class="pas1-reservedword">begin
</span><span class="pas1-space">  </span><span class="pas1-reservedword">for</span><span class="pas1-space"> I := High(A) </span><span class="pas1-reservedword">downto</span><span class="pas1-space"> Low(A) </span><span class="pas1-reservedword">do
</span><span class="pas1-space">    </span><span class="pas1-reservedword">for</span><span class="pas1-space"> J := Low(A) </span><span class="pas1-reservedword">to</span><span class="pas1-space"> High(A) - </span><span class="pas1-number">1</span><span class="pas1-space"> </span><span class="pas1-reservedword">do
</span><span class="pas1-space">      </span><span class="pas1-reservedword">if</span><span class="pas1-space"> A[J] &gt; A[J + </span><span class="pas1-number">1</span><span class="pas1-symbol">] </span><span class="pas1-reservedword">then</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-space">        VisualSwap2(A[J], A[J + </span><span class="pas1-number">1</span><span class="pas1-symbol">], J, J + </span><span class="pas1-number">1</span><span class="pas1-symbol">);
        T := A[J];
        A[J] := A[J + </span><span class="pas1-number">1</span><span class="pas1-symbol">];
        A[J + </span><span class="pas1-number">1</span><span class="pas1-symbol">] := T;
     </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">end</span><span class="pas1-symbol">; 



</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> QuickSort(</span><span class="pas1-reservedword">var</span><span class="pas1-space"> A: TmSortArray; iLo, iHi: Integer);
  </span><span class="pas1-reservedword">var
</span><span class="pas1-space">    Lo, Hi, Mid, T: Integer;
  </span><span class="pas1-reservedword">begin
</span><span class="pas1-space">    Lo := iLo;
    Hi := iHi;
    </span><span class="pas1-comment">// inline variable
</span><span class="pas1-space">    Mid:= A[(Lo + Hi) </span><span class="pas1-reservedword">div</span><span class="pas1-space"> </span><span class="pas1-number">2</span><span class="pas1-symbol">];
    </span><span class="pas1-reservedword">repeat
</span><span class="pas1-space">      </span><span class="pas1-reservedword">while</span><span class="pas1-space"> A[Lo] &lt; Mid
                    </span><span class="pas1-reservedword">do</span><span class="pas1-space"> Inc(Lo);
      </span><span class="pas1-reservedword">while</span><span class="pas1-space"> A[Hi] &gt; Mid
                    </span><span class="pas1-reservedword">do</span><span class="pas1-space"> Dec(Hi);
      </span><span class="pas1-reservedword">if</span><span class="pas1-space"> Lo &lt;= Hi </span><span class="pas1-reservedword">then</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-space">        VisualSwap(A[Lo], A[Hi], Lo, Hi);
        T:= A[Lo];
        A[Lo]:= A[Hi];
        A[Hi]:= T;
        Inc(Lo);
        Dec(Hi);
      </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
    </span><span class="pas1-reservedword">until</span><span class="pas1-space"> Lo &gt; Hi;
    </span><span class="pas1-reservedword">if</span><span class="pas1-space"> Hi &gt; iLo </span><span class="pas1-reservedword">then</span><span class="pas1-space"> QuickSort(A, iLo, Hi);
    </span><span class="pas1-reservedword">if</span><span class="pas1-space"> Lo &lt; iHi </span><span class="pas1-reservedword">then</span><span class="pas1-space"> QuickSort(A, Lo, iHi);
    </span><span class="pas1-comment">//if Terminated then Exit;
</span><span class="pas1-space">  </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;

</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> TmQuickSort(</span><span class="pas1-reservedword">var</span><span class="pas1-space"> A: TmSortArray);
</span><span class="pas1-reservedword">begin
</span><span class="pas1-space">  QuickSort(A, Low(A), High(A));
</span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;

  
</span><span class="pas1-reservedword">Function</span><span class="pas1-space"> getRandomText: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">var</span><span class="pas1-space"> i, getback: integer;
</span><span class="pas1-reservedword">begin
</span><span class="pas1-space">  result:= Chr(</span><span class="pas1-number">32</span><span class="pas1-symbol">)
  </span><span class="pas1-reservedword">for</span><span class="pas1-space"> i:= </span><span class="pas1-number">1</span><span class="pas1-space"> </span><span class="pas1-reservedword">to</span><span class="pas1-space"> </span><span class="pas1-number">1400</span><span class="pas1-space"> </span><span class="pas1-reservedword">do</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-space">    getback:=  random(</span><span class="pas1-number">58</span><span class="pas1-symbol">)+</span><span class="pas1-number">65
</span><span class="pas1-space">    </span><span class="pas1-reservedword">if</span><span class="pas1-space"> (getback &lt; </span><span class="pas1-number">91</span><span class="pas1-symbol">) </span><span class="pas1-reservedword">OR</span><span class="pas1-space"> (getback &gt; </span><span class="pas1-number">96</span><span class="pas1-symbol">) </span><span class="pas1-reservedword">then
</span><span class="pas1-space">      result:= result + Chr(getback) +Chr(</span><span class="pas1-number">32</span><span class="pas1-symbol">)
  </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;  
  
</span><span class="pas1-comment">//Event Handler - Closure  
</span><span class="pas1-reservedword">Procedure</span><span class="pas1-space"> GetMediaData(self: TObject);
</span><span class="pas1-reservedword">begin
</span><span class="pas1-space">  </span><span class="pas1-reservedword">if</span><span class="pas1-space"> PromptForFileName(selectedFile,
                       </span><span class="pas1-string">'Text files (*.txt)|*.txt'</span><span class="pas1-symbol">,</span><span class="pas1-string">''</span><span class="pas1-symbol">,
                       </span><span class="pas1-string">'Select your mX3 test file'</span><span class="pas1-symbol">,
                       ExePath+</span><span class="pas1-string">'examples\'</span><span class="pas1-symbol">, False)  </span><span class="pas1-comment">// Means not a Save dialog !
</span><span class="pas1-space">   </span><span class="pas1-reservedword">then</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-space">     </span><span class="pas1-comment">// Display this full file/path value
</span><span class="pas1-space">     ShowMessage(</span><span class="pas1-string">'Selected file = '</span><span class="pas1-symbol">+selectedFile);
     Stat.simpletext:= selectedFile;
     mymemo.lines.LoadFromFile(selectedFile);
     </span><span class="pas1-comment">// Split this full file/path value into its constituent parts
</span><span class="pas1-space">     </span><span class="pas1-comment">//writeln('PromptForFileName_28: Res of processpath '+tmp)
</span><span class="pas1-space">   </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">end</span><span class="pas1-symbol">; 

</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> ThreadDone(Sender: TObject);
</span><span class="pas1-reservedword">begin
</span><span class="pas1-space">  Dec(ThreadsRunning);
  </span><span class="pas1-reservedword">if</span><span class="pas1-space"> ThreadsRunning = </span><span class="pas1-number">0</span><span class="pas1-space"> </span><span class="pas1-reservedword">then</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-space">    </span><span class="pas1-comment">//StartBtn.Enabled:= True;
</span><span class="pas1-space">    </span><span class="pas1-comment">//randArray.ArraysRandom:= False;
</span><span class="pas1-space">    Writeln(</span><span class="pas1-string">'all threads gone'</span><span class="pas1-symbol">);
  </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;


</span><span class="pas1-comment">//Event Handler - Closure
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> BtnStartClick(self: TObject);
</span><span class="pas1-reservedword">begin
</span><span class="pas1-space">  </span><span class="pas1-comment">//mymemo.lines.savetofile(ExePath+'\examples\mymemomemoire.txt');
</span><span class="pas1-space">  mymemo.lines.text:= getRandomText;
  mPaint.invalidate;
  mPaint2.invalidate;
  mPaint3.invalidate;
  ThreadsRunning:= </span><span class="pas1-number">3</span><span class="pas1-symbol">;
  RandomizeArrays;
  </span><span class="pas1-comment">//PaintRandomArray;
</span><span class="pas1-space"> </span><span class="pas1-comment">{ with TSortThread.Create(mPaint, bubblesortarray) do begin
    slowmotion:= 200;
   end;}
</span><span class="pas1-space">   </span><span class="pas1-comment">//marr:= TRandomArray.create;
</span><span class="pas1-space">   </span><span class="pas1-comment">//marr.RandomizeArrays(inFrm, false)
</span><span class="pas1-space">    </span><span class="pas1-comment">//marr.PaintArray(mPaint) 
</span><span class="pas1-space">    </span><span class="pas1-comment">//bubblesortbox
</span><span class="pas1-space">  ProcessMessagesOFF;  
  </span><span class="pas1-reservedword">with</span><span class="pas1-space"> TBubbleSort.Create(mpaint, BubbleSortArray) </span><span class="pas1-reservedword">do</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-space">    bolTHslowmotion:= true;
    slowmotion:= </span><span class="pas1-number">0</span><span class="pas1-symbol">;
    </span><span class="pas1-comment">//sort
</span><span class="pas1-space">    OnTerminate:= @ThreadDone;
  </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
  </span><span class="pas1-comment">//selectionsortbox
</span><span class="pas1-space">  </span><span class="pas1-reservedword">with</span><span class="pas1-space"> TSelectionSort.Create(mpaint2, SelectionSortArray) </span><span class="pas1-reservedword">do</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-space">    bolTHslowmotion:= true;
    slowmotion:= </span><span class="pas1-number">0</span><span class="pas1-symbol">;
    </span><span class="pas1-comment">//sort
</span><span class="pas1-space">    OnTerminate:= @ThreadDone;
  </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
  </span><span class="pas1-comment">//application.ProcessMessages;
</span><span class="pas1-space">  </span><span class="pas1-reservedword">with</span><span class="pas1-space"> TQuickSort.Create(mpaint3, QuickSortArray) </span><span class="pas1-reservedword">do</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-space">    bolTHslowmotion:= true;
    slowmotion:= </span><span class="pas1-number">0</span><span class="pas1-symbol">;
    </span><span class="pas1-comment">//sort
</span><span class="pas1-space">    OnTerminate:= @ThreadDone;
  </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
  ProcessMessagesON;  
 
  </span><span class="pas1-comment">//marr.Free;
</span><span class="pas1-space">  </span><span class="pas1-comment">//msort:= TSortThread.Create(mPaint,sortarray)
</span><span class="pas1-space">  </span><span class="pas1-comment">//TmSelectionSort(selectionSortArray)
</span><span class="pas1-space">  </span><span class="pas1-comment">//TmBubbleSort(bubbleSortArray)

</span><span class="pas1-space">  </span><span class="pas1-comment">//mymemo.lines.SaveToFile(selectedFile);
</span><span class="pas1-space">  Stat.simpletext:= </span><span class="pas1-string">' start has been sorted'</span><span class="pas1-space"> ;
</span><span class="pas1-reservedword">end</span><span class="pas1-symbol">; 

</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> GetRandom(self: TObject);
</span><span class="pas1-reservedword">begin
</span><span class="pas1-space">  </span><span class="pas1-comment">//mymemo.lines.savetofile(ExePath+'\examples\mymemomemoire.txt');
</span><span class="pas1-space">  mymemo.lines.text:= getRandomText;
  mPaint.invalidate;
  mPaint2.invalidate;
  mPaint3.invalidate;
  RandomizeArrays;
  PaintRandomArray;
</span><span class="pas1-reservedword">end</span><span class="pas1-symbol">; 


</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> BtnSortClick(self: TObject);
</span><span class="pas1-reservedword">begin
</span><span class="pas1-space">  </span><span class="pas1-comment">//mymemo.lines.savetofile(ExePath+'\examples\mymemomemoire.txt');
</span><span class="pas1-space">  </span><span class="pas1-comment">//RandomizeArrays(inFrm);
</span><span class="pas1-space">  </span><span class="pas1-comment">//PaintRandomArray;
</span><span class="pas1-space">  mPaint.invalidate;
  mPaint2.invalidate;
  mPaint3.invalidate;

  </span><span class="pas1-comment">//TmSelectionSort(selectionSortArray)
</span><span class="pas1-space">  </span><span class="pas1-comment">//TmBubbleSort(bubbleSortArray)
</span><span class="pas1-space">  </span><span class="pas1-comment">//mymemo.lines.SaveToFile(selectedFile);
</span><span class="pas1-space">  </span><span class="pas1-comment">//Stat.simpletext:= selectedFile+ ' has been saved' ;
</span><span class="pas1-reservedword">end</span><span class="pas1-symbol">; 


</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> JCLStringsTester;
</span><span class="pas1-reservedword">var</span><span class="pas1-space"> tester, tester2: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
    testeransi: ansistring;
    stl: TStringlist;
</span><span class="pas1-reservedword">begin

</span><span class="pas1-comment">{template s}
</span><span class="pas1-space">  tester:= </span><span class="pas1-string">'this is HEX in the BOX'</span><span class="pas1-symbol">;
  tester2:= </span><span class="pas1-string">'this is MAX in the TEX'</span><span class="pas1-symbol">;
 </span><span class="pas1-comment">//ReplaceFirst(const SourceStr, FindStr, ReplaceStr: string): string;
</span><span class="pas1-space">  writeln(ReplaceFirst(tester, </span><span class="pas1-string">'HEX'</span><span class="pas1-symbol">, </span><span class="pas1-string">'MAX'</span><span class="pas1-symbol">));
 </span><span class="pas1-comment">//ReplaceLast(const SourceStr, FindStr, ReplaceStr: string): string;
</span><span class="pas1-space"> </span><span class="pas1-comment">//InsertLastBlock(var SourceStr: string; BlockStr: string): Boolean;
</span><span class="pas1-space"> </span><span class="pas1-comment">//RemoveMasterBlocks(const SourceStr: string): string;
</span><span class="pas1-space"> </span><span class="pas1-comment">//RemoveFields(const SourceStr: string): string;

{http s}
</span><span class="pas1-space">  testeransi:= </span><span class="pas1-string">'http://www.softwareschule.ch/maxbox.htm'</span><span class="pas1-symbol">;
 </span><span class="pas1-comment">//URLEncode(const Value: AnsiString): AnsiString; // Converts string To A URLEncoded string
</span><span class="pas1-space"> writeln(URLEncode(testeransi)); </span><span class="pas1-comment">// Converts string To A URLEncoded string

</span><span class="pas1-space"> </span><span class="pas1-comment">//URLDecode(const Value: AnsiString): AnsiString; // Converts string From A URLEncoded string
</span><span class="pas1-space"> writeln(URLDecode(URLEncode(testeransi))); </span><span class="pas1-comment">// Converts string To A URLEncoded string

{set s}
</span><span class="pas1-space"> </span><span class="pas1-comment">//procedure SplitSet(AText: string; AList: TStringList);
</span><span class="pas1-space"> stl:= TStringlist.Create;
 SplitSet(tester,stl);
 
 writeln(JoinSet(stl));
 writeln(FirstOfSet(tester));
 writeln((LastOfSet(tester)));
 writeln(inttostr(CountOfSet(tester)));
 </span><span class="pas1-comment">//SetRotateRight(const AText: string): string;
</span><span class="pas1-space"> </span><span class="pas1-comment">//SetRotateLeft(const AText: string): string;
</span><span class="pas1-space"> </span><span class="pas1-comment">//SetPick(const AText: string; AIndex: Integer): string;
</span><span class="pas1-space"> Writeln(</span><span class="pas1-string">'sort: '</span><span class="pas1-symbol">+SetSort(tester));
 writeln(</span><span class="pas1-string">'union: '</span><span class="pas1-symbol">+SetUnion(tester, tester2));
 </span><span class="pas1-comment">//SetIntersect(const Set1, Set2: string): string;
</span><span class="pas1-space"> writeln(</span><span class="pas1-string">'intersect: '</span><span class="pas1-symbol">+SetIntersect(tester, tester2));
 
 </span><span class="pas1-comment">//SetExclude(const Set1, Set2: string): string;
</span><span class="pas1-space"> writeln(</span><span class="pas1-string">'exclude: '</span><span class="pas1-symbol">+SetExclude(tester, tester2));

</span><span class="pas1-comment">{replace any &lt;,&gt; etc by &amp;lt; &amp;gt;}
</span><span class="pas1-space"> </span><span class="pas1-comment">//XMLSafe(const AText: string): string;

{simple hash, Result can be used in Encrypt}
</span><span class="pas1-space"> </span><span class="pas1-comment">//Hash(const AText: string): Integer;

</span><span class="pas1-space"> writeln(</span><span class="pas1-string">'hash: '</span><span class="pas1-symbol">+inttostr(Hash(tester)));
 
 SaveString(exepath+</span><span class="pas1-string">'savestring.txt'</span><span class="pas1-symbol">,tester);
 writeln(dateTimeToStr(Easter(</span><span class="pas1-number">2013</span><span class="pas1-symbol">)));


</span><span class="pas1-comment">{ Base64 encode and decode a string }
</span><span class="pas1-space"> </span><span class="pas1-comment">//B64Encode(const S: AnsiString): AnsiString;
</span><span class="pas1-space"> </span><span class="pas1-comment">//B64Decode(const S: AnsiString): AnsiString;

{Basic encryption from a Borland Example}
</span><span class="pas1-space"> </span><span class="pas1-comment">//Encrypt(const InString: AnsiString; StartKey, MultKey, AddKey: Integer): AnsiString;
</span><span class="pas1-space"> </span><span class="pas1-comment">//Decrypt(const InString: AnsiString; StartKey, MultKey, AddKey: Integer): AnsiString;

{Using Encrypt and Decrypt in combination with B64Encode and B64Decode}
</span><span class="pas1-space"> </span><span class="pas1-comment">//EncryptB64(const InString: AnsiString; StartKey, MultKey, AddKey: Integer): AnsiString;
</span><span class="pas1-space"> </span><span class="pas1-comment">//DecryptB64(const InString: AnsiString; StartKey, MultKey, AddKey: Integer): AnsiString;

(*procedure CSVToTags(Src, Dst: TStringList);
// converts a csv list to a tagged string list

procedure TagsToCSV(Src, Dst: TStringList);
// converts a tagged string list to a csv list
// only fieldnames from the first record are scanned ib the other records

procedure ListSelect(Src, Dst: TStringList; const AKey, AValue: string);
{selects akey=avalue from Src and returns recordset in Dst}
procedure ListFilter(Src: TStringList; const AKey, AValue: string);
{filters Src for akey=avalue}
procedure ListOrderBy(Src: TStringList; const AKey: string; Numeric: Boolean);
{orders a tagged Src list by akey}

 PosStr(const FindString, SourceString: string;
  StartPos: Integer = 1): Integer;
{ PosStr searches the first occurrence of a substring FindString in a string
  given by SourceString with case sensitivity (upper and lower case characters
  are differed). This  returns the index value of the first character
  of a specified substring from which it occurs in a given string starting with
  StartPos character index. If a specified substring is not found Q_PosStr
  returns zero. The author of algorithm is Peter Morris (UK) (Faststrings unit
  from www.torry.ru). }

 PosStrLast(const FindString, SourceString: string): Integer;
{finds the last occurance}

 LastPosChar(const FindChar: Char; SourceString: string): Integer;

 PosText(const FindString, SourceString: string;
  StartPos: Integer = 1): Integer;
{ PosText searches the first occurrence of a substring FindString in a string
  given by SourceString without case sensitivity (upper and lower case
  characters are not differed). This  returns the index value of the
  first character of a specified substring from which it occurs in a given
  string starting with StartPos character index. If a specified substring is
  not found Q_PosStr returns zero. The author of algorithm is Peter Morris
  (UK) (Faststrings unit from www.torry.ru). }

 PosTextLast(const FindString, SourceString: string): Integer;
{finds the last occurance}

 NameValuesToXML(const AText: string): string;
{$IFDEF MSWINDOWS}
procedure LoadResourceFile(AFile: string; MemStream: TMemoryStream);
{$ENDIF MSWINDOWS}
procedure DirFiles(const ADir, AMask: string; AFileList: TStringList);
procedure RecurseDirFiles(const ADir: string; var AFileList: TStringList);
procedure RecurseDirProgs(const ADir: string; var AFileList: TStringList);
procedure SaveString(const AFile, AText: string);
 LoadString(const AFile: string): string;
 HexToColor(const AText: string): TColor;
 UppercaseHTMLTags(const AText: string): string;
 LowercaseHTMLTags(const AText: string): string;
procedure GetHTMLAnchors(const AFile: string; AList: TStringList);
 RelativePath(const ASrc, ADst: string): string;
 GetToken(var Start: Integer; const SourceText: string): string;
 PosNonSpace(Start: Integer; const SourceText: string): Integer;
 PosEscaped(Start: Integer; const SourceText, FindText: string; EscapeChar: Char): Integer;
 DeleteEscaped(const SourceText: string; EscapeChar: Char): string;
 BeginOfAttribute(Start: Integer; const SourceText: string): Integer;
// parses the beginning of an attribute: space + alpha character
 ParseAttribute(var Start: Integer; const SourceText: string; var AName, AValue: string): Boolean;
// parses a name=&quot;value&quot; attribute from Start; returns 0 when not found or else the position behind the attribute
procedure ParseAttributes(const SourceText: string; Attributes: TStrings);
// parses all name=value attributes to the attributes TStringList
 HasStrValue(const AText, AName: string; var AValue: string): Boolean;
// checks if a name=&quot;value&quot; pair exists and returns any value
 GetStrValue(const AText, AName, ADefault: string): string;
// retrieves string value from a line like:
//  name=&quot;jan verhoeven&quot; email=&quot;jan1 dott verhoeven att wxs dott nl&quot;
// returns ADefault when not found
 GetHTMLColorValue(const AText, AName: string; ADefault: TColor): TColor;
// same for a color
 GetIntValue(const AText, AName: string; ADefault: Integer): Integer;
// same for an Integer
 GetFloatValue(const AText, AName: string; ADefault: Extended): Extended;
// same for a float
 GetBoolValue(const AText, AName: string): Boolean;
// same for Boolean but without default
 GetValue(const AText, AName: string): string;
// retrieves string value from a line like:
//  name=&quot;jan verhoeven&quot; email=&quot;jan1 dott verhoeven att wxs dott nl&quot;
procedure SetValue(var AText: string; const AName, AValue: string);
// sets a string value in a line
procedure DeleteValue(var AText: string; const AName: string);
// deletes a AName=&quot;value&quot; pair from AText

procedure GetNames(AText: string; AList: TStringList);
// get a list of names from a string with name=&quot;value&quot; pairs
 GetHTMLColor(AColor: TColor): string;
// converts a color value to the HTML hex value
 BackPosStr(Start: Integer; const FindString, SourceString: string): Integer;
// finds a string backward case sensitive
 BackPosText(Start: Integer; const FindString, SourceString: string): Integer;
// finds a string backward case insensitive
 PosRangeStr(Start: Integer; const HeadString, TailString, SourceString: string;
  var RangeBegin: Integer; var RangeEnd: Integer): Boolean;
// finds a text range, e.g. &lt;TD&gt;....&lt;/TD&gt; case sensitive
 PosRangeText(Start: Integer; const HeadString, TailString, SourceString: string;
  var RangeBegin: Integer; var RangeEnd: Integer): Boolean;
// finds a text range, e.g. &lt;TD&gt;....&lt;/td&gt; case insensitive
 BackPosRangeStr(Start: Integer; const HeadString, TailString, SourceString: string;
  var RangeBegin: Integer; var RangeEnd: Integer): Boolean;
// finds a text range backward, e.g. &lt;TD&gt;....&lt;/TD&gt; case sensitive
 BackPosRangeText(Start: Integer; const HeadString, TailString, SourceString: string;
  var RangeBegin: Integer; var RangeEnd: Integer): Boolean;
// finds a text range backward, e.g. &lt;TD&gt;....&lt;/td&gt; case insensitive
 PosTag(Start: Integer; SourceString: string; var RangeBegin: Integer;
  var RangeEnd: Integer): Boolean;
// finds a HTML or XML tag:  &lt;....&gt;
 InnerTag(Start: Integer; const HeadString, TailString, SourceString: string;
  var RangeBegin: Integer; var RangeEnd: Integer): Boolean;
// finds the innertext between opening and closing tags
 Easter(NYear: Integer): TDateTime;
// returns the easter date of a year.
 GetWeekNumber(Today: TDateTime): string;
//gets a datecode. Returns year and weeknumber in format: YYWW *)
</span><span class="pas1-space"> Writeln(</span><span class="pas1-string">'parse: '</span><span class="pas1-symbol">+inttoStr(ParseNumber(tester)))
 </span><span class="pas1-comment">//ParseNumber(const S: string): Integer;
// parse number returns the last position, starting from 1
</span><span class="pas1-space"> </span><span class="pas1-comment">//Writeln(inttostr(ParseDate(tester)));
// parse a SQL style data string from positions 1,
// starts and ends with #   
</span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;



</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> SetForm;
</span><span class="pas1-reservedword">var
</span><span class="pas1-space">  mbtn, mbtn2: TBitBtn;
  mi, mi1, mi2, mi3: TMenuItem;
  mt: TMainMenu;
  mlbl, mlbl1: TLabel; 

</span><span class="pas1-reservedword">begin
</span><span class="pas1-space">  inFrm:= TForm.Create(self);
  mLbl:= TLabel.create(inFrm);
  mLbl1:= TLabel.create(inFrm);
  mPaint:= TPaintBox.Create(inFrm);
  mPaint2:= TPaintBox.Create(inFrm);
  mPaint3:= TPaintBox.Create(inFrm);
  stat:= TStatusbar.Create(inFrm);
  Lstbox:= TListbox.create(inFrm);
  mymemo:= TMemo.create(inFrm);

  </span><span class="pas1-reservedword">with</span><span class="pas1-space"> inFrm </span><span class="pas1-reservedword">do</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-space">    caption:= </span><span class="pas1-string">'********SortMonster3************'</span><span class="pas1-symbol">;  
    height:= </span><span class="pas1-number">610</span><span class="pas1-symbol">;
    width:= </span><span class="pas1-number">1180</span><span class="pas1-symbol">;
    </span><span class="pas1-comment">//color:= clred;
</span><span class="pas1-space">    Position:= poScreenCenter;
    </span><span class="pas1-comment">//onClose:= @CloseClick;
</span><span class="pas1-space">    Show;
  </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
  </span><span class="pas1-reservedword">with</span><span class="pas1-space"> mPaint </span><span class="pas1-reservedword">do</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-space">     Parent:= inFrm;  
     SetBounds(LEFTBASE+</span><span class="pas1-number">20</span><span class="pas1-symbol">,TOPBASE+</span><span class="pas1-number">70</span><span class="pas1-symbol">,</span><span class="pas1-number">200</span><span class="pas1-symbol">,</span><span class="pas1-number">400</span><span class="pas1-symbol">)
     color:= clsilver;
     Show;
     </span><span class="pas1-comment">//onpaint:= @closeclick;
</span><span class="pas1-space">  </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">; 
  </span><span class="pas1-reservedword">with</span><span class="pas1-space"> mPaint2 </span><span class="pas1-reservedword">do</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-space">     Parent:= inFrm;  
     SetBounds(LEFTBASE+</span><span class="pas1-number">220</span><span class="pas1-symbol">,TOPBASE+</span><span class="pas1-number">70</span><span class="pas1-symbol">,</span><span class="pas1-number">200</span><span class="pas1-symbol">,</span><span class="pas1-number">400</span><span class="pas1-symbol">)
     color:= clsilver;
     Show;
     </span><span class="pas1-comment">//onpaint:= @closeclick;
</span><span class="pas1-space">  </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">; 
   </span><span class="pas1-reservedword">with</span><span class="pas1-space"> mPaint3 </span><span class="pas1-reservedword">do</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-space">     Parent:= inFrm;  
     SetBounds(LEFTBASE+</span><span class="pas1-number">420</span><span class="pas1-symbol">,TOPBASE+</span><span class="pas1-number">70</span><span class="pas1-symbol">,</span><span class="pas1-number">200</span><span class="pas1-symbol">,</span><span class="pas1-number">400</span><span class="pas1-symbol">)
     color:= clsilver;
     Show;
     </span><span class="pas1-comment">//onpaint:= @closeclick;
</span><span class="pas1-space">  </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">; 
  
  </span><span class="pas1-reservedword">with</span><span class="pas1-space"> mymemo </span><span class="pas1-reservedword">do</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-space">    Parent:= inFrm;
    SetBounds(LEFTBASE+</span><span class="pas1-number">720</span><span class="pas1-symbol">, TOPBASE+</span><span class="pas1-number">40</span><span class="pas1-symbol">, </span><span class="pas1-number">400</span><span class="pas1-symbol">, </span><span class="pas1-number">400</span><span class="pas1-symbol">)
    font.size:= </span><span class="pas1-number">14</span><span class="pas1-symbol">;
    color:= clYellow;
    wordwrap:= true;
    scrollbars:= ssvertical;
  </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
  
  mBtn:= TBitBtn.Create(inFrm)
  </span><span class="pas1-reservedword">with</span><span class="pas1-space"> mBtn </span><span class="pas1-reservedword">do</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-space">    Parent:= inFrm;
    setbounds(LEFTBASE+ </span><span class="pas1-number">490</span><span class="pas1-symbol">, TOPBASE+ </span><span class="pas1-number">460</span><span class="pas1-symbol">,</span><span class="pas1-number">150</span><span class="pas1-symbol">, </span><span class="pas1-number">40</span><span class="pas1-symbol">);
    caption:= </span><span class="pas1-string">'Random'</span><span class="pas1-symbol">;
    font.size:= </span><span class="pas1-number">12</span><span class="pas1-symbol">;
    glyph.LoadFromResourceName(getHINSTANCE,</span><span class="pas1-string">'CL_MPPAUSE'</span><span class="pas1-symbol">); 
    </span><span class="pas1-comment">//event handler
</span><span class="pas1-space">    onclick:= @GetRandom;
  </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
  mBtn2:= TBitBtn.Create(inFrm)
  </span><span class="pas1-reservedword">with</span><span class="pas1-space"> mBtn2 </span><span class="pas1-reservedword">do</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-space">    Parent:= inFrm;
    setbounds(LEFTBASE+ </span><span class="pas1-number">330</span><span class="pas1-symbol">, TOPBASE+</span><span class="pas1-number">460</span><span class="pas1-symbol">,</span><span class="pas1-number">150</span><span class="pas1-symbol">, </span><span class="pas1-number">40</span><span class="pas1-symbol">);
    caption:= </span><span class="pas1-string">'Sort'</span><span class="pas1-symbol">;
    font.size:= </span><span class="pas1-number">12</span><span class="pas1-symbol">;
    glyph.LoadFromResourceName(getHINSTANCE,</span><span class="pas1-string">'CL_MPEJECT'</span><span class="pas1-symbol">); 
    </span><span class="pas1-comment">//event handler
</span><span class="pas1-space">    onclick:= @BtnSortClick;
  </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
  mBtn3:= TBitBtn.Create(inFrm)
  </span><span class="pas1-reservedword">with</span><span class="pas1-space"> mBtn3 </span><span class="pas1-reservedword">do</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-space">    Parent:= inFrm;
    setbounds(LEFTBASE+ </span><span class="pas1-number">650</span><span class="pas1-symbol">, TOPBASE+</span><span class="pas1-number">460</span><span class="pas1-symbol">,</span><span class="pas1-number">150</span><span class="pas1-symbol">, </span><span class="pas1-number">40</span><span class="pas1-symbol">);
    caption:= </span><span class="pas1-string">'Start Sort'</span><span class="pas1-symbol">;
    font.size:= </span><span class="pas1-number">12</span><span class="pas1-symbol">;
    </span><span class="pas1-comment">//glyph.LoadFromResourceName(getHINSTANCE,'PREVIEWGLYPH'); 
</span><span class="pas1-space">    glyph.LoadFromResourceName(getHINSTANCE,</span><span class="pas1-string">'CL_MPSTEP'</span><span class="pas1-symbol">); 
     </span><span class="pas1-comment">//event handler
</span><span class="pas1-space">    onclick:= @BtnStartClick;
  </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
  </span><span class="pas1-reservedword">with</span><span class="pas1-space"> mlbl </span><span class="pas1-reservedword">do</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-space">    parent:= inFrm;
    setbounds(LEFTBASE+</span><span class="pas1-number">5</span><span class="pas1-symbol">,TOPBASE-</span><span class="pas1-number">15</span><span class="pas1-symbol">,</span><span class="pas1-number">180</span><span class="pas1-symbol">,</span><span class="pas1-number">20</span><span class="pas1-symbol">);
    font.size:= </span><span class="pas1-number">28</span><span class="pas1-symbol">;
    font.color:= clred;
    </span><span class="pas1-comment">//font.style:= [fsunderline]
</span><span class="pas1-space">    caption:= </span><span class="pas1-string">'SortThreadApp HEX in BOX'</span><span class="pas1-symbol">;
  </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;  
  </span><span class="pas1-reservedword">with</span><span class="pas1-space"> mlbl1 </span><span class="pas1-reservedword">do</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-space">    parent:= inFrm;
    setbounds(LEFTBASE+</span><span class="pas1-number">715</span><span class="pas1-symbol">,TOPBASE-</span><span class="pas1-number">1</span><span class="pas1-symbol">,</span><span class="pas1-number">180</span><span class="pas1-symbol">,</span><span class="pas1-number">20</span><span class="pas1-symbol">);
    font.size:= </span><span class="pas1-number">20</span><span class="pas1-symbol">;
    font.color:= clred;
    caption:= </span><span class="pas1-string">'Text File:'</span><span class="pas1-symbol">;
  </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;  
  mt:= TMainMenu.Create(infrm)
  </span><span class="pas1-reservedword">with</span><span class="pas1-space"> mt </span><span class="pas1-reservedword">do</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-space">   </span><span class="pas1-comment">//parent:= frmMon;
</span><span class="pas1-space">  </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;  
  mi:= TMenuItem.Create(mt)
  mi1:= TMenuItem.Create(mt)
  mi2:= TMenuItem.Create(mt)
  mi3:= TMenuItem.Create(mi)
  </span><span class="pas1-reservedword">with</span><span class="pas1-space"> mi </span><span class="pas1-reservedword">do</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-space">    </span><span class="pas1-comment">//parent:= frmMon;
</span><span class="pas1-space">    Caption:=</span><span class="pas1-string">'Play Media'</span><span class="pas1-symbol">;
    Name:=</span><span class="pas1-string">'ITEM'</span><span class="pas1-symbol">;
    mt.Items.Add(mi);   
    </span><span class="pas1-comment">//OnClick:= @GetMediaData;
</span><span class="pas1-space">  </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
  </span><span class="pas1-reservedword">with</span><span class="pas1-space"> mi1 </span><span class="pas1-reservedword">do</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-space">    </span><span class="pas1-comment">//parent:= frmMon;
</span><span class="pas1-space">    Caption:=</span><span class="pas1-string">'Show Video'</span><span class="pas1-symbol">;
    Name:=</span><span class="pas1-string">'ITEM2'</span><span class="pas1-symbol">;
    mt.Items.Add(mi1) ;
    </span><span class="pas1-comment">//OnClick:= @GetVideoData
</span><span class="pas1-space">  </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
  </span><span class="pas1-reservedword">with</span><span class="pas1-space"> mi2 </span><span class="pas1-reservedword">do</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-space">    </span><span class="pas1-comment">//parent:= frmMon;
</span><span class="pas1-space">    Caption:=</span><span class="pas1-string">'Open CD Player'</span><span class="pas1-symbol">;
    Name:=</span><span class="pas1-string">'ITEM3'</span><span class="pas1-symbol">;
    mt.Items.Add(mi2);
    </span><span class="pas1-comment">//OnClick:= @OPenCD;
</span><span class="pas1-space">  </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
  </span><span class="pas1-reservedword">with</span><span class="pas1-space"> mi3 </span><span class="pas1-reservedword">do</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-space">    Caption:=</span><span class="pas1-string">'Open maXbook'</span><span class="pas1-symbol">;
    Name:=</span><span class="pas1-string">'ITEM4'</span><span class="pas1-symbol">;
    </span><span class="pas1-comment">//mi.Items[0].add(mi3);
</span><span class="pas1-space">  </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
  </span><span class="pas1-reservedword">with</span><span class="pas1-space"> Stat </span><span class="pas1-reservedword">do</span><span class="pas1-space"> </span><span class="pas1-reservedword">begin
</span><span class="pas1-space">    parent:= inFrm;
    stat.SimplePanel:= true;
  </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">end</span><span class="pas1-symbol">; 
  </span><span class="pas1-reservedword">var
</span><span class="pas1-space">    </span><span class="pas1-comment">//ww: wchar;
</span><span class="pas1-space">     </span><span class="pas1-comment">//wa: ansichar;
</span><span class="pas1-space">     wp: pchar;
     app: ___Pointer;   
     
</span><span class="pas1-reservedword">begin
</span><span class="pas1-space">  memo2.font.size:= </span><span class="pas1-number">14</span><span class="pas1-symbol">;
  SetForm;
  mymemo.lines.text:= getRandomText;
  </span><span class="pas1-comment">//SearchAndOpenDoc(ExePath+MEDIAPATH)
</span><span class="pas1-space">  </span><span class="pas1-comment">//mylistview:= TFormListView.Create(self);
</span><span class="pas1-space">  </span><span class="pas1-comment">//exit;
</span><span class="pas1-space">  maxform1.color:= clsilver;
  </span><span class="pas1-comment">//ansitonative
</span><span class="pas1-space">   </span><span class="pas1-comment">//displaystream
</span><span class="pas1-space">  </span><span class="pas1-comment">//SQLAddWhere
</span><span class="pas1-space">  </span><span class="pas1-comment">//prettynametocolor
</span><span class="pas1-space">         </span><span class="pas1-comment">//RGBToHSV
</span><span class="pas1-space">      </span><span class="pas1-comment">// hasanychar  
</span><span class="pas1-space">          </span><span class="pas1-comment">//writestringtostream
</span><span class="pas1-space">      </span><span class="pas1-comment">//ansichar
</span><span class="pas1-space">      </span><span class="pas1-comment">//pathdelim
</span><span class="pas1-space">        </span><span class="pas1-comment">//drivedelim
</span><span class="pas1-space">        </span><span class="pas1-comment">//dectohex
</span><span class="pas1-space">        </span><span class="pas1-comment">//xorstring
</span><span class="pas1-space">          </span><span class="pas1-comment">//wordcount
</span><span class="pas1-space">            </span><span class="pas1-comment">//tformatsettings
</span><span class="pas1-space">            </span><span class="pas1-comment">//inttobin
</span><span class="pas1-space">           </span><span class="pas1-comment">// ms
</span><span class="pas1-space">             </span><span class="pas1-comment">//validfilename
</span><span class="pas1-space">             </span><span class="pas1-comment">//loaddll
</span><span class="pas1-space">             </span><span class="pas1-comment">//  validdate
</span><span class="pas1-space">             </span><span class="pas1-comment">//urlencode
</span><span class="pas1-space">              </span><span class="pas1-comment">//trimleftw
</span><span class="pas1-space">             </span><span class="pas1-comment">//copydir
</span><span class="pas1-space">             </span><span class="pas1-comment">//incsecond
</span><span class="pas1-space">               </span><span class="pas1-comment">//inttoextended
</span><span class="pas1-space">      </span><span class="pas1-comment">//invalidaterect
</span><span class="pas1-space">      </span><span class="pas1-comment">//replacestring
</span><span class="pas1-space">      </span><span class="pas1-comment">//stringtoboolean
</span><span class="pas1-space">       </span><span class="pas1-comment">//killmessage
</span><span class="pas1-space">         </span><span class="pas1-comment">//hash
</span><span class="pas1-space">         </span><span class="pas1-comment">//encrypt
</span><span class="pas1-space">         </span><span class="pas1-comment">//dirfiles
</span><span class="pas1-space">          </span><span class="pas1-comment">//savestring
</span><span class="pas1-space">            </span><span class="pas1-comment">//deletedir
</span><span class="pas1-space">            </span><span class="pas1-comment">//showtraybar
</span><span class="pas1-space">            </span><span class="pas1-comment">//xorstring
</span><span class="pas1-space">  </span><span class="pas1-comment">//getshellstring        
</span><span class="pas1-space">  </span><span class="pas1-comment">//lzfileexpand;    
</span><span class="pas1-space">   </span><span class="pas1-comment">//booltostrJ
</span><span class="pas1-space">   </span><span class="pas1-comment">//strlicomp
</span><span class="pas1-space">    </span><span class="pas1-comment">//posstr  
</span><span class="pas1-space">    </span><span class="pas1-comment">//iszero      
</span><span class="pas1-space">    writeln(inttostr(swap(</span><span class="pas1-number">10</span><span class="pas1-symbol">)))
    </span><span class="pas1-comment">//iserror
</span><span class="pas1-space">    </span><span class="pas1-comment">//failed
</span><span class="pas1-space">    </span><span class="pas1-comment">//succeeded
</span><span class="pas1-space">    </span><span class="pas1-comment">//smallpointtopoint
</span><span class="pas1-space">    </span><span class="pas1-comment">//nullrect
</span><span class="pas1-space">    </span><span class="pas1-comment">//CreateMappedBmp
</span><span class="pas1-space">    </span><span class="pas1-comment">//Truntimeerror
</span><span class="pas1-space">    </span><span class="pas1-comment">//app:= inFrm;
</span><span class="pas1-space">    </span><span class="pas1-comment">//SetMultiByteConversionCodePage
</span><span class="pas1-space">    </span><span class="pas1-comment">//writeln(inttostr(modulecacheid))
</span><span class="pas1-space">    JCLStringsTester;
    bigstring:=  getRandomText;
    Saveln(exepath+</span><span class="pas1-string">'saveyourservants.txt'</span><span class="pas1-symbol">,bigstring);
    maxForm1.tbtnUseCaseClick(self);  
</span><span class="pas1-reservedword">End</span><span class="pas1-symbol">.

</span><span class="pas1-comment">//-------------------------------------------------



</span><span class="pas1-identifier">source </span><span class="pas1-reservedword">is</span><span class="pas1-space"> tlistview
target </span><span class="pas1-reservedword">is</span><span class="pas1-space"> tform

</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> TfMerit.SourceLVStartDrag(Sender: TObject;
</span><span class="pas1-reservedword">var</span><span class="pas1-space"> DragObject: TDragObject);
</span><span class="pas1-reservedword">var</span><span class="pas1-space"> TargetLV:TListView;
</span><span class="pas1-reservedword">begin
</span><span class="pas1-comment">// TargetLV:=nejak urcit dle potreby
</span><span class="pas1-space">  TargetLV.BeginDrag(True)
</span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;

</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> TfMerit.SourceLVMouseDown(Sender: TObject;
Button: TMouseButton; Shift: TShiftState; X, Y: Integer);
</span><span class="pas1-reservedword">begin
</span><span class="pas1-identifier">MouseIsDown:=True;
</span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;

</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> TfMerit.SourceLVMouseUp(Sender: TObject; Button: TMouseButton;
Shift: TShiftState; X, Y: Integer);
</span><span class="pas1-reservedword">begin
</span><span class="pas1-identifier">MouseIsDown:=False;
</span><span class="pas1-reservedword">if</span><span class="pas1-space"> (Sender </span><span class="pas1-reservedword">as</span><span class="pas1-space"> TListView).Dragging </span><span class="pas1-reservedword">then
</span><span class="pas1-symbol">(Sender </span><span class="pas1-reservedword">as</span><span class="pas1-space"> TListView).EndDrag(False);
</span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;

</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> TfMerit.SourceLVMouseMove(Sender: TObject; Shift: TShiftState;
X, Y: Integer);
</span><span class="pas1-reservedword">begin
if</span><span class="pas1-space"> (Sender.ClassNameIs(</span><span class="pas1-string">'TListView'</span><span class="pas1-symbol">)) </span><span class="pas1-reservedword">then
begin
if</span><span class="pas1-space"> MouseIsDown </span><span class="pas1-reservedword">and</span><span class="pas1-space"> ((Sender </span><span class="pas1-reservedword">as</span><span class="pas1-space"> TListView).SelCount&gt;</span><span class="pas1-number">0</span><span class="pas1-symbol">) </span><span class="pas1-reservedword">then
</span><span class="pas1-symbol">(Sender </span><span class="pas1-reservedword">as</span><span class="pas1-space"> TListView).BeginDrag(True);
</span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;


</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> TfMerit.TargetLVDragOver(Sender, Source: TObject; X,
Y: Integer; State: TDragState; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> Accept: Boolean);
</span><span class="pas1-reservedword">var</span><span class="pas1-space"> T:TListView;
</span><span class="pas1-reservedword">begin
</span><span class="pas1-identifier">T:=Sender </span><span class="pas1-reservedword">as</span><span class="pas1-space"> TListView;
Accept:=Assigned(T.GetItemAt(X,Y));
</span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;


</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> TfMerit.TargetLVDragDrop(Sender, Source: TObject; X,
Y: Integer);
</span><span class="pas1-reservedword">var</span><span class="pas1-space"> It:TListItem;
LV1,LV2:TListView;
</span><span class="pas1-reservedword">begin
</span><span class="pas1-identifier">LV1:=Source </span><span class="pas1-reservedword">as</span><span class="pas1-space"> TListView;
LV2:=Sender </span><span class="pas1-reservedword">as</span><span class="pas1-space"> TListview;

It:=LV2.GetItemAt(X,Y);
</span><span class="pas1-reservedword">if</span><span class="pas1-space"> Assigned(It) </span><span class="pas1-reservedword">then
begin
</span><span class="pas1-comment">// zpracuj polozku ze zdrojoveho listview
</span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;


</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> jclstringstester;
</span><span class="pas1-reservedword">begin

</span><span class="pas1-comment">{template s}
</span><span class="pas1-space"> ReplaceFirst(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> SourceStr, FindStr, ReplaceStr: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
 ReplaceLast(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> SourceStr, FindStr, ReplaceStr: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
 InsertLastBlock(</span><span class="pas1-reservedword">var</span><span class="pas1-space"> SourceStr: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; BlockStr: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Boolean;
 RemoveMasterBlocks(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> SourceStr: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
 RemoveFields(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> SourceStr: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;

</span><span class="pas1-comment">{http s}
</span><span class="pas1-space"> URLEncode(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Value: AnsiString): AnsiString; </span><span class="pas1-comment">// Converts string To A URLEncoded string
</span><span class="pas1-space"> URLDecode(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Value: AnsiString): AnsiString; </span><span class="pas1-comment">// Converts string From A URLEncoded string

{set s}
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> SplitSet(AText: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; AList: TStringList);
 JoinSet(AList: TStringList): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
 FirstOfSet(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> AText: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
 LastOfSet(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> AText: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
 CountOfSet(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> AText: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Integer;
 SetRotateRight(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> AText: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
 SetRotateLeft(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> AText: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
 SetPick(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> AText: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; AIndex: Integer): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
 SetSort(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> AText: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
 SetUnion(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Set1, Set2: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
 SetIntersect(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Set1, Set2: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
 SetExclude(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Set1, Set2: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;

</span><span class="pas1-comment">{replace any &lt;,&gt; etc by &amp;lt; &amp;gt;}
</span><span class="pas1-space"> XMLSafe(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> AText: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;

</span><span class="pas1-comment">{simple hash, Result can be used in Encrypt}
</span><span class="pas1-space"> Hash(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> AText: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Integer;

</span><span class="pas1-comment">{ Base64 encode and decode a string }
</span><span class="pas1-space"> B64Encode(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: AnsiString): AnsiString;
 B64Decode(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: AnsiString): AnsiString;

</span><span class="pas1-comment">{Basic encryption from a Borland Example}
</span><span class="pas1-space"> Encrypt(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> InString: AnsiString; StartKey, MultKey, AddKey: Integer): AnsiString;
 Decrypt(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> InString: AnsiString; StartKey, MultKey, AddKey: Integer): AnsiString;

</span><span class="pas1-comment">{Using Encrypt and Decrypt in combination with B64Encode and B64Decode}
</span><span class="pas1-space"> EncryptB64(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> InString: AnsiString; StartKey, MultKey, AddKey: Integer): AnsiString;
 DecryptB64(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> InString: AnsiString; StartKey, MultKey, AddKey: Integer): AnsiString;

</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> CSVToTags(Src, Dst: TStringList);
</span><span class="pas1-comment">// converts a csv list to a tagged string list

</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> TagsToCSV(Src, Dst: TStringList);
</span><span class="pas1-comment">// converts a tagged string list to a csv list
// only fieldnames from the first record are scanned ib the other records

</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> ListSelect(Src, Dst: TStringList; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> AKey, AValue: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">);
</span><span class="pas1-comment">{selects akey=avalue from Src and returns recordset in Dst}

</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> ListFilter(Src: TStringList; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> AKey, AValue: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">);
</span><span class="pas1-comment">{filters Src for akey=avalue}

</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> ListOrderBy(Src: TStringList; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> AKey: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; Numeric: Boolean);
</span><span class="pas1-comment">{orders a tagged Src list by akey}

</span><span class="pas1-space"> PosStr(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> FindString, SourceString: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
  StartPos: Integer = </span><span class="pas1-number">1</span><span class="pas1-symbol">): Integer;
</span><span class="pas1-comment">{ PosStr searches the first occurrence of a substring FindString in a string
  given by SourceString with case sensitivity (upper and lower case characters
  are differed). This  returns the index value of the first character
  of a specified substring from which it occurs in a given string starting with
  StartPos character index. If a specified substring is not found Q_PosStr
  returns zero. The author of algorithm is Peter Morris (UK) (Faststrings unit
  from www.torry.ru). }

</span><span class="pas1-space"> PosStrLast(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> FindString, SourceString: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Integer;
</span><span class="pas1-comment">{finds the last occurance}

</span><span class="pas1-space"> LastPosChar(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> FindChar: Char; SourceString: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Integer;

 PosText(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> FindString, SourceString: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
  StartPos: Integer = </span><span class="pas1-number">1</span><span class="pas1-symbol">): Integer;
</span><span class="pas1-comment">{ PosText searches the first occurrence of a substring FindString in a string
  given by SourceString without case sensitivity (upper and lower case
  characters are not differed). This  returns the index value of the
  first character of a specified substring from which it occurs in a given
  string starting with StartPos character index. If a specified substring is
  not found Q_PosStr returns zero. The author of algorithm is Peter Morris
  (UK) (Faststrings unit from www.torry.ru). }

</span><span class="pas1-space"> PosTextLast(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> FindString, SourceString: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Integer;
</span><span class="pas1-comment">{finds the last occurance}

</span><span class="pas1-space"> NameValuesToXML(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> AText: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-preprocessor">{$IFDEF MSWINDOWS}
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> LoadResourceFile(AFile: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; MemStream: TMemoryStream);
</span><span class="pas1-preprocessor">{$ENDIF MSWINDOWS}
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> DirFiles(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> ADir, AMask: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; AFileList: TStringList);
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> RecurseDirFiles(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> ADir: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> AFileList: TStringList);
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> RecurseDirProgs(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> ADir: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> AFileList: TStringList);
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> SaveString(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> AFile, AText: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">);
 LoadString(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> AFile: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
 HexToColor(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> AText: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): TColor;
 UppercaseHTMLTags(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> AText: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
 LowercaseHTMLTags(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> AText: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> GetHTMLAnchors(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> AFile: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; AList: TStringList);
 RelativePath(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> ASrc, ADst: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
 GetToken(</span><span class="pas1-reservedword">var</span><span class="pas1-space"> Start: Integer; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> SourceText: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
 PosNonSpace(Start: Integer; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> SourceText: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Integer;
 PosEscaped(Start: Integer; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> SourceText, FindText: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; EscapeChar: Char): Integer;
 DeleteEscaped(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> SourceText: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; EscapeChar: Char): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
 BeginOfAttribute(Start: Integer; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> SourceText: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Integer;
</span><span class="pas1-comment">// parses the beginning of an attribute: space + alpha character
</span><span class="pas1-space"> ParseAttribute(</span><span class="pas1-reservedword">var</span><span class="pas1-space"> Start: Integer; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> SourceText: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> AName, AValue: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Boolean;
</span><span class="pas1-comment">// parses a name=&quot;value&quot; attribute from Start; returns 0 when not found or else the position behind the attribute
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> ParseAttributes(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> SourceText: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; Attributes: TStrings);
</span><span class="pas1-comment">// parses all name=value attributes to the attributes TStringList
</span><span class="pas1-space"> HasStrValue(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> AText, AName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> AValue: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Boolean;
</span><span class="pas1-comment">// checks if a name=&quot;value&quot; pair exists and returns any value
</span><span class="pas1-space"> GetStrValue(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> AText, AName, ADefault: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">// retrieves string value from a line like:
//  name=&quot;jan verhoeven&quot; email=&quot;jan1 dott verhoeven att wxs dott nl&quot;
// returns ADefault when not found
</span><span class="pas1-space"> GetHTMLColorValue(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> AText, AName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; ADefault: TColor): TColor;
</span><span class="pas1-comment">// same for a color
</span><span class="pas1-space"> GetIntValue(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> AText, AName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; ADefault: Integer): Integer;
</span><span class="pas1-comment">// same for an Integer
</span><span class="pas1-space"> GetFloatValue(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> AText, AName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; ADefault: Extended): Extended;
</span><span class="pas1-comment">// same for a float
</span><span class="pas1-space"> GetBoolValue(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> AText, AName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Boolean;
</span><span class="pas1-comment">// same for Boolean but without default
</span><span class="pas1-space"> GetValue(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> AText, AName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">// retrieves string value from a line like:
//  name=&quot;jan verhoeven&quot; email=&quot;jan1 dott verhoeven att wxs dott nl&quot;
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> SetValue(</span><span class="pas1-reservedword">var</span><span class="pas1-space"> AText: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> AName, AValue: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">);
</span><span class="pas1-comment">// sets a string value in a line
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> DeleteValue(</span><span class="pas1-reservedword">var</span><span class="pas1-space"> AText: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> AName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">);
</span><span class="pas1-comment">// deletes a AName=&quot;value&quot; pair from AText

</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> GetNames(AText: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; AList: TStringList);
</span><span class="pas1-comment">// get a list of names from a string with name=&quot;value&quot; pairs
</span><span class="pas1-space"> GetHTMLColor(AColor: TColor): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">// converts a color value to the HTML hex value
</span><span class="pas1-space"> BackPosStr(Start: Integer; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> FindString, SourceString: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Integer;
</span><span class="pas1-comment">// finds a string backward case sensitive
</span><span class="pas1-space"> BackPosText(Start: Integer; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> FindString, SourceString: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Integer;
</span><span class="pas1-comment">// finds a string backward case insensitive
</span><span class="pas1-space"> PosRangeStr(Start: Integer; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> HeadString, TailString, SourceString: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
  </span><span class="pas1-reservedword">var</span><span class="pas1-space"> RangeBegin: Integer; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> RangeEnd: Integer): Boolean;
</span><span class="pas1-comment">// finds a text range, e.g. &lt;TD&gt;....&lt;/TD&gt; case sensitive
</span><span class="pas1-space"> PosRangeText(Start: Integer; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> HeadString, TailString, SourceString: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
  </span><span class="pas1-reservedword">var</span><span class="pas1-space"> RangeBegin: Integer; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> RangeEnd: Integer): Boolean;
</span><span class="pas1-comment">// finds a text range, e.g. &lt;TD&gt;....&lt;/td&gt; case insensitive
</span><span class="pas1-space"> BackPosRangeStr(Start: Integer; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> HeadString, TailString, SourceString: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
  </span><span class="pas1-reservedword">var</span><span class="pas1-space"> RangeBegin: Integer; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> RangeEnd: Integer): Boolean;
</span><span class="pas1-comment">// finds a text range backward, e.g. &lt;TD&gt;....&lt;/TD&gt; case sensitive
</span><span class="pas1-space"> BackPosRangeText(Start: Integer; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> HeadString, TailString, SourceString: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
  </span><span class="pas1-reservedword">var</span><span class="pas1-space"> RangeBegin: Integer; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> RangeEnd: Integer): Boolean;
</span><span class="pas1-comment">// finds a text range backward, e.g. &lt;TD&gt;....&lt;/td&gt; case insensitive
</span><span class="pas1-space"> PosTag(Start: Integer; SourceString: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> RangeBegin: Integer;
  </span><span class="pas1-reservedword">var</span><span class="pas1-space"> RangeEnd: Integer): Boolean;
</span><span class="pas1-comment">// finds a HTML or XML tag:  &lt;....&gt;
</span><span class="pas1-space"> InnerTag(Start: Integer; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> HeadString, TailString, SourceString: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
  </span><span class="pas1-reservedword">var</span><span class="pas1-space"> RangeBegin: Integer; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> RangeEnd: Integer): Boolean;
</span><span class="pas1-comment">// finds the innertext between opening and closing tags
</span><span class="pas1-space"> Easter(NYear: Integer): TDateTime;
</span><span class="pas1-comment">// returns the easter date of a year.
</span><span class="pas1-space"> GetWeekNumber(Today: TDateTime): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">//gets a datecode. Returns year and weeknumber in format: YYWW

</span><span class="pas1-space"> ParseNumber(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Integer;
</span><span class="pas1-comment">// parse number returns the last position, starting from 1
</span><span class="pas1-space"> ParseDate(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Integer;
</span><span class="pas1-comment">// parse a SQL style data string from positions 1,
// starts and ends with #
</span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;


</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> TControlParentR(Self: TControl; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> T:TWinControl); </span><span class="pas1-reservedword">begin</span><span class="pas1-space"> T:= Self.Parent; </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> TControlParentW(Self: TControl; T: TWinControl); </span><span class="pas1-reservedword">begin</span><span class="pas1-space"> Self.Parent:= T; </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
    RegisterPropertyHelper(@TControlParentR, @TControlParentW, </span><span class="pas1-string">'PARENT'</span><span class="pas1-symbol">);
    RegisterProperty(</span><span class="pas1-string">'Parent'</span><span class="pas1-symbol">, </span><span class="pas1-string">'TWinControl'</span><span class="pas1-symbol">, iptRW);

</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> TTXPTool.LVPFFDblClick(Sender: TObject);
</span><span class="pas1-reservedword">var
</span><span class="pas1-identifier">tmpList : TListItem;
fn ; </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
ft : integer;
fs : integer;
</span><span class="pas1-reservedword">begin
</span><span class="pas1-identifier">tmpList := LVPFF.Selected;
</span><span class="pas1-reservedword">if</span><span class="pas1-space"> tmplist&lt;&gt;</span><span class="pas1-reservedword">nil</span><span class="pas1-space"> </span><span class="pas1-reservedword">then
begin
</span><span class="pas1-space">  fn := tmpList.Caption
  ft := tmpList.SubItems.Strings[</span><span class="pas1-number">1</span><span class="pas1-symbol">];
  fs := tmpList.SubItems.Strings[</span><span class="pas1-number">3</span><span class="pas1-symbol">];
  </span><span class="pas1-reservedword">if</span><span class="pas1-space"> pos(</span><span class="pas1-string">'Wave'</span><span class="pas1-symbol">, ft)&gt;</span><span class="pas1-number">0</span><span class="pas1-space"> </span><span class="pas1-reservedword">then
</span><span class="pas1-space">    PlayThisOne1Click(</span><span class="pas1-reservedword">nil</span><span class="pas1-symbol">);
  </span><span class="pas1-reservedword">if</span><span class="pas1-space"> pos(</span><span class="pas1-string">'Jpg'</span><span class="pas1-symbol">, ft)&gt;</span><span class="pas1-number">0</span><span class="pas1-space"> </span><span class="pas1-reservedword">then
</span><span class="pas1-space">    ShowJpg1Click(</span><span class="pas1-reservedword">nil</span><span class="pas1-symbol">);
  </span><span class="pas1-reservedword">if</span><span class="pas1-space"> pos(</span><span class="pas1-string">'Targa'</span><span class="pas1-symbol">, ft)&gt;</span><span class="pas1-number">0</span><span class="pas1-space"> </span><span class="pas1-reservedword">then
</span><span class="pas1-space">    ShowTga1Click(</span><span class="pas1-reservedword">nil</span><span class="pas1-symbol">);
  </span><span class="pas1-reservedword">if</span><span class="pas1-space"> pos(</span><span class="pas1-string">'Pcx'</span><span class="pas1-symbol">, ft)&gt;</span><span class="pas1-number">0</span><span class="pas1-space"> </span><span class="pas1-reservedword">then
</span><span class="pas1-space">    ShowPcx1Click(</span><span class="pas1-reservedword">nil</span><span class="pas1-symbol">);
  </span><span class="pas1-reservedword">if</span><span class="pas1-space"> pos(</span><span class="pas1-string">'Mission Sound Collection'</span><span class="pas1-symbol">, ft)&gt;</span><span class="pas1-number">0</span><span class="pas1-space"> </span><span class="pas1-reservedword">then
</span><span class="pas1-space">    ShowPwf1Click(</span><span class="pas1-reservedword">nil</span><span class="pas1-symbol">);
</span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;


</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> jclutilsnewtest;
</span><span class="pas1-reservedword">begin
function</span><span class="pas1-space"> VarIsInt(Value: Variant): Boolean;
 </span><span class="pas1-comment">// VarIsInt returns VarIsOrdinal-[varBoolean]

{ PosIdx returns the index of the first appearance of SubStr in Str. The search
  starts at index &quot;Index&quot;. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> PosIdx(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> SubStr, S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; Index: Integer = </span><span class="pas1-number">0</span><span class="pas1-symbol">): Integer;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> PosIdxW(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> SubStr, S: WideString; Index: Integer = </span><span class="pas1-number">0</span><span class="pas1-symbol">): Integer;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> PosLastCharIdx(Ch: Char; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; Index: Integer = </span><span class="pas1-number">0</span><span class="pas1-symbol">): Integer;

</span><span class="pas1-comment">{ GetWordOnPos returns Word from string, S, on the cursor position, P}
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> GetWordOnPos(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> P: Integer): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> GetWordOnPosW(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: WideString; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> P: Integer): WideString;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> GetWordOnPos2(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; P: Integer; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> iBeg, iEnd: Integer): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> GetWordOnPos2W(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: WideString; P: Integer; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> iBeg, iEnd: Integer): WideString;
</span><span class="pas1-comment">{ GetWordOnPosEx working like GetWordOnPos function, but
  also returns Word position in iBeg, iEnd variables }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> GetWordOnPosEx(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> P: Integer; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> iBeg, iEnd: Integer): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> GetWordOnPosExW(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: WideString; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> P: Integer; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> iBeg, iEnd: Integer): WideString;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> GetNextWordPosEx(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Text: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; StartIndex: Integer;
  </span><span class="pas1-reservedword">var</span><span class="pas1-space"> iBeg, iEnd: Integer): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> GetNextWordPosExW(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Text: WideString; StartIndex: Integer;
  </span><span class="pas1-reservedword">var</span><span class="pas1-space"> iBeg, iEnd: Integer): WideString;
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> GetEndPosCaret(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Text: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; CaretX, CaretY: Integer;
  </span><span class="pas1-reservedword">var</span><span class="pas1-space"> X, Y: Integer);
</span><span class="pas1-comment">{ GetEndPosCaret returns the caret position of the last char. For the position
  after the last char of Text you must add 1 to the returned X value. }
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> GetEndPosCaretW(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Text: WideString; CaretX, CaretY: Integer;
  </span><span class="pas1-reservedword">var</span><span class="pas1-space"> X, Y: Integer);
</span><span class="pas1-comment">{ GetEndPosCaret returns the caret position of the last char. For the position
  after the last char of Text you must add 1 to the returned X value. }

{ SubStrBySeparator returns substring from string, S, separated with Separator string}
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> SubStrBySeparator(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Index: Integer; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Separator: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; StartIndex: Integer = </span><span class="pas1-number">1</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> SubStrBySeparatorW(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: WideString; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Index: Integer; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Separator: WideString; StartIndex: Integer = </span><span class="pas1-number">1</span><span class="pas1-symbol">): WideString;
</span><span class="pas1-comment">{ SubStrEnd same to previous function but Index numerated from the end of string }
//function SubStrEnd(const S: string; const Index: Integer; const Separator: string): string;
{ SubWord returns next Word from string, P, and offsets Pointer to the end of Word, P2 }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> SubWord(P: PChar; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> P2: PChar): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">//  function CurrencyByWord(Value: Currency): string;
{ GetLineByPos returns the Line number, there
  the symbol Pos is pointed. Lines separated with #13 symbol }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> GetLineByPos(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Pos: Integer): Integer;
</span><span class="pas1-comment">{ GetXYByPos is same as GetLineByPos, but returns X position in line as well}
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> GetXYByPos(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Pos: Integer; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> X, Y: Integer);
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> GetXYByPosW(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: WideString; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Pos: Integer; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> X, Y: Integer);
</span><span class="pas1-comment">{ ReplaceString searches for all substrings, OldPattern,
  in a string, S, and replaces them with NewPattern }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ReplaceString(S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> OldPattern, NewPattern: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; StartIndex: Integer = </span><span class="pas1-number">1</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ReplaceStringW(S: WideString; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> OldPattern, NewPattern: WideString; StartIndex: Integer = </span><span class="pas1-number">1</span><span class="pas1-symbol">): WideString;
</span><span class="pas1-comment">{ ConcatSep concatenate S1 and S2 strings with Separator.
  if S = '' then separator not included }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ConcatSep(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S1, S2, Separator: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$IFDEF SUPPORTS_INLINE}</span><span class="pas1-space"> </span><span class="pas1-reservedword">inline</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$ENDIF SUPPORTS_INLINE}
</span><span class="pas1-comment">{ ConcatLeftSep is same to previous function, but
  strings concatenate right to left }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ConcatLeftSep(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S1, S2, Separator: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$IFDEF SUPPORTS_INLINE}</span><span class="pas1-space"> </span><span class="pas1-reservedword">inline</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$ENDIF SUPPORTS_INLINE}

</span><span class="pas1-comment">{ Next 4 function for russian chars transliterating.
  This functions are needed because Oem2Ansi and Ansi2Oem functions
  sometimes suck }
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> Dos2Win(</span><span class="pas1-reservedword">var</span><span class="pas1-space"> S: AnsiString);
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> Win2Dos(</span><span class="pas1-reservedword">var</span><span class="pas1-space"> S: AnsiString);
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> Dos2WinRes(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: AnsiString): AnsiString; </span><span class="pas1-preprocessor">{$IFDEF SUPPORTS_INLINE}</span><span class="pas1-space"> </span><span class="pas1-reservedword">inline</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$ENDIF SUPPORTS_INLINE}
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> Win2DosRes(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: AnsiString): AnsiString; </span><span class="pas1-preprocessor">{$IFDEF SUPPORTS_INLINE}</span><span class="pas1-space"> </span><span class="pas1-reservedword">inline</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$ENDIF SUPPORTS_INLINE}
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> Win2Koi(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: AnsiString): AnsiString;

</span><span class="pas1-comment">{ FillString fills the string Buffer with Count Chars }
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> FillString(</span><span class="pas1-reservedword">var</span><span class="pas1-space"> Buffer: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; Count: Integer; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Value: Char); </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> FillString(</span><span class="pas1-reservedword">var</span><span class="pas1-space"> Buffer: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; StartIndex, Count: Integer; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Value: Char); </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ MoveString copies Count Chars from Source to Dest }
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> MoveString(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Source: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> Dest: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; Count: Integer); </span><span class="pas1-preprocessor">{$IFDEF SUPPORTS_INLINE}</span><span class="pas1-space"> </span><span class="pas1-reservedword">inline</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$ENDIF SUPPORTS_INLINE}</span><span class="pas1-space"> </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> MoveString(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Source: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; SrcStartIdx: Integer; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> Dest: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
  DstStartIdx: Integer; Count: Integer); </span><span class="pas1-preprocessor">{$IFDEF SUPPORTS_INLINE}</span><span class="pas1-space"> </span><span class="pas1-reservedword">inline</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$ENDIF SUPPORTS_INLINE}</span><span class="pas1-space"> </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ FillWideChar fills Buffer with Count WideChars (2 Bytes) }
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> FillWideChar(</span><span class="pas1-reservedword">var</span><span class="pas1-space"> Buffer; Count: Integer; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Value: WideChar);
</span><span class="pas1-comment">{ MoveWideChar copies Count WideChars from Source to Dest }
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> MoveWideChar(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Source; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> Dest; Count: Integer); </span><span class="pas1-preprocessor">{$IFDEF SUPPORTS_INLINE}</span><span class="pas1-space"> </span><span class="pas1-reservedword">inline</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$ENDIF SUPPORTS_INLINE}
</span><span class="pas1-comment">{ FillNativeChar fills Buffer with Count NativeChars }
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> FillNativeChar(</span><span class="pas1-reservedword">var</span><span class="pas1-space"> Buffer; Count: Integer; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Value: Char); </span><span class="pas1-comment">// D2009 internal error {$IFDEF SUPPORTS_INLINE} inline; {$ENDIF SUPPORTS_INLINE}
{ MoveWideChar copies Count WideChars from Source to Dest }
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> MoveNativeChar(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Source; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> Dest; Count: Integer); </span><span class="pas1-comment">// D2009 internal error {$IFDEF SUPPORTS_INLINE} inline; {$ENDIF SUPPORTS_INLINE}
{ IsSubString() compares the sub string to the string. Indices are 1th based. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> IsSubString(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; StartIndex: Integer; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> SubStr: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Boolean;

</span><span class="pas1-comment">{ Spaces returns string consists on N space chars }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> Spaces(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> N: Integer): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ AddSpaces adds spaces to string S, if its Length is smaller than N }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> AddSpaces(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> N: Integer): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> SpacesW(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> N: Integer): WideString;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> AddSpacesW(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: WideString; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> N: Integer): WideString;
</span><span class="pas1-comment">{ function LastDateRUS for russian users only }
{ returns date relative to current date: '&auml;&acirc;&agrave; &auml;&iacute;&yuml; &iacute;&agrave;&ccedil;&agrave;&auml;' }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> LastDateRUS(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Dat: TDateTime): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ CurrencyToStr format Currency, Cur, using ffCurrency float format}
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> CurrencyToStr(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Cur: Currency): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ HasChar returns True, if Char, Ch, contains in string, S }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> HasChar(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Ch: Char; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Boolean;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> HasCharW(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Ch: WideChar; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: WideString): Boolean; </span><span class="pas1-preprocessor">{$IFDEF SUPPORTS_INLINE}</span><span class="pas1-space"> </span><span class="pas1-reservedword">inline</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$ENDIF SUPPORTS_INLINE}
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> HasAnyChar(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Chars: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Boolean;
</span><span class="pas1-preprocessor">{$IFNDEF COMPILER12_UP}
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> CharInSet(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Ch: AnsiChar; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> SetOfChar: TSysCharSet): Boolean; </span><span class="pas1-preprocessor">{$IFDEF SUPPORTS_INLINE}</span><span class="pas1-space"> </span><span class="pas1-reservedword">inline</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$ENDIF SUPPORTS_INLINE}
{$ENDIF ~COMPILER12_UP}
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> CharInSetW(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Ch: WideChar; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> SetOfChar: TSysCharSet): Boolean; </span><span class="pas1-preprocessor">{$IFDEF SUPPORTS_INLINE}</span><span class="pas1-space"> </span><span class="pas1-reservedword">inline</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$ENDIF SUPPORTS_INLINE}
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> CountOfChar(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Ch: Char; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Integer;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> DefStr(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">Default</span><span class="pas1-symbol">: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$IFDEF SUPPORTS_INLINE}</span><span class="pas1-space"> </span><span class="pas1-reservedword">inline</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$ENDIF SUPPORTS_INLINE}

</span><span class="pas1-comment">{ StrLICompW2 is a faster replacement for JclUnicode.StrLICompW }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> StrLICompW2(S1, S2: PWideChar; MaxLen: Integer): Integer;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> StrPosW(S, SubStr: PWideChar): PWideChar;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> StrLenW(S: PWideChar): Integer;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> TrimW(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: WideString): WideString; </span><span class="pas1-preprocessor">{$IFDEF SUPPORTS_INLINE}</span><span class="pas1-space"> </span><span class="pas1-reservedword">inline</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$ENDIF SUPPORTS_INLINE}
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> TrimLeftW(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: WideString): WideString; </span><span class="pas1-preprocessor">{$IFDEF SUPPORTS_INLINE}</span><span class="pas1-space"> </span><span class="pas1-reservedword">inline</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$ENDIF SUPPORTS_INLINE}
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> TrimRightW(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: WideString): WideString; </span><span class="pas1-preprocessor">{$IFDEF SUPPORTS_INLINE}</span><span class="pas1-space"> </span><span class="pas1-reservedword">inline</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$ENDIF SUPPORTS_INLINE}
</span><span class="pas1-comment">{**** files routines}
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> SetDelimitedText(List: TStrings; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Text: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; Delimiter: Char);

</span><span class="pas1-comment">{ GenTempFileName returns temporary file name on
  drive, there FileName is placed }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> GenTempFileName(FileName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ GenTempFileNameExt same to previous function, but
  returning filename has given extension, FileExt }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> GenTempFileNameExt(FileName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> FileExt: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ ClearDir clears folder Dir }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ClearDir(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Dir: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Boolean;
</span><span class="pas1-comment">{ DeleteDir clears and than delete folder Dir }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> DeleteDir(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Dir: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Boolean;
</span><span class="pas1-comment">{ FileEquMask returns True if file, FileName,
  is compatible with given dos file mask, Mask }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> FileEquMask(FileName, Mask: TFileName;
  CaseSensitive: Boolean = DefaultCaseSensitivity): Boolean;
</span><span class="pas1-comment">{ FileEquMasks returns True if file, FileName,
  is compatible with given Masks.
  Masks must be separated with SepPath (MSW: ';' / UNIX: ':') }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> FileEquMasks(FileName, Masks: TFileName;
  CaseSensitive: Boolean = DefaultCaseSensitivity): Boolean;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> DeleteFiles(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Folder: TFileName; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Masks: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Boolean;

</span><span class="pas1-preprocessor">{$IFDEF MSWINDOWS}
</span><span class="pas1-comment">{ LZFileExpand expand file, FileSource,
  into FileDest. Given file must be compressed, using MS Compress program }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> LZFileExpand(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> FileSource, FileDest: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Boolean;
</span><span class="pas1-preprocessor">{$ENDIF MSWINDOWS}

</span><span class="pas1-comment">{ FileGetInfo fills SearchRec record for specified file attributes}
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> FileGetInfo(FileName: TFileName; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> SearchRec: TSearchRec): Boolean;
</span><span class="pas1-comment">{ HasSubFolder returns True, if folder APath contains other folders }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> HasSubFolder(APath: TFileName): Boolean;
</span><span class="pas1-comment">{ IsEmptyFolder returns True, if there are no files or
  folders in given folder, APath}
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> IsEmptyFolder(APath: TFileName): Boolean;
</span><span class="pas1-comment">{ AddSlash returns string with added slash Char to Dir parameter, if needed }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> AddSlash(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Dir: TFileName): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$IFDEF SUPPORTS_INLINE}</span><span class="pas1-space"> </span><span class="pas1-reservedword">inline</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$ENDIF SUPPORTS_INLINE}
</span><span class="pas1-comment">{ AddPath returns FileName with Path, if FileName not contain any path }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> AddPath(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> FileName, Path: TFileName): TFileName;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> AddPaths(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> PathList, Path: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ParentPath(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Path: TFileName): TFileName;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> FindInPath(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> FileName, PathList: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): TFileName;
</span><span class="pas1-comment">{ DeleteReadOnlyFile clears R/O file attribute and delete file }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> DeleteReadOnlyFile(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> FileName: TFileName): Boolean;
</span><span class="pas1-comment">{ HasParam returns True, if program running with specified parameter, Param }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> HasParam(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Param: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Boolean;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> HasSwitch(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Param: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Boolean;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> Switch(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Param: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ ExePath returns ExtractFilePath(ParamStr(0)) }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ExePath: TFileName; </span><span class="pas1-preprocessor">{$IFDEF SUPPORTS_INLINE}</span><span class="pas1-space"> </span><span class="pas1-reservedword">inline</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$ENDIF SUPPORTS_INLINE}
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> CopyDir(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> SourceDir, DestDir: TFileName): Boolean;
</span><span class="pas1-comment">//function FileTimeToDateTime(const FT: TFileTime): TDateTime;
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> FileTimeToDosDateTimeDWord(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> FT: TFileTime; </span><span class="pas1-reservedword">out</span><span class="pas1-space"> Dft: DWORD);
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> MakeValidFileName(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> FileName: TFileName; ReplaceBadChar: Char): TFileName;

</span><span class="pas1-comment">{**** Graphic routines }


{ IsTTFontSelected returns True, if True Type font
  is selected in specified device context }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> IsTTFontSelected(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> DC: HDC): Boolean;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> KeyPressed(VK: Integer): Boolean;




</span><span class="pas1-comment">{ TrueInflateRect inflates rect in other method, than InflateRect API function }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> TrueInflateRect(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> R: TRect; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> I: Integer): TRect;
</span><span class="pas1-comment">{**** Color routines }
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> RGBToHSV(R, G, B: Integer; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> H, S, V: Integer);
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> RGBToBGR(Value: Cardinal): Cardinal;
</span><span class="pas1-comment">//function ColorToPrettyName(Value: TColor): string;
//function PrettyNameToColor(const Value: string): TColor;

{**** other routines }
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> SwapInt(</span><span class="pas1-reservedword">var</span><span class="pas1-space"> Int1, Int2: Integer); </span><span class="pas1-preprocessor">{$IFDEF SUPPORTS_INLINE}</span><span class="pas1-space"> </span><span class="pas1-reservedword">inline</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$ENDIF SUPPORTS_INLINE}
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> IntPower(Base, Exponent: Integer): Integer;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ChangeTopException(E: TObject): TObject; </span><span class="pas1-comment">// Linux version writes error message to ErrOutput
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> StrToBool(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Boolean;

</span><span class="pas1-reservedword">function</span><span class="pas1-space"> Var2Type(V: Variant; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> DestVarType: Integer): Variant;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> VarToInt(V: Variant): Integer;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> VarToFloat(V: Variant): Double;

</span><span class="pas1-comment">{ following functions are not documented
  because they do not work properly sometimes, so do not use them }
// (rom) ReplaceStrings1, GetSubStr removed

</span><span class="pas1-reservedword">function</span><span class="pas1-space"> GetLongFileName(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> FileName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> FileNewExt(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> FileName, NewExt: TFileName): TFileName;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> GetParameter: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> GetComputerID: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> GetComputerName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;

</span><span class="pas1-comment">{**** string routines }

{ ReplaceAllStrings searches for all substrings, Words,
  in a string, S, and replaces them with Frases with the same Index. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ReplaceAllStrings(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; Words, Frases: TStrings): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ ReplaceStrings searches the Word in a string, S, on PosBeg position,
  in the list, Words, and if founds, replaces this Word
  with string from another list, Frases, with the same Index,
  and then update NewSelStart variable }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ReplaceStrings(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; PosBeg, Len: Integer; Words, Frases: TStrings; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> NewSelStart: Integer): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ CountOfLines calculates the lines count in a string, S,
  each line must be separated from another with CrLf sequence }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> CountOfLines(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Integer;
</span><span class="pas1-comment">{ DeleteLines deletes all lines from strings which in the words,  words.
  The word of will be deleted from strings. }
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> DeleteOfLines(Ss: TStrings; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Words: </span><span class="pas1-reservedword">array</span><span class="pas1-space"> </span><span class="pas1-reservedword">of</span><span class="pas1-space"> </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">);
</span><span class="pas1-comment">{ DeleteEmptyLines deletes all empty lines from strings, Ss.
  Lines contained only spaces also deletes. }
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> DeleteEmptyLines(Ss: TStrings);
</span><span class="pas1-comment">{ SQLAddWhere addes or modifies existing where-statement, where,
  to the strings, SQL.
  Note: If strings SQL allready contains where-statement,
  it must be started on the begining of any line }
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> SQLAddWhere(SQL: TStrings; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Where: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">);

</span><span class="pas1-comment">{**** files routines - }

</span><span class="pas1-preprocessor">{$IFDEF MSWINDOWS}
</span><span class="pas1-comment">{ ResSaveToFile save resource named as Name with Typ type into file FileName.
  Resource can be compressed using MS Compress program}
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ResSaveToFile(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Typ, Name: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Compressed: Boolean; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> FileName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Boolean;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ResSaveToFileEx(Instance: HINST; Typ, Name: PChar;
  </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Compressed: Boolean; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> FileName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Boolean;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ResSaveToString(Instance: HINST; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Typ, Name: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
  </span><span class="pas1-reservedword">var</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Boolean;
</span><span class="pas1-preprocessor">{$ENDIF MSWINDOWS}
</span><span class="pas1-comment">{ IniReadSection read section, Section, from ini-file,
  IniFileName, into strings, Ss.
  This function reads ALL strings from specified section.
  Note: TIninFile.ReadSection function reads only strings with '=' symbol.}
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> IniReadSection(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> IniFileName: TFileName; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Section: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; Ss: TStrings): Boolean;
</span><span class="pas1-comment">{ LoadTextFile load text file, FileName, into string }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> LoadTextFile(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> FileName: TFileName): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> SaveTextFile(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> FileName: TFileName; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Source: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">);
</span><span class="pas1-comment">{ ReadFolder reads files list from disk folder, Folder,
  that are equal to mask, Mask, into strings, FileList}
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ReadFolder(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Folder, Mask: TFileName; FileList: TStrings): Integer;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ReadFolders(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Folder: TFileName; FolderList: TStrings): Integer;

</span><span class="pas1-comment">{ RATextOut same with TCanvas.TextOut procedure, but
  can clipping drawing with rectangle, RClip. }
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> RATextOut(Canvas: TCanvas; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> R, RClip: TRect; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">);
</span><span class="pas1-comment">{ RATextOutEx same with RATextOut function, but
  can calculate needed height for correct output }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> RATextOutEx(Canvas: TCanvas; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> R, RClip: TRect; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> CalcHeight: Boolean): Integer;
</span><span class="pas1-comment">{ RATextCalcHeight calculate needed height for
  correct output, using RATextOut or RATextOutEx functions }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> RATextCalcHeight(Canvas: TCanvas; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> R: TRect; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Integer;
</span><span class="pas1-comment">{ Cinema draws some visual effect }
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> Cinema(Canvas: TCanvas; rS </span><span class="pas1-comment">{Source}</span><span class="pas1-symbol">, rD </span><span class="pas1-comment">{Dest}</span><span class="pas1-symbol">: TRect);
</span><span class="pas1-comment">{ Roughed fills rect with special 3D pattern }
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> Roughed(ACanvas: TCanvas; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> ARect: TRect; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> AVert: Boolean);
</span><span class="pas1-comment">{ BitmapFromBitmap creates new small bitmap from part
  of source bitmap, SrcBitmap, with specified width and height,
  AWidth, AHeight and placed on a specified Index, Index in the
  source bitmap }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> BitmapFromBitmap(SrcBitmap: TBitmap; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> AWidth, AHeight, Index: Integer): TBitmap;
</span><span class="pas1-comment">{ TextWidth calculate text with for writing using standard desktop font }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> TextWidth(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> AStr: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Integer;
</span><span class="pas1-comment">{ TextHeight calculate text height for writing using standard desktop font }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> TextHeight(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> AStr: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Integer;

</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> SetChildPropOrd(Owner: TComponent; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> PropName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; Value: Longint);
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> Error(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Msg: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">);
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> ItemHtDrawEx(Canvas: TCanvas; Rect: TRect;
  </span><span class="pas1-reservedword">const</span><span class="pas1-space"> State: TOwnerDrawState; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Text: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
  </span><span class="pas1-reservedword">const</span><span class="pas1-space"> HideSelColor: Boolean; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> PlainItem: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
  </span><span class="pas1-reservedword">var</span><span class="pas1-space"> Width: Integer; CalcWidth: Boolean);
</span><span class="pas1-comment">{ example for Text parameter :
  'Item 1 &lt;b&gt;bold&lt;/b&gt; &lt;i&gt;italic ITALIC &lt;c:Red&gt;red &lt;c:Green&gt;green &lt;c:blue&gt;blue &lt;/i&gt;' }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ItemHtDraw(Canvas: TCanvas; Rect: TRect;
  </span><span class="pas1-reservedword">const</span><span class="pas1-space"> State: TOwnerDrawState; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Text: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
  </span><span class="pas1-reservedword">const</span><span class="pas1-space"> HideSelColor: Boolean): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ItemHtWidth(Canvas: TCanvas; Rect: TRect;
  </span><span class="pas1-reservedword">const</span><span class="pas1-space"> State: TOwnerDrawState; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Text: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
  </span><span class="pas1-reservedword">const</span><span class="pas1-space"> HideSelColor: Boolean): Integer;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ItemHtPlain(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Text: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ ClearList - clears list of TObject }
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> ClearList(List: TList);

</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> MemStreamToClipBoard(MemStream: TMemoryStream; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Format: Word);
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> ClipBoardToMemStream(MemStream: TMemoryStream; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Format: Word);

</span><span class="pas1-comment">{ RTTI support }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> GetPropType(Obj: TObject; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> PropName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): TTypeKind;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> GetPropStr(Obj: TObject; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> PropName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> GetPropOrd(Obj: TObject; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> PropName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Integer;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> GetPropMethod(Obj: TObject; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> PropName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): TMethod;

</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> PrepareIniSection(Ss: TStrings);
</span><span class="pas1-comment">{ following functions are not documented because
  they are don't work properly, so don't use them }

// (rom) from JvBandWindows to make it obsolete
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> PointL(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> X, Y: Longint): TPointL; </span><span class="pas1-preprocessor">{$IFDEF SUPPORTS_INLINE}</span><span class="pas1-space"> </span><span class="pas1-reservedword">inline</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$ENDIF SUPPORTS_INLINE}
</span><span class="pas1-comment">// (rom) from JvBandUtils to make it obsolete
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> iif(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Test: Boolean; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> ATrue, AFalse: Variant): Variant; </span><span class="pas1-preprocessor">{$IFDEF SUPPORTS_INLINE}</span><span class="pas1-space"> </span><span class="pas1-reservedword">inline</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$ENDIF SUPPORTS_INLINE}


</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> CopyIconToClipboard(Icon: TIcon; BackColor: TColor);
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> CreateIconFromClipboard: TIcon;
</span><span class="pas1-comment">{ begin JvIconClipboardUtils }
{ Icon clipboard routines }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> CF_ICON: Word;

</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> AssignClipboardIcon(Icon: TIcon);

</span><span class="pas1-comment">{ Real-size icons support routines (32-bit only) }
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> GetIconSize(Icon: HICON; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> W, H: Integer);
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> CreateRealSizeIcon(Icon: TIcon): HICON;
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> DrawRealSizeIcon(Canvas: TCanvas; Icon: TIcon; X, Y: Integer);
</span><span class="pas1-comment">{end JvIconClipboardUtils }

</span><span class="pas1-reservedword">function</span><span class="pas1-space"> CreateScreenCompatibleDC: HDC;

</span><span class="pas1-reservedword">function</span><span class="pas1-space"> InvalidateRect(hWnd: HWND; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> lpRect: TRect; bErase: BOOL): BOOL; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$IFDEF SUPPORTS_INLINE}</span><span class="pas1-space"> </span><span class="pas1-reservedword">inline</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$ENDIF}
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> InvalidateRect(hWnd: HWND; lpRect: PRect; bErase: BOOL): BOOL; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$IFDEF SUPPORTS_INLINE}</span><span class="pas1-space"> </span><span class="pas1-reservedword">inline</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$ENDIF}

</span><span class="pas1-comment">{ begin JvRLE }

// (rom) changed API for inclusion in JCL

</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> RleCompressTo(InStream, OutStream: TStream);
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> RleDecompressTo(InStream, OutStream: TStream);
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> RleCompress(Stream: TStream);
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> RleDecompress(Stream: TStream);
</span><span class="pas1-comment">{ end JvRLE }

{ begin JvDateUtil }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> CurrentYear: Word; </span><span class="pas1-preprocessor">{$IFDEF SUPPORTS_INLINE}</span><span class="pas1-space"> </span><span class="pas1-reservedword">inline</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$ENDIF SUPPORTS_INLINE}
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> IsLeapYear(AYear: Integer): Boolean;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> DaysInAMonth(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> AYear, AMonth: Word): Word;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> DaysPerMonth(AYear, AMonth: Integer): Integer;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> FirstDayOfPrevMonth: TDateTime;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> LastDayOfPrevMonth: TDateTime;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> FirstDayOfNextMonth: TDateTime;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ExtractDay(ADate: TDateTime): Word;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ExtractMonth(ADate: TDateTime): Word;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ExtractYear(ADate: TDateTime): Word;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> IncDate(ADate: TDateTime; Days, Months, Years: Integer): TDateTime;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> IncDay(ADate: TDateTime; Delta: Integer): TDateTime; </span><span class="pas1-preprocessor">{$IFDEF SUPPORTS_INLINE}</span><span class="pas1-space"> </span><span class="pas1-reservedword">inline</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$ENDIF SUPPORTS_INLINE}
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> IncMonth(ADate: TDateTime; Delta: Integer): TDateTime;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> IncYear(ADate: TDateTime; Delta: Integer): TDateTime;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ValidDate(ADate: TDateTime): Boolean;
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> DateDiff(Date1, Date2: TDateTime; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> Days, Months, Years: Word);
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> MonthsBetween(Date1, Date2: TDateTime): Double;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> DaysInPeriod(Date1, Date2: TDateTime): Longint;
</span><span class="pas1-comment">{ Count days between Date1 and Date2 + 1, so if Date1 = Date2 result = 1 }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> DaysBetween(Date1, Date2: TDateTime): Longint;
</span><span class="pas1-comment">{ The same as previous but if Date2 &lt; Date1 result = 0 }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> IncTime(ATime: TDateTime; Hours, Minutes, Seconds, MSecs: Integer): TDateTime;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> IncHour(ATime: TDateTime; Delta: Integer): TDateTime;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> IncMinute(ATime: TDateTime; Delta: Integer): TDateTime;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> IncSecond(ATime: TDateTime; Delta: Integer): TDateTime;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> IncMSec(ATime: TDateTime; Delta: Integer): TDateTime;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> CutTime(ADate: TDateTime): TDateTime; </span><span class="pas1-preprocessor">{$IFDEF SUPPORTS_INLINE}</span><span class="pas1-space"> </span><span class="pas1-reservedword">inline</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$ENDIF SUPPORTS_INLINE}</span><span class="pas1-space"> </span><span class="pas1-comment">{ Set time to 00:00:00:00 }

{ String to date conversions }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> GetDateOrder(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> DateFormat: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): TDateOrder;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> MonthFromName(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; MaxLen: Byte): Byte;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> StrToDateDef(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">Default</span><span class="pas1-symbol">: TDateTime): TDateTime;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> StrToDateFmt(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> DateFormat, S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): TDateTime;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> StrToDateFmtDef(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> DateFormat, S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">Default</span><span class="pas1-symbol">: TDateTime): TDateTime;
</span><span class="pas1-comment">//function DefDateFormat(AFourDigitYear: Boolean): string;
//function DefDateMask(BlanksChar: Char; AFourDigitYear: Boolean): string;

</span><span class="pas1-reservedword">function</span><span class="pas1-space"> FormatLongDate(Value: TDateTime): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> FormatLongDateTime(Value: TDateTime): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ end JvDateUtil }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> BufToBinStr(Buf: Pointer; BufSize: Integer): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> BinStrToBuf(Value: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; Buf: Pointer; BufSize: Integer): Integer;


</span><span class="pas1-comment">{ begin JvStrUtils }


</span><span class="pas1-reservedword">function</span><span class="pas1-space"> StrToOem(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> AnsiStr: AnsiString): AnsiString;
</span><span class="pas1-comment">{ StrToOem translates a string from the Windows character set into the
  OEM character set. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> OemToAnsiStr(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> OemStr: AnsiString): AnsiString;
</span><span class="pas1-comment">{ OemToAnsiStr translates a string from the OEM character set into the
  Windows character set. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> IsEmptyStr(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> EmptyChars: TSysCharSet): Boolean;
</span><span class="pas1-comment">{ EmptyStr returns True if the given string contains only character
  from the EmptyChars. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ReplaceStr(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S, Srch, Replace: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ Returns string with every occurrence of Srch string replaced with
  Replace string. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> DelSpace(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ DelSpace return a string with all white spaces removed. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> DelChars(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; Chr: Char): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ DelChars return a string with all Chr characters removed. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> DelBSpace(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ DelBSpace trims leading spaces from the given string. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> DelESpace(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ DelESpace trims trailing spaces from the given string. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> DelRSpace(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ DelRSpace trims leading and trailing spaces from the given string. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> DelSpace1(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ DelSpace1 return a string with all non-single white spaces removed. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> Tab2Space(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; Numb: Byte): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ Tab2Space converts any tabulation character in the given string to the
  Numb spaces characters. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> NPos(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> C: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; N: Integer): Integer;
</span><span class="pas1-comment">{ NPos searches for a N-th position of substring C in a given string. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> MakeStr(C: Char; N: Integer): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
</span><span class="pas1-preprocessor">{$IFNDEF COMPILER12_UP}
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> MakeStr(C: WideChar; N: Integer): WideString; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
</span><span class="pas1-preprocessor">{$ENDIF !COMPILER12_UP}
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> MS(C: Char; N: Integer): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$IFDEF SUPPORTS_INLINE}</span><span class="pas1-space"> </span><span class="pas1-reservedword">inline</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$ENDIF SUPPORTS_INLINE}
</span><span class="pas1-comment">{ MakeStr return a string of length N filled with character C. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> AddChar(C: Char; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; N: Integer): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ AddChar return a string left-padded to length N with characters C. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> AddCharR(C: Char; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; N: Integer): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ AddCharR return a string right-padded to length N with characters C. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> LeftStr(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; N: Integer): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ LeftStr return a string right-padded to length N with blanks. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> RightStr(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; N: Integer): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ RightStr return a string left-padded to length N with blanks. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> CenterStr(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; Len: Integer): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ CenterStr centers the characters in the string based upon the
  Len specified. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> CompStr(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S1, S2: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Integer; </span><span class="pas1-preprocessor">{$IFDEF SUPPORTS_INLINE}</span><span class="pas1-space"> </span><span class="pas1-reservedword">inline</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$ENDIF SUPPORTS_INLINE}
</span><span class="pas1-comment">{ CompStr compares S1 to S2, with case-sensitivity. The return value is
  -1 if S1 &lt; S2, 0 if S1 = S2, or 1 if S1 &gt; S2. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> CompText(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S1, S2: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Integer; </span><span class="pas1-preprocessor">{$IFDEF SUPPORTS_INLINE}</span><span class="pas1-space"> </span><span class="pas1-reservedword">inline</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$ENDIF SUPPORTS_INLINE}
</span><span class="pas1-comment">{ CompText compares S1 to S2, without case-sensitivity. The return value
  is the same as for CompStr. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> Copy2Symb(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; Symb: Char): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ Copy2Symb returns a substring of a string S from begining to first
  character Symb. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> Copy2SymbDel(</span><span class="pas1-reservedword">var</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; Symb: Char): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ Copy2SymbDel returns a substring of a string S from begining to first
  character Symb and removes this substring from S. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> Copy2Space(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ Copy2Symb returns a substring of a string S from begining to first
  white space. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> Copy2SpaceDel(</span><span class="pas1-reservedword">var</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ Copy2SpaceDel returns a substring of a string S from begining to first
  white space and removes this substring from S. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> AnsiProperCase(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> WordDelims: TSysCharSet): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ Returns string, with the first letter of each word in uppercase,
  all other letters in lowercase. Words are delimited by WordDelims. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> WordCount(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> WordDelims: TSysCharSet): Integer;
</span><span class="pas1-comment">{ WordCount given a set of word delimiters, returns number of words in S. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> WordPosition(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> N: Integer; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
  </span><span class="pas1-reservedword">const</span><span class="pas1-space"> WordDelims: TSysCharSet): Integer;
</span><span class="pas1-comment">{ Given a set of word delimiters, returns start position of N'th word in S. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ExtractWord(N: Integer; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
  </span><span class="pas1-reservedword">const</span><span class="pas1-space"> WordDelims: TSysCharSet): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ExtractWordPos(N: Integer; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
  </span><span class="pas1-reservedword">const</span><span class="pas1-space"> WordDelims: TSysCharSet; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> Pos: Integer): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ExtractDelimited(N: Integer; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
  </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Delims: TSysCharSet): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ ExtractWord, ExtractWordPos and ExtractDelimited given a set of word
  delimiters, return the N'th word in S. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ExtractSubstr(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> Pos: Integer;
  </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Delims: TSysCharSet): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ ExtractSubstr given a set of word delimiters, returns the substring from S,
  that started from position Pos. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> IsWordPresent(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> W, S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> WordDelims: TSysCharSet): Boolean;
</span><span class="pas1-comment">{ IsWordPresent given a set of word delimiters, returns True if word W is
  present in string S. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> QuotedString(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; Quote: Char): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ QuotedString returns the given string as a quoted string, using the
  provided Quote character. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ExtractQuotedString(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; Quote: Char): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ ExtractQuotedString removes the Quote characters from the beginning and
  end of a quoted string, and reduces pairs of Quote characters within
  the quoted string to a single character. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> FindPart(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> HelpWilds, InputStr: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Integer;
</span><span class="pas1-comment">{ FindPart compares a string with '?' and another, returns the position of
  HelpWilds in InputStr. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> IsWild(InputStr, Wilds: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; IgnoreCase: Boolean): Boolean;
</span><span class="pas1-comment">{ IsWild compares InputString with WildCard string and returns True
  if corresponds. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> XorString(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Key, Src: ShortString): ShortString;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> XorEncode(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Key, Source: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> XorDecode(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Key, Source: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;

</span><span class="pas1-comment">{ ** Command line routines ** }

</span><span class="pas1-reservedword">function</span><span class="pas1-space"> GetCmdLineArg(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Switch: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; ASwitchChars: TSysCharSet): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;

</span><span class="pas1-comment">{ ** Numeric string handling routines ** }

</span><span class="pas1-reservedword">function</span><span class="pas1-space"> Numb2USA(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ Numb2USA converts numeric string S to USA-format. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> Dec2Hex(N: Longint; A: Byte): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$IFDEF SUPPORTS_INLINE}</span><span class="pas1-space"> </span><span class="pas1-reservedword">inline</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$ENDIF SUPPORTS_INLINE}
</span><span class="pas1-comment">{ Dec2Hex converts the given value to a hexadecimal string representation
  with the minimum number of digits (A) specified. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> Hex2Dec(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Longint;
</span><span class="pas1-comment">{ Hex2Dec converts the given hexadecimal string to the corresponding integer
  value. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> Dec2Numb(N: Int64; A, B: Byte): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ Dec2Numb converts the given value to a string representation with the
  base equal to B and with the minimum number of digits (A) specified. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> Numb2Dec(S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; B: Byte): Int64;
</span><span class="pas1-comment">{ Numb2Dec converts the given B-based numeric string to the corresponding
  integer value. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> IntToBin(Value: Longint; Digits, Spaces: Integer): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ IntToBin converts the given value to a binary string representation
  with the minimum number of digits specified. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> IntToRoman(Value: Longint): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ IntToRoman converts the given value to a roman numeric string
  representation. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> RomanToInt(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Longint;
</span><span class="pas1-comment">{ RomanToInt converts the given string to an integer value. If the string
  doesn't contain a valid roman numeric value, the 0 value is returned. }

</span><span class="pas1-reservedword">function</span><span class="pas1-space"> FindNotBlankCharPos(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Integer;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> FindNotBlankCharPosW(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: WideString): Integer;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> AnsiChangeCase(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> WideChangeCase(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;

</span><span class="pas1-reservedword">function</span><span class="pas1-space"> StartsText(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> SubStr, S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Boolean;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> EndsText(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> SubStr, S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Boolean;

</span><span class="pas1-reservedword">function</span><span class="pas1-space"> DequotedStr(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; QuoteChar: Char = </span><span class="pas1-string">''''</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> AnsiDequotedStr(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; AQuote: Char): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-comment">// follow Delphi 2009's &quot;Ansi&quot; prefix

{end JvStrUtils}

</span><span class="pas1-preprocessor">{$IFDEF UNIX}
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> GetTempFileName(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Prefix: AnsiString): AnsiString;
</span><span class="pas1-preprocessor">{$ENDIF UNIX}

</span><span class="pas1-comment">{ begin JvFileUtil }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> FileDateTime(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> FileName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): TDateTime;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> HasAttr(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> FileName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; Attr: Integer): Boolean;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> DeleteFilesEx(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> FileMasks: </span><span class="pas1-reservedword">array</span><span class="pas1-space"> </span><span class="pas1-reservedword">of</span><span class="pas1-space"> </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Boolean;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> NormalDir(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> DirName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> RemoveBackSlash(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> DirName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-comment">// only for Windows/DOS Paths
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ValidFileName(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> FileName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Boolean;

</span><span class="pas1-preprocessor">{$IFDEF MSWINDOWS}
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> FileLock(Handle: Integer; Offset, LockSize: Longint): Integer; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> FileLock(Handle: Integer; Offset, LockSize: Int64): Integer; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> FileUnlock(Handle: Integer; Offset, LockSize: Longint): Integer; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> FileUnlock(Handle: Integer; Offset, LockSize: Int64): Integer; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
</span><span class="pas1-preprocessor">{$ENDIF MSWINDOWS}
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> GetWindowsDir: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> GetSystemDir: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;

</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ShortToLongFileName(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> ShortName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> LongToShortFileName(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> LongName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ShortToLongPath(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> ShortName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> LongToShortPath(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> LongName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-preprocessor">{$IFDEF MSWINDOWS}
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> CreateFileLink(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> FileName, DisplayName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; Folder: Integer);
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> DeleteFileLink(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> DisplayName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; Folder: Integer);
</span><span class="pas1-preprocessor">{$ENDIF MSWINDOWS}

</span><span class="pas1-comment">{ end JvFileUtil }

// Works like PtInRect but includes all edges in comparision
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> PtInRectInclusive(R: TRect; Pt: TPoint): Boolean;
</span><span class="pas1-comment">// Works like PtInRect but excludes all edges from comparision
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> PtInRectExclusive(R: TRect; Pt: TPoint): Boolean;

</span><span class="pas1-reservedword">function</span><span class="pas1-space"> FourDigitYear: Boolean; </span><span class="pas1-preprocessor">{$IFDEF SUPPORTS_DEPRECATED}</span><span class="pas1-space"> </span><span class="pas1-reservedword">deprecated</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$ENDIF}
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> IsFourDigitYear: Boolean;

</span><span class="pas1-comment">{ moved from JvJVCLUTils }

//Open an object with the shell (url or something like that)
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> OpenObject(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Value: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Boolean; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> OpenObject(Value: PChar): Boolean; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;

</span><span class="pas1-preprocessor">{$IFDEF MSWINDOWS}
</span><span class="pas1-comment">//Raise the last Exception
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> RaiseLastWin32; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> RaiseLastWin32(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Text: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">); </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
</span><span class="pas1-comment">//Raise the last Exception with a small comment from your part

{ GetFileVersion returns the most significant 32 bits of a file's binary
  version number. Typically, this includes the major and minor version placed
  together in one 32-bit Integer. It generally does not include the release
  or build numbers. It returns 0 if it failed. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> GetFileVersion(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> AFileName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Cardinal;

</span><span class="pas1-comment">//Get version of Shell.dll
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> GetShellVersion: Cardinal;

</span><span class="pas1-comment">// CD functions
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> OpenCdDrive;
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> CloseCdDrive;

</span><span class="pas1-comment">// returns True if Drive is accessible
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> DiskInDrive(Drive: Char): Boolean;
</span><span class="pas1-preprocessor">{$ENDIF MSWINDOWS}

</span><span class="pas1-comment">//Same as linux function ;)
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> PError(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Text: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">);

</span><span class="pas1-comment">// execute a program without waiting
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> Exec(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> FileName, Parameters, Directory: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">);
</span><span class="pas1-comment">// execute a program and wait for it to finish
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ExecuteAndWait(CommandLine: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> WorkingDirectory: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; Visibility: Integer = SW_SHOW): Integer;


</span><span class="pas1-comment">// returns True if this is the first instance of the program that is running
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> FirstInstance(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> ATitle: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Boolean;
</span><span class="pas1-comment">// restores a window based on it's classname and Caption. Either can be left empty
// to widen the search
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> RestoreOtherInstance(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> MainFormClassName, MainFormCaption: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">);

</span><span class="pas1-comment">// manipulate the traybar and start button
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> HideTraybar;
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> ShowTraybar;
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> ShowStartButton(Visible: Boolean = True);

</span><span class="pas1-comment">// (rom) SC_MONITORPOWER is documented as Windows 95 only
// (rom) better do some testing
// set monitor functions
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> MonitorOn;
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> MonitorOff;
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> LowPower;

</span><span class="pas1-comment">// send a key to the window named AppName
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> SendKey(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> AppName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; Key: Char): Boolean;

</span><span class="pas1-preprocessor">{$IFDEF MSWINDOWS}

</span><span class="pas1-comment">// returns a list of all windows currently visible, the Objects property is filled with their window handle
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> GetVisibleWindows(List: TStrings);
</span><span class="pas1-comment">// associates an extension to a specific program
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> AssociateExtension(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> IconPath, ProgramName, Path, Extension: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">);

</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> AddToRecentDocs(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> FileName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">);
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> GetRecentDocs: TStringList;
</span><span class="pas1-preprocessor">{$ENDIF MSWINDOWS}


</span><span class="pas1-reservedword">function</span><span class="pas1-space"> CharIsMoney(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Ch: Char): Boolean;

</span><span class="pas1-comment">{ there is a STrToIntDef provided by Delphi, but no &quot;safe&quot; versions of
  StrToFloat or StrToCurr }
// Note: before using JvSafeStrToFloatDef, please be aware that it will ignore
// any character that is not a valid character for a float, which is different
// from what StrToFloatDef in Delphi 6 up is doing. This has been documented in Mantis
// issue# 2935: http://issuetracker.delphi-jedi.org/view.php?id=2935
// and in Mantis 4466: http://issuetracker.delphi-jedi.org/view.php?id=4466

//function JvSafeStrToFloatDef(const Str: string; Def: Extended; aDecimalSeparator: Char = ' '): Extended; {NOTE: default value of Space is a magic wildcard}

//function JvSafeStrToFloat(const Str: string; aDecimalSeparator: Char = ' '): Extended; {NOTE: default value of Space is a magic wildcard}


//function StrToCurrDef(const Str: string; Def: Currency): Currency;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> IntToExtended(I: Integer): Extended;

</span><span class="pas1-comment">{ GetChangedText works out the new text given the current cursor pos &amp; the key pressed
  It is not very useful in other contexts,
  but it is in this unit as it is needed in both MemoEx and TypedEdit }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> GetChangedText(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Text: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; SelStart, SelLength: Integer; Key: Char): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;

</span><span class="pas1-reservedword">function</span><span class="pas1-space"> MakeYear4Digit(Year, Pivot: Integer): Integer;

</span><span class="pas1-comment">//function StrIsInteger(const S: string): Boolean;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> StrIsFloatMoney(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Ps: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Boolean;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> StrIsDateTime(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Ps: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Boolean;

</span><span class="pas1-reservedword">function</span><span class="pas1-space"> PreformatDateString(Ps: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;

</span><span class="pas1-reservedword">function</span><span class="pas1-space"> BooleanToInteger(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> B: Boolean): Integer;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> StringToBoolean(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Ps: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Boolean;

</span><span class="pas1-reservedword">function</span><span class="pas1-space"> SafeStrToDateTime(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Ps: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): TDateTime;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> SafeStrToDate(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Ps: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): TDateTime;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> SafeStrToTime(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Ps: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): TDateTime;

</span><span class="pas1-reservedword">function</span><span class="pas1-space"> StrDelete(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> psSub, psMain: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;

  </span><span class="pas1-comment">{ returns the fractional value of pcValue}
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> TimeOnly(pcValue: TDateTime): TTime;
</span><span class="pas1-comment">{ returns the integral value of pcValue }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> DateOnly(pcValue: TDateTime): TDate;

</span><span class="pas1-reservedword">type
</span><span class="pas1-space">  TdtKind = (dtkDateOnly, dtkTimeOnly, dtkDateTime);

</span><span class="pas1-reservedword">const
</span><span class="pas1-space">  </span><span class="pas1-comment">{ TDateTime value used to signify Null value}
</span><span class="pas1-space">  NullEquivalentDate: TDateTime = </span><span class="pas1-float">0.0</span><span class="pas1-symbol">;

</span><span class="pas1-reservedword">function</span><span class="pas1-space"> DateIsNull(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> pdtValue: TDateTime; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> pdtKind: TdtKind): Boolean;
</span><span class="pas1-comment">// Replacement for Win32Check to avoid platform specific warnings in D6
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> OSCheck(RetVal: Boolean): Boolean;

</span><span class="pas1-comment">{ Shortens a fully qualified Path name so that it can be drawn with a specified length limit.
  Same as FileCtrl.MinimizeName in functionality (but not implementation). Included here to
  not be forced to use FileCtrl unnecessarily }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> MinimizeFileName(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> FileName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; Canvas: TCanvas; MaxLen: Integer): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> MinimizeText(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Text: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; Canvas: TCanvas; MaxWidth: Integer): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-comment">{ MinimizeString trunactes long string, S, and appends
  '...' symbols, if Length of S is more than MaxLen }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> MinimizeString(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> MaxLen: Integer): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;

</span><span class="pas1-preprocessor">{$IFDEF MSWINDOWS}
</span><span class="pas1-comment">{ RunDLL32 runs a function in a DLL using the utility rundll32.exe (on NT) or rundll.exe (on Win95/98)
 ModuleName is the name of the DLL to load, FuncName is the function to call and CmdLine is
 the command-line parameters (if any) to send to the function. Set WaitForCompletion to False to
 return immediately after the call.
 CmdShow should be one of the SW_SHOWXXXX constants and defaults SW_SHOWDEFAULT
 Return value:
 if WaitForCompletion is True, returns True if the wait didn't return WAIT_FAILED
 if WaitForCompletion is False, returns True if the process could be created
 To get information on why RunDLL32 might have failed, call GetLastError
 To get more info on what can actually be called using rundll32.exe, take a look at
 http://www.dx21.com/SCRIPTING/RUNDLL32/REFGUIDE.ASP?NTI=4&amp;SI=6
}
</span><span class="pas1-reservedword">type
</span><span class="pas1-space">  </span><span class="pas1-comment">// the signature of procedures in DLL's that can be called using rundll32.exe
</span><span class="pas1-space">  TRunDLL32Proc = </span><span class="pas1-reservedword">procedure</span><span class="pas1-symbol">(Handle: THandle; HInstance: HMODULE; CmdLine: PChar; CmdShow: Integer); </span><span class="pas1-reservedword">stdcall</span><span class="pas1-symbol">;

</span><span class="pas1-reservedword">function</span><span class="pas1-space"> RunDLL32(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> ModuleName, FuncName, CmdLine: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; WaitForCompletion: Boolean; CmdShow:
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> RunDll32Internal(Wnd: THandle; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> DLLName, FuncName, CmdLine: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; CmdShow: Integer = SW_SHOWDEFAULT);
</span><span class="pas1-comment">{ GetDLLVersion loads DLLName, gets a pointer to the DLLVersion function and calls it, returning the major and minor version values
from the function. Returns False if the DLL couldn't be loaded or if GetDLLVersion couldn't be found. }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> GetDLLVersion(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> DLLName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> pdwMajor, pdwMinor: Integer): Boolean;
</span><span class="pas1-preprocessor">{$ENDIF MSWINDOWS}

</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> ResourceNotFound(ResID: PChar);
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> EmptyRect: TRect;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> RectWidth(R: TRect): Integer;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> RectHeight(R: TRect): Integer;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> CompareRect(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> R1, R2: TRect): Boolean;
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> RectNormalize(</span><span class="pas1-reservedword">var</span><span class="pas1-space"> R: TRect);
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> RectIsSquare(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> R: TRect): Boolean;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> RectSquare(</span><span class="pas1-reservedword">var</span><span class="pas1-space"> ARect: TRect; AMaxSize: Integer = -</span><span class="pas1-number">1</span><span class="pas1-symbol">): Boolean;
</span><span class="pas1-comment">//If AMaxSize = -1 ,then auto calc Square's max size

</span><span class="pas1-preprocessor">{$IFDEF MSWINDOWS}
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> FreeUnusedOle;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> GetWindowsVersion: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> LoadDLL(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> LibName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): THandle;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> RegisterServer(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> ModuleName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Boolean;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> UnregisterServer(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> ModuleName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Boolean;
</span><span class="pas1-preprocessor">{$ENDIF MSWINDOWS}

</span><span class="pas1-comment">{ String routines }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> GetEnvVar(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> VarName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> AnsiUpperFirstChar(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-comment">// follow Delphi 2009's example with the &quot;Ansi&quot; prefix
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> StringToPChar(</span><span class="pas1-reservedword">var</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): PChar;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> StrPAlloc(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): PChar;
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> SplitCommandLine(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> CmdLine: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> ExeName, Params: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">);
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> DropT(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> S: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;

</span><span class="pas1-comment">{ Memory routines }

</span><span class="pas1-reservedword">function</span><span class="pas1-space"> AllocMemo(Size: Longint): Pointer;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ReallocMemo(fpBlock: Pointer; Size: Longint): Pointer;
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> FreeMemo(</span><span class="pas1-reservedword">var</span><span class="pas1-space"> fpBlock: Pointer);
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> GetMemoSize(fpBlock: Pointer): Longint;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> CompareMem(fpBlock1, fpBlock2: Pointer; Size: Cardinal): Boolean;

</span><span class="pas1-comment">{ Manipulate huge pointers routines }

</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> HugeInc(</span><span class="pas1-reservedword">var</span><span class="pas1-space"> HugePtr: Pointer; Amount: Longint);
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> HugeDec(</span><span class="pas1-reservedword">var</span><span class="pas1-space"> HugePtr: Pointer; Amount: Longint);
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> HugeOffset(HugePtr: Pointer; Amount: Longint): Pointer;
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> HugeMove(Base: Pointer; Dst, Src, Size: Longint);
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> HMemCpy(DstPtr, SrcPtr: Pointer; Amount: Longint);

</span><span class="pas1-reservedword">function</span><span class="pas1-space"> WindowClassName(Wnd: THandle): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;

</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> SwitchToWindow(Wnd: THandle; Restore: Boolean);
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> ActivateWindow(Wnd: THandle);
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> ShowWinNoAnimate(Handle: THandle; CmdShow: Integer);
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> KillMessage(Wnd: THandle; Msg: Cardinal);

</span><span class="pas1-comment">{ SetWindowTop put window to top without recreating window }
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> SetWindowTop(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Handle: THandle; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Top: Boolean);
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> CenterWindow(Wnd: THandle);
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> MakeVariant(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Values: </span><span class="pas1-reservedword">array</span><span class="pas1-space"> </span><span class="pas1-reservedword">of</span><span class="pas1-space"> Variant): Variant;

</span><span class="pas1-comment">{ Convert dialog units to pixels and backwards }

</span><span class="pas1-preprocessor">{$IFDEF MSWINDOWS}
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> DialogUnitsToPixelsX(DlgUnits: Word): Word;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> DialogUnitsToPixelsY(DlgUnits: Word): Word;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> PixelsToDialogUnitsX(PixUnits: Word): Word;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> PixelsToDialogUnitsY(PixUnits: Word): Word;
</span><span class="pas1-preprocessor">{$ENDIF MSWINDOWS}

</span><span class="pas1-reservedword">function</span><span class="pas1-space"> GetUniqueFileNameInDir(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Path, FileNameMask: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;

</span><span class="pas1-preprocessor">{$IFDEF BCB}
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> FindPrevInstance(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> MainFormClass: ShortString;
  </span><span class="pas1-reservedword">const</span><span class="pas1-space"> ATitle: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): THandle;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ActivatePrevInstance(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> MainFormClass: ShortString;
  </span><span class="pas1-reservedword">const</span><span class="pas1-space"> ATitle: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Boolean;
</span><span class="pas1-preprocessor">{$ELSE}
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> FindPrevInstance(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> MainFormClass, ATitle: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): THandle;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ActivatePrevInstance(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> MainFormClass, ATitle: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Boolean;
</span><span class="pas1-preprocessor">{$ENDIF BCB}


{$IFDEF MSWINDOWS}
</span><span class="pas1-comment">{ BrowseForFolderNative displays Browse For Folder dialog }
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> BrowseForFolderNative(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Handle: THandle; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Title: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> Folder: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Boolean;
</span><span class="pas1-preprocessor">{$ENDIF MSWINDOWS}


</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> AntiAlias(Clip: TBitmap);
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> AntiAliasRect(Clip: TBitmap; XOrigin, YOrigin,
  XFinal, YFinal: Integer);

</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> CopyRectDIBits(ACanvas: TCanvas; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> DestRect: TRect;
  ABitmap: TBitmap; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> SourceRect: TRect);
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> IsTrueType(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> FontName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Boolean;


</span><span class="pas1-comment">// Removes all non-numeric characters from AValue and returns
// the resulting string
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> TextToValText(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> AValue: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;


</span><span class="pas1-comment">// VisualCLX compatibility functions
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> DrawText(DC: HDC; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Text: TCaption; Len: Integer; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> R: TRect; WinFlags: Integer): Integer; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> DrawText(Canvas: TCanvas; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Text: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; Len: Integer; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> R: TRect; WinFlags: Integer): Integer; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> DrawText(Canvas: TCanvas; Text: PAnsiChar; Len: Integer; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> R: TRect; WinFlags: Integer): Integer; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> DrawTextEx(Canvas: TCanvas; lpchText: PChar; cchText: Integer; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> p4: TRect; dwDTFormat: UINT; DTParams: PDrawTextParams): Integer; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> DrawTextEx(Canvas: TCanvas; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Text: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; cchText: Integer; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> p4: TRect; dwDTFormat: UINT; DTParams: PDrawTextParams): Integer; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> DrawText(Canvas: TCanvas; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Text: WideString; Len: Integer; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> R: TRect; WinFlags: Integer): Integer; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> DrawTextEx(Canvas: TCanvas; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Text: WideString; cchText: Integer; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> p4: TRect; dwDTFormat: UINT; DTParams: PDrawTextParams): Integer; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;

</span><span class="pas1-reservedword">function</span><span class="pas1-space"> DrawTextW(Canvas: TCanvas; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Text: WideString; Len: Integer; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> R: TRect; WinFlags: Integer): Integer; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> DrawTextW(Canvas: TCanvas; Text: PWideChar; Len: Integer; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> R: TRect; WinFlags: Integer): Integer; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> DrawTextExW(Canvas: TCanvas; lpchText: PWideChar; cchText: Integer; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> p4: TRect; dwDTFormat: UINT; DTParams: PDrawTextParams): Integer; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> DrawTextExW(Canvas: TCanvas; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Text: WideString; cchText: Integer; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> p4: TRect; dwDTFormat: UINT; DTParams: PDrawTextParams): Integer; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;



Changes </span><span class="pas1-reservedword">to</span><span class="pas1-space"> V3.</span><span class="pas1-number">9</span><span class="pas1-space">   (five !!)



</span><span class="pas1-comment">//NoErrMsg variable
//- Controls whether the application displays an error message when a runtime error
//occurs.

{CompareValue function
- Returns the relationship between two numeric values.}

{SameValue function
- Indicates whether two floating-point values are (approximately) equal.}

{Sign function
- Indicates whether a numeric value is positive, negative, or zero.}

{SimpleRoundTo function
- Rounds a floating-point value to a specified digit or power of ten using
asymmetric arithmetic rounding.}

{AddExitProc procedure
- Add procedure to exit list.}
{ExitCode variable
- Contains the application's exit code.}
{UnicodeToUtf8 function
- Converts a string of Unicode characters into a UTF-8 string.}
{WideCharToStrVar procedure
- Converts Unicode string to a single or multi byte character data.}
{CreateClassID function
- CreateClassID generates a new GUID and returns it as a string.
{OleStrToString function
- Copies data received from a COM interface to a string.
{Supports function
- Indicates whether a given object or interface supports a specified interface.
{VarComplexToPolar procedure
- Computes the polar coordinates that correspond to a custom Variant that
represents a complex number.}
</span><span class="pas1-identifier">FindDatabaseID </span><span class="pas1-reservedword">function
</span><span class="pas1-symbol">- Returns the ID </span><span class="pas1-reservedword">of</span><span class="pas1-space"> a specified database.

FindFieldID </span><span class="pas1-reservedword">function
</span><span class="pas1-symbol">- Returns the ID </span><span class="pas1-reservedword">of</span><span class="pas1-space"> a specified field.

FindTableID </span><span class="pas1-reservedword">function
</span><span class="pas1-symbol">- Returns the ID </span><span class="pas1-reservedword">of</span><span class="pas1-space"> a specified table.

GetAttrID </span><span class="pas1-reservedword">function
</span><span class="pas1-symbol">- Returns the ID </span><span class="pas1-reservedword">of</span><span class="pas1-space"> the attribute </span><span class="pas1-reservedword">set</span><span class="pas1-space"> associated </span><span class="pas1-reservedword">with</span><span class="pas1-space"> a field.
</span><span class="pas1-comment">{AnsiToNative function
- Converts a string from the ANSI character set to the character set associated
with a given locale.}
{NativeCompareStr function
- Compares strings based on a database locale case sensitively.

NativeCompareStrBuf function
- Compares null-terminated strings based on a database locale case sensitively.
{PasswordDialog function
- Displays a dialog box that prompts the user for the password of a local
password-protected table.}
{CheckSqlTimeStamp procedure
- Checks whether a TSQLTimeStamp value represents a valid date and time.}
{DateTimeToSQLTimeStamp function
- Converts a TDateTime value to a TSQLTimeStamp value.}
{NullSQLTimeStamp constant
- Represents a NULL TSQLTimeStamp value.}
{IsAbortResult function
- Checks the return value from a modal form dialog and indicates whether the user
selected Abort or Cancel.}
{LoginDialog function
- Brings up the database Login dialog to allow the user to connect to a database
server.

LoginDialogEx function
- Brings up the database Login dialog to allow the user to connect to a database
server.    }
{RemoteLoginDialog function
- Brings up the database Login dialog to allow the user to connect to a database
server. }
{StripAllFromResult function
- Converts a TModalResult value from a constant that refers to all to the
corresponding simple constant.}
{AcquireExceptionObject function
- Allows an exception object to persist after the except clause exits.}
(*ExtractShortPathName function
- Converts a file name to the short 8.3 form.

IncludeTrailingBackslash function
- Ensures path name ends with delimiter

IncludeTrailingPathDelimiter function
- Ensures path name ends with delimiter.

IsPathDelimiter function
- Indicates whether the byte at position Index of a string is the path delimiter.*)
{FloatToTextFmt function
- Converts a floating-point value to to an unterminated character string, using
a specified format.    }
(*CreateGrayMappedRes function
- Remaps the standard gray colors in a bitmap resource with the system grays.

CreateMappedBmp function
- Changes the color table in a bitmap.       *)
{GetDefFontCharSet function
- Returns the character set of the default system font.}
{GraphicExtension function
- Returns the default file-name extension of a graphics object.}
{GraphicFilter function
- Returns a file filter compatible with the Filter property of an Open or Save
dialog.}
{GetExtensionVersion function
- Returns the name and version number of an ISAPI or NSAPI application.}
{Rename procedure
- Changes the name of an external file.}</span><span class="pas1-space">  </span><span class="pas1-comment">// there are 2 renames!!
{Truncate procedure
- Deletes all the records after the current file position.}
</span><span class="pas1-identifier">SameFileName </span><span class="pas1-reservedword">function
</span><span class="pas1-symbol">- Compares </span><span class="pas1-reservedword">file</span><span class="pas1-space"> names based </span><span class="pas1-reservedword">on</span><span class="pas1-space"> the current locale.*)
</span><span class="pas1-comment">{DefaultTextLineBreakStyle variable
- Specifies the characters that are used by default to separate lines in text.}
{GetEnvironmentVariable function
- Returns environment variable value..!!!}
{Slice function
- Returns a sub-section of an array.}
{UnloadPackage procedure
- Unloads a package.         !!!}
{Exclude procedure
- Removes an element from a set.}

{Include procedure
- Adds an element to a set.!!!}
{FindClass function
- Finds and returns a class that is derived from TPersistent.}
{FindClassHInstance function
- Returns the instance handle for the module in which a class type is defined.
{GetClass function
- Returns a registered persistent class given its name.
IntToIdent function
- Uses a mapping array to convert integers into their corresponding string
identifiers.  }
{BeginThread function
- Spawns a separate thread of execution.

CheckSynchronize function
- Allows background threads to synchronize their execution with the main thread.

EndThread function
- Terminates the execution of a thread.

ForegroundTask function
- Indicates whether the current thread is running in the foreground.

IsMultiThread variable
- Indicates whether the application spawned additional threads using BeginThread
or TThread objects.

WakeMainThread variable
- Represents a method (event handler) that is forced into the main threads queue.
{FindCustomVariantType function
- Retrieves the object that implements a custom Variant type.

GetVariantManager procedure
- Returns the entry points of the routines that define variant behavior.

IsVariantManagerSet function
- Indicates whether variant support is implemented in an application.}
{VarToStr function
- Converts a variant to a string.  !!!}
</span><span class="pas1-identifier">AllocateHwnd </span><span class="pas1-reservedword">function
</span><span class="pas1-symbol">- Creates a window that implements a specified window </span><span class="pas1-reservedword">procedure</span><span class="pas1-symbol">.
DestroyMetaPict </span><span class="pas1-reservedword">procedure
</span><span class="pas1-symbol">- Frees a metafile resource given its handle.
NewStyleControls variable
- Determines whether controls are drawn using the Windows </span><span class="pas1-float">3.</span><span class="pas1-identifier">x look.}
SameNamespace </span><span class="pas1-reservedword">function
</span><span class="pas1-symbol">- Indicates whether a specified node </span><span class="pas1-reservedword">is</span><span class="pas1-space"> defined within a specified namespace.


from db.pas

     FILE_PATH = </span><span class="pas1-string">'E:\maxbox\maxbox3\examples\271_closures_study.txt'</span><span class="pas1-symbol">;

</span><span class="pas1-reservedword">var
</span><span class="pas1-space">  LoginDialogProc: </span><span class="pas1-reservedword">function</span><span class="pas1-space"> (</span><span class="pas1-reservedword">const</span><span class="pas1-space"> ADatabaseName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> AUserName, APassword: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Boolean;
  LoginDialogExProc: </span><span class="pas1-reservedword">function</span><span class="pas1-space"> (</span><span class="pas1-reservedword">const</span><span class="pas1-space"> ADatabaseName: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> AUserName, APassword: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; NameReadOnly: Boolean): Boolean;
  RemoteLoginDialogProc: </span><span class="pas1-reservedword">function</span><span class="pas1-space"> (</span><span class="pas1-reservedword">var</span><span class="pas1-space"> AUserName, APassword: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): Boolean;
  ScreenCursorProc: </span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> (</span><span class="pas1-reservedword">const</span><span class="pas1-space"> CurIndex : integer);
  PasswordDialog: </span><span class="pas1-reservedword">function</span><span class="pas1-space"> (</span><span class="pas1-reservedword">const</span><span class="pas1-space"> ASession: IDBSession): Boolean;
  DBScreen: IDBScreen;
  DBApplication: IDBApplication;

</span><span class="pas1-comment">{ Global Functions }

</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ExtractFieldName(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Fields: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> Pos: Integer): </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">deprecated</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> ExtractFieldName(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Fields: WideString; </span><span class="pas1-reservedword">var</span><span class="pas1-space"> Pos: Integer): WideString; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> RegisterFields(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> FieldClasses: </span><span class="pas1-reservedword">array</span><span class="pas1-space"> </span><span class="pas1-reservedword">of</span><span class="pas1-space"> TFieldClass);

</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> DatabaseError(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> </span><span class="pas1-reservedword">Message</span><span class="pas1-symbol">: WideString; Component: TComponent = </span><span class="pas1-reservedword">nil</span><span class="pas1-symbol">);
</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> DatabaseErrorFmt(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> </span><span class="pas1-reservedword">Message</span><span class="pas1-symbol">: WIdeString; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Args: </span><span class="pas1-reservedword">array</span><span class="pas1-space"> </span><span class="pas1-reservedword">of</span><span class="pas1-space"> </span><span class="pas1-reservedword">const</span><span class="pas1-symbol">;
  Component: TComponent = </span><span class="pas1-reservedword">nil</span><span class="pas1-symbol">);

</span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> DisposeMem(</span><span class="pas1-reservedword">var</span><span class="pas1-space"> Buffer; Size: Integer);
</span><span class="pas1-reservedword">function</span><span class="pas1-space"> BuffersEqual(Buf1, Buf2: Pointer; Size: Integer): Boolean;
</span><span class="pas1-comment">{ moved to FmtBcd.pas
function BCDToCurr(const BCD: TBcd; var Curr: Currency): Boolean;
function CurrToBCD(Curr: Currency; var BCD: TBcd; Precision: Integer = 32;
  Decimals: Integer = 4): Boolean; }

</span><span class="pas1-reservedword">function</span><span class="pas1-space"> GetFieldProperty(DataSet: TDataSet; Control: TComponent;
  </span><span class="pas1-reservedword">const</span><span class="pas1-space"> FieldName: WideString): TField;

</span><span class="pas1-reservedword">function</span><span class="pas1-space"> VarTypeToDataType(VarType: Integer): TFieldType;

</span><span class="pas1-reservedword">implementation


</span><span class="pas1-identifier">uPSI_DB.pas

</span><span class="pas1-reservedword">unit</span><span class="pas1-space"> uPSI_DBLogDlg;

</span><span class="pas1-reservedword">unit</span><span class="pas1-space"> uPSI_SqlTimSt;

</span><span class="pas1-reservedword">unit</span><span class="pas1-space"> uPSI_DBTables;

icons </span><span class="pas1-reservedword">in</span><span class="pas1-space"> usecase

new units </span><span class="pas1-reservedword">in</span><span class="pas1-space"> </span><span class="pas1-float">3.9

</span><span class="pas1-identifier">jvcomponentbase
JvResources, JvgUtils_max;
</span><span class="pas1-reservedword">unit</span><span class="pas1-space"> JvStrUtil_max;

</span><span class="pas1-reservedword">unit</span><span class="pas1-space"> JvStrings;
</span><span class="pas1-number">123</span><span class="pas1-space"> </span><span class="pas1-reservedword">unit</span><span class="pas1-space"> uPSI_JvJCLUtils;



IToString = </span><span class="pas1-reservedword">interface
</span><span class="pas1-space">    [</span><span class="pas1-string">'{C4ABABB4-1029-46E7-B5FA-99800F130C05}'</span><span class="pas1-symbol">]
    </span><span class="pas1-reservedword">function</span><span class="pas1-space"> ToString: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">;
  </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;

  TCharDynArray = </span><span class="pas1-reservedword">array</span><span class="pas1-space"> </span><span class="pas1-reservedword">of</span><span class="pas1-space"> Char;

  </span><span class="pas1-comment">// The TStringBuilder class is a Delphi implementation of the .NET
</span><span class="pas1-space">  </span><span class="pas1-comment">// System.Text.StringBuilder.
</span><span class="pas1-space">  </span><span class="pas1-comment">// It is zero based and the method that allow an TObject (Append, Insert,
</span><span class="pas1-space">  </span><span class="pas1-comment">// AppendFormat) are limited to IToString implementors.
</span><span class="pas1-space">  </span><span class="pas1-comment">// This class is not threadsafe. Any instance of TStringBuilder should not
</span><span class="pas1-space">  </span><span class="pas1-comment">// be used in different threads at the same time.
</span><span class="pas1-space">  TJclStringBuilder = </span><span class="pas1-reservedword">class</span><span class="pas1-symbol">(TInterfacedObject, IToString)
  </span><span class="pas1-reservedword">private
</span><span class="pas1-space">    FChars: TCharDynArray;
    FLength: SizeInt;
    FMaxCapacity: SizeInt;

    </span><span class="pas1-reservedword">function</span><span class="pas1-space"> GetCapacity: SizeInt;
    </span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> SetCapacity(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Value: SizeInt);
    </span><span class="pas1-reservedword">function</span><span class="pas1-space"> GetChars(Index: SizeInt): Char;
    </span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> SetChars(Index: SizeInt; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Value: Char);
    </span><span class="pas1-reservedword">procedure</span><span class="pas1-space"> Set_Length(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Value: SizeInt);
  </span><span class="pas1-reservedword">protected
</span><span class="pas1-space">    </span><span class="pas1-reservedword">function</span><span class="pas1-space"> AppendPChar(Value: PChar; Count: SizeInt; RepeatCount: SizeInt = </span><span class="pas1-number">1</span><span class="pas1-symbol">): TJclStringBuilder;
    </span><span class="pas1-reservedword">function</span><span class="pas1-space"> InsertPChar(Index: SizeInt; Value: PChar; Count: SizeInt; RepeatCount: SizeInt = </span><span class="pas1-number">1</span><span class="pas1-symbol">): TJclStringBuilder;
  </span><span class="pas1-reservedword">public
</span><span class="pas1-space">    </span><span class="pas1-reservedword">constructor</span><span class="pas1-space"> Create(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Value: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; Capacity: SizeInt = </span><span class="pas1-number">16</span><span class="pas1-symbol">); </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
    </span><span class="pas1-reservedword">constructor</span><span class="pas1-space"> Create(Capacity: SizeInt = </span><span class="pas1-number">16</span><span class="pas1-symbol">; MaxCapacity: SizeInt = MaxInt); </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
    </span><span class="pas1-reservedword">constructor</span><span class="pas1-space"> Create(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Value: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; StartIndex, Length, Capacity: SizeInt); </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;

    </span><span class="pas1-reservedword">function</span><span class="pas1-space"> Append(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Value: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">): TJclStringBuilder; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
    </span><span class="pas1-reservedword">function</span><span class="pas1-space"> Append(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Value: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; StartIndex, Length: SizeInt): TJclStringBuilder; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
    </span><span class="pas1-reservedword">function</span><span class="pas1-space"> Append(Value: Boolean): TJclStringBuilder; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
    </span><span class="pas1-reservedword">function</span><span class="pas1-space"> Append(Value: Char; RepeatCount: SizeInt = </span><span class="pas1-number">1</span><span class="pas1-symbol">): TJclStringBuilder; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
    </span><span class="pas1-reservedword">function</span><span class="pas1-space"> Append(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Value: </span><span class="pas1-reservedword">array</span><span class="pas1-space"> </span><span class="pas1-reservedword">of</span><span class="pas1-space"> Char): TJclStringBuilder; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
    </span><span class="pas1-reservedword">function</span><span class="pas1-space"> Append(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Value: </span><span class="pas1-reservedword">array</span><span class="pas1-space"> </span><span class="pas1-reservedword">of</span><span class="pas1-space"> Char; StartIndex, Length: SizeInt): TJclStringBuilder; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
    </span><span class="pas1-reservedword">function</span><span class="pas1-space"> Append(Value: Cardinal): TJclStringBuilder; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
    </span><span class="pas1-reservedword">function</span><span class="pas1-space"> Append(Value: Integer): TJclStringBuilder; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
    </span><span class="pas1-reservedword">function</span><span class="pas1-space"> Append(Value: Double): TJclStringBuilder; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
    </span><span class="pas1-reservedword">function</span><span class="pas1-space"> Append(Value: Int64): TJclStringBuilder; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
    </span><span class="pas1-reservedword">function</span><span class="pas1-space"> Append(Obj: TObject): TJclStringBuilder; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
    </span><span class="pas1-reservedword">function</span><span class="pas1-space"> AppendFormat(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Fmt: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Args: </span><span class="pas1-reservedword">array</span><span class="pas1-space"> </span><span class="pas1-reservedword">of</span><span class="pas1-space"> </span><span class="pas1-reservedword">const</span><span class="pas1-symbol">): TJclStringBuilder; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
    </span><span class="pas1-reservedword">function</span><span class="pas1-space"> AppendFormat(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Fmt: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; Arg0: Variant): TJclStringBuilder; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
    </span><span class="pas1-reservedword">function</span><span class="pas1-space"> AppendFormat(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Fmt: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; Arg0, Arg1: Variant): TJclStringBuilder; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
    </span><span class="pas1-reservedword">function</span><span class="pas1-space"> AppendFormat(</span><span class="pas1-reservedword">const</span><span class="pas1-space"> Fmt: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; Arg0, Arg1, Arg2: Variant): TJclStringBuilder; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;

    </span><span class="pas1-reservedword">function</span><span class="pas1-space"> Insert(Index: SizeInt; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Value: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; Count: SizeInt = </span><span class="pas1-number">1</span><span class="pas1-symbol">): TJclStringBuilder; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
    </span><span class="pas1-reservedword">function</span><span class="pas1-space"> Insert(Index: SizeInt; Value: Boolean): TJclStringBuilder; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
    </span><span class="pas1-reservedword">function</span><span class="pas1-space"> Insert(Index: SizeInt; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Value: </span><span class="pas1-reservedword">array</span><span class="pas1-space"> </span><span class="pas1-reservedword">of</span><span class="pas1-space"> Char): TJclStringBuilder; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
    </span><span class="pas1-reservedword">function</span><span class="pas1-space"> Insert(Index: SizeInt; </span><span class="pas1-reservedword">const</span><span class="pas1-space"> Value: </span><span class="pas1-reservedword">array</span><span class="pas1-space"> </span><span class="pas1-reservedword">of</span><span class="pas1-space"> Char; StartIndex, Length: SizeInt): TJclStringBuilder;
      </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
    </span><span class="pas1-reservedword">function</span><span class="pas1-space"> Insert(Index: SizeInt; Value: Cardinal): TJclStringBuilder; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
    </span><span class="pas1-reservedword">function</span><span class="pas1-space"> Insert(Index: SizeInt; Value: Integer): TJclStringBuilder; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
    </span><span class="pas1-reservedword">function</span><span class="pas1-space"> Insert(Index: SizeInt; Value: Double): TJclStringBuilder; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
    </span><span class="pas1-reservedword">function</span><span class="pas1-space"> Insert(Index: SizeInt; Value: Int64): TJclStringBuilder; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
    </span><span class="pas1-reservedword">function</span><span class="pas1-space"> Insert(Index: SizeInt; Obj: TObject): TJclStringBuilder; </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;

    </span><span class="pas1-reservedword">function</span><span class="pas1-space"> Replace(OldChar, NewChar: Char; StartIndex: SizeInt = </span><span class="pas1-number">0</span><span class="pas1-symbol">; Count: SizeInt = -</span><span class="pas1-number">1</span><span class="pas1-symbol">): TJclStringBuilder;
      </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;
    </span><span class="pas1-reservedword">function</span><span class="pas1-space"> Replace(OldValue, NewValue: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; StartIndex: SizeInt = </span><span class="pas1-number">0</span><span class="pas1-symbol">; Count: SizeInt = -</span><span class="pas1-number">1</span><span class="pas1-symbol">): TJclStringBuilder;
      </span><span class="pas1-reservedword">overload</span><span class="pas1-symbol">;

    </span><span class="pas1-reservedword">function</span><span class="pas1-space"> Remove(StartIndex, Length: SizeInt): TJclStringBuilder;
    </span><span class="pas1-reservedword">function</span><span class="pas1-space"> EnsureCapacity(Capacity: SizeInt): SizeInt;

    </span><span class="pas1-comment">{ IToString }
</span><span class="pas1-space">    </span><span class="pas1-reservedword">function</span><span class="pas1-space"> ToString: </span><span class="pas1-reservedword">string</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$IFDEF RTL200_UP}</span><span class="pas1-space"> </span><span class="pas1-reservedword">override</span><span class="pas1-symbol">; </span><span class="pas1-preprocessor">{$ENDIF RTL200_UP}

</span><span class="pas1-space">    </span><span class="pas1-reservedword">property</span><span class="pas1-space"> __Chars__[</span><span class="pas1-reservedword">Index</span><span class="pas1-symbol">: SizeInt]: Char </span><span class="pas1-reservedword">read</span><span class="pas1-space"> GetChars </span><span class="pas1-reservedword">write</span><span class="pas1-space"> SetChars; </span><span class="pas1-reservedword">default</span><span class="pas1-symbol">;
    </span><span class="pas1-reservedword">property</span><span class="pas1-space"> Chars: TCharDynArray </span><span class="pas1-reservedword">read</span><span class="pas1-space"> FChars;
    </span><span class="pas1-reservedword">property</span><span class="pas1-space"> Length: SizeInt </span><span class="pas1-reservedword">read</span><span class="pas1-space"> FLength </span><span class="pas1-reservedword">write</span><span class="pas1-space"> Set_Length;
    </span><span class="pas1-reservedword">property</span><span class="pas1-space"> Capacity: SizeInt </span><span class="pas1-reservedword">read</span><span class="pas1-space"> GetCapacity </span><span class="pas1-reservedword">write</span><span class="pas1-space"> SetCapacity;
    </span><span class="pas1-reservedword">property</span><span class="pas1-space"> MaxCapacity: SizeInt </span><span class="pas1-reservedword">read</span><span class="pas1-space"> FMaxCapacity;
  </span><span class="pas1-reservedword">end</span><span class="pas1-symbol">;


</span></code></pre><!--EndFragment--></body>
</html>